{"version":3,"sources":["appScript.js"],"names":["appScript","version","Get","url","reqData","callback","fixBaseUrl","self","item","xhr","XMLHttpRequest","onreadystatechange","readyState","status","response","responseText","responseJson","JSON","parse","console","log","open","Config","baseUrl","setRequestHeader","GameData","token","curLanguage","send","Post","code","cc","sys","localStorage","removeItem","Global","PageMgr","closeAllPages","onOpenPage","stringify","GetQueryVariable","variable","query","window","location","search","substring","vars","split","i","length","pair","module","exports"],"mappings":"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","file":"appScript.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\Script\\Util","sourcesContent":["var appScript = {\n    version: \"1.0.0\",\n    Get: function(url,reqData,callback, fixBaseUrl = \"\"){\n        var self = this;\n\n        if(reqData!=\"\"){\n            url += \"?\";\n            for(var item in reqData){\n                url += item +\"=\" +reqData[item] +\"&\";\n            }\n        }\n        // console.log(self.ip + url)\n        var xhr = new XMLHttpRequest();\n        xhr.onreadystatechange = function () {\n            if (xhr.readyState == 4){\n                if(xhr.status >= 200 && xhr.status <= 400){\n                    var response = xhr.responseText;\n                    if(response){\n                        var responseJson = JSON.parse(response);\n                        console.log(responseJson)\n                        callback(responseJson);\n                    }else{\n                        console.log(\"返回数据不存在\")\n                        callback(false);\n                    }\n                }else{\n                    console.log(\"请求失败\")\n                    callback(false);\n                }\n            }\n        };\n        if(fixBaseUrl!=\"\"){\n            xhr.open(\"GET\", fixBaseUrl + url, true);\n        }else{\n            xhr.open(\"GET\", Config.baseUrl + url, true);\n        }\n        xhr.setRequestHeader(\"Content-Type\" , \"application/json\");\n        xhr.setRequestHeader(\"token\",'magic' + GameData.token);\n        xhr.setRequestHeader(\"language\",GameData.curLanguage);\n        xhr.send();\n    },\n\n    Post: function (url, reqData, callback, fixBaseUrl = \"\") {\n        var self = this;\n        //2.发起请求\n        var xhr = new XMLHttpRequest();\n        \n        xhr.onreadystatechange = function () {\n            console.log(xhr)\n            if (xhr.readyState == 4){\n                console.log(\"---------1-----------------url:\"+Config.baseUrl + url);\n                if(xhr.status >= 200 && xhr.status <= 400){\n                    var response = xhr.responseText;\n                    if(response){\n                        var responseJson = JSON.parse(response);\n                        console.log(responseJson)\n                        if(responseJson.code==401){\n                            cc.sys.localStorage.removeItem(\"com.game.vdn.token\");\n                            Global.PageMgr.closeAllPages();\n                            Global.PageMgr.onOpenPage(0);\n                            return;\n                        }\n                        callback(responseJson);\n                    }else{\n                        console.log(\"返回数据不存在\")\n                        callback(false);\n                    }\n                }else{\n                    console.log(\"请求失败\")\n                    callback(false);\n                }\n            }\n        };\n        if(fixBaseUrl!=\"\"){\n            xhr.open(\"POST\", fixBaseUrl + url, true);\n        }else{\n            xhr.open(\"POST\", Config.baseUrl + url, true);\n        }\n        xhr.setRequestHeader(\"Content-Type\" , \"application/json\");\n        xhr.setRequestHeader(\"token\",GameData.token);\n        xhr.setRequestHeader(\"language\",GameData.curLanguage);\n        console.log(\"-------|\"+GameData.token);\n        console.log(\"-------reqData：\"+JSON.stringify(reqData));\n        \n        xhr.send(JSON.stringify(reqData));//reqData为字符串形式： \"key=value\"\n    },\n    GetQueryVariable:function(variable)\n    {\n        let query = window.location.search.substring(1);\n        let vars = query.split(\"&\");\n        for (let i=0;i<vars.length;i++) {\n            let pair = vars[i].split(\"=\");\n            if(pair[0] == variable){return pair[1];}\n        }\n        return(false);\n    },\n\n};\n\nmodule.exports = appScript;"]}