{"version":3,"sources":["appScript.js"],"names":["appScript","version","Get","url","reqData","callback","fixBaseUrl","self","item","xhr","XMLHttpRequest","onreadystatechange","readyState","status","response","responseText","responseJson","JSON","parse","console","log","open","Config","baseUrl","setRequestHeader","GameData","token","curLanguage","send","Post","code","cc","sys","localStorage","removeItem","Global","PageMgr","closeAllPages","onOpenPage","stringify","GetQueryVariable","variable","query","window","location","search","substring","vars","split","i","length","pair","module","exports"],"mappings":";;;;;;AAAA,IAAIA,YAAY;AACZC,aAAS,OADG;AAEZC,SAAK,aAASC,GAAT,EAAaC,OAAb,EAAqBC,QAArB,EAA+C;AAAA,YAAhBC,UAAgB,uEAAH,EAAG;;AAChD,YAAIC,OAAO,IAAX;;AAEA,YAAGH,WAAS,EAAZ,EAAe;AACXD,mBAAO,GAAP;AACA,iBAAI,IAAIK,IAAR,IAAgBJ,OAAhB,EAAwB;AACpBD,uBAAOK,OAAM,GAAN,GAAWJ,QAAQI,IAAR,CAAX,GAA0B,GAAjC;AACH;AACJ;AACD;AACA,YAAIC,MAAM,IAAIC,cAAJ,EAAV;AACAD,YAAIE,kBAAJ,GAAyB,YAAY;AACjC,gBAAIF,IAAIG,UAAJ,IAAkB,CAAtB,EAAwB;AACpB,oBAAGH,IAAII,MAAJ,IAAc,GAAd,IAAqBJ,IAAII,MAAJ,IAAc,GAAtC,EAA0C;AACtC,wBAAIC,WAAWL,IAAIM,YAAnB;AACA,wBAAGD,QAAH,EAAY;AACR,4BAAIE,eAAeC,KAAKC,KAAL,CAAWJ,QAAX,CAAnB;AACAK,gCAAQC,GAAR,CAAYJ,YAAZ;AACAX,iCAASW,YAAT;AACH,qBAJD,MAIK;AACDG,gCAAQC,GAAR,CAAY,SAAZ;AACAf,iCAAS,KAAT;AACH;AACJ,iBAVD,MAUK;AACDc,4BAAQC,GAAR,CAAY,MAAZ;AACAf,6BAAS,KAAT;AACH;AACJ;AACJ,SAjBD;AAkBA,YAAGC,cAAY,EAAf,EAAkB;AACdG,gBAAIY,IAAJ,CAAS,KAAT,EAAgBf,aAAaH,GAA7B,EAAkC,IAAlC;AACH,SAFD,MAEK;AACDM,gBAAIY,IAAJ,CAAS,KAAT,EAAgBC,OAAOC,OAAP,GAAiBpB,GAAjC,EAAsC,IAAtC;AACH;AACDM,YAAIe,gBAAJ,CAAqB,cAArB,EAAsC,kBAAtC;AACAf,YAAIe,gBAAJ,CAAqB,OAArB,EAA6B,UAAUC,SAASC,KAAhD;AACAjB,YAAIe,gBAAJ,CAAqB,UAArB,EAAgCC,SAASE,WAAzC;AACAlB,YAAImB,IAAJ;AACH,KAxCW;;AA0CZC,UAAM,cAAU1B,GAAV,EAAeC,OAAf,EAAwBC,QAAxB,EAAmD;AAAA,YAAjBC,UAAiB,uEAAJ,EAAI;;AACrD,YAAIC,OAAO,IAAX;AACA;AACA,YAAIE,MAAM,IAAIC,cAAJ,EAAV;;AAEAD,YAAIE,kBAAJ,GAAyB,YAAY;AACjCQ,oBAAQC,GAAR,CAAYX,GAAZ;AACA,gBAAIA,IAAIG,UAAJ,IAAkB,CAAtB,EAAwB;AACpBO,wBAAQC,GAAR,CAAY,oCAAkCE,OAAOC,OAAzC,GAAmDpB,GAA/D;AACA,oBAAGM,IAAII,MAAJ,IAAc,GAAd,IAAqBJ,IAAII,MAAJ,IAAc,GAAtC,EAA0C;AACtC,wBAAIC,WAAWL,IAAIM,YAAnB;AACA,wBAAGD,QAAH,EAAY;AACR,4BAAIE,eAAeC,KAAKC,KAAL,CAAWJ,QAAX,CAAnB;AACAK,gCAAQC,GAAR,CAAYJ,YAAZ;AACA,4BAAGA,aAAac,IAAb,IAAmB,GAAtB,EAA0B;AACtBC,+BAAGC,GAAH,CAAOC,YAAP,CAAoBC,UAApB,CAA+B,oBAA/B;AACAC,mCAAOC,OAAP,CAAeC,aAAf;AACAF,mCAAOC,OAAP,CAAeE,UAAf,CAA0B,CAA1B;AACA;AACH;AACDjC,iCAASW,YAAT;AACH,qBAVD,MAUK;AACDG,gCAAQC,GAAR,CAAY,SAAZ;AACAf,iCAAS,KAAT;AACH;AACJ,iBAhBD,MAgBK;AACDc,4BAAQC,GAAR,CAAY,MAAZ;AACAf,6BAAS,KAAT;AACH;AACJ;AACJ,SAzBD;AA0BA,YAAGC,cAAY,EAAf,EAAkB;AACdG,gBAAIY,IAAJ,CAAS,MAAT,EAAiBf,aAAaH,GAA9B,EAAmC,IAAnC;AACH,SAFD,MAEK;AACDM,gBAAIY,IAAJ,CAAS,MAAT,EAAiBC,OAAOC,OAAP,GAAiBpB,GAAlC,EAAuC,IAAvC;AACH;AACDM,YAAIe,gBAAJ,CAAqB,cAArB,EAAsC,kBAAtC;AACAf,YAAIe,gBAAJ,CAAqB,OAArB,EAA6BC,SAASC,KAAtC;AACAjB,YAAIe,gBAAJ,CAAqB,UAArB,EAAgCC,SAASE,WAAzC;AACAR,gBAAQC,GAAR,CAAY,aAAWK,SAASC,KAAhC;AACAP,gBAAQC,GAAR,CAAY,oBAAkBH,KAAKsB,SAAL,CAAenC,OAAf,CAA9B;;AAEAK,YAAImB,IAAJ,CAASX,KAAKsB,SAAL,CAAenC,OAAf,CAAT,EA1CqD,CA0CnB;AACrC,KArFW;AAsFZoC,sBAAiB,0BAASC,QAAT,EACjB;AACI,YAAIC,QAAQC,OAAOC,QAAP,CAAgBC,MAAhB,CAAuBC,SAAvB,CAAiC,CAAjC,CAAZ;AACA,YAAIC,OAAOL,MAAMM,KAAN,CAAY,GAAZ,CAAX;AACA,aAAK,IAAIC,IAAE,CAAX,EAAaA,IAAEF,KAAKG,MAApB,EAA2BD,GAA3B,EAAgC;AAC5B,gBAAIE,OAAOJ,KAAKE,CAAL,EAAQD,KAAR,CAAc,GAAd,CAAX;AACA,gBAAGG,KAAK,CAAL,KAAWV,QAAd,EAAuB;AAAC,uBAAOU,KAAK,CAAL,CAAP;AAAgB;AAC3C;AACD,eAAO,KAAP;AACH;;AA/FW,CAAhB;;AAmGAC,OAAOC,OAAP,GAAiBrD,SAAjB","file":"appScript.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\Script\\Util","sourcesContent":["var appScript = {\r\n    version: \"1.0.0\",\r\n    Get: function(url,reqData,callback, fixBaseUrl = \"\"){\r\n        var self = this;\r\n\r\n        if(reqData!=\"\"){\r\n            url += \"?\";\r\n            for(var item in reqData){\r\n                url += item +\"=\" +reqData[item] +\"&\";\r\n            }\r\n        }\r\n        // console.log(self.ip + url)\r\n        var xhr = new XMLHttpRequest();\r\n        xhr.onreadystatechange = function () {\r\n            if (xhr.readyState == 4){\r\n                if(xhr.status >= 200 && xhr.status <= 400){\r\n                    var response = xhr.responseText;\r\n                    if(response){\r\n                        var responseJson = JSON.parse(response);\r\n                        console.log(responseJson)\r\n                        callback(responseJson);\r\n                    }else{\r\n                        console.log(\"返回数据不存在\")\r\n                        callback(false);\r\n                    }\r\n                }else{\r\n                    console.log(\"请求失败\")\r\n                    callback(false);\r\n                }\r\n            }\r\n        };\r\n        if(fixBaseUrl!=\"\"){\r\n            xhr.open(\"GET\", fixBaseUrl + url, true);\r\n        }else{\r\n            xhr.open(\"GET\", Config.baseUrl + url, true);\r\n        }\r\n        xhr.setRequestHeader(\"Content-Type\" , \"application/json\");\r\n        xhr.setRequestHeader(\"token\",'magic' + GameData.token);\r\n        xhr.setRequestHeader(\"language\",GameData.curLanguage);\r\n        xhr.send();\r\n    },\r\n\r\n    Post: function (url, reqData, callback, fixBaseUrl = \"\") {\r\n        var self = this;\r\n        //2.发起请求\r\n        var xhr = new XMLHttpRequest();\r\n        \r\n        xhr.onreadystatechange = function () {\r\n            console.log(xhr)\r\n            if (xhr.readyState == 4){\r\n                console.log(\"---------1-----------------url:\"+Config.baseUrl + url);\r\n                if(xhr.status >= 200 && xhr.status <= 400){\r\n                    var response = xhr.responseText;\r\n                    if(response){\r\n                        var responseJson = JSON.parse(response);\r\n                        console.log(responseJson)\r\n                        if(responseJson.code==401){\r\n                            cc.sys.localStorage.removeItem(\"com.game.vdn.token\");\r\n                            Global.PageMgr.closeAllPages();\r\n                            Global.PageMgr.onOpenPage(0);\r\n                            return;\r\n                        }\r\n                        callback(responseJson);\r\n                    }else{\r\n                        console.log(\"返回数据不存在\")\r\n                        callback(false);\r\n                    }\r\n                }else{\r\n                    console.log(\"请求失败\")\r\n                    callback(false);\r\n                }\r\n            }\r\n        };\r\n        if(fixBaseUrl!=\"\"){\r\n            xhr.open(\"POST\", fixBaseUrl + url, true);\r\n        }else{\r\n            xhr.open(\"POST\", Config.baseUrl + url, true);\r\n        }\r\n        xhr.setRequestHeader(\"Content-Type\" , \"application/json\");\r\n        xhr.setRequestHeader(\"token\",GameData.token);\r\n        xhr.setRequestHeader(\"language\",GameData.curLanguage);\r\n        console.log(\"-------|\"+GameData.token);\r\n        console.log(\"-------reqData：\"+JSON.stringify(reqData));\r\n        \r\n        xhr.send(JSON.stringify(reqData));//reqData为字符串形式： \"key=value\"\r\n    },\r\n    GetQueryVariable:function(variable)\r\n    {\r\n        let query = window.location.search.substring(1);\r\n        let vars = query.split(\"&\");\r\n        for (let i=0;i<vars.length;i++) {\r\n            let pair = vars[i].split(\"=\");\r\n            if(pair[0] == variable){return pair[1];}\r\n        }\r\n        return(false);\r\n    },\r\n\r\n};\r\n\r\nmodule.exports = appScript;"]}