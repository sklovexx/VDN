{"version":3,"sources":["ZhongZiPanel.js"],"names":["cc","Class","extends","Component","properties","item","Prefab","content","Node","onLoad","director","GlobalEvent","on","onUpdateZhongZiData","onDestroy","off","children","forEach","value","destroy","backPack","GameData","ZhongZiData","table","node","instantiate","parent","id","getChildByName","getComponent","Label","string","count","dataFunc","queryValue","loader","loadRes","err","res","console","error","spriteFrame","SpriteFrame","Sprite","active","EventType","TOUCH_END","Global","ProtocolMgr","zhongZhi","ZhongZhiReady","pos","PageMgr","closeAllPages","onOpenPage","pages","toggleChange","start","onEnable","queryZhongZi"],"mappings":"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","file":"ZhongZiPanel.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\Script\\Ui\\NongChang","sourcesContent":["\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        item:cc.Prefab,\r\n        content:cc.Node\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad () {\r\n        cc.director.GlobalEvent.on(\"ZhongZiData\",this.onUpdateZhongZiData,this)\r\n    },\r\n    onDestroy(){\r\n        cc.director.GlobalEvent.off(\"ZhongZiData\")\r\n    },\r\n    onUpdateZhongZiData(){\r\n        let children = this.content.children;\r\n        children.forEach(value =>{\r\n            value.destroy();\r\n        })\r\n        let backPack = GameData.ZhongZiData;\r\n        let table = \"zhongzi\"\r\n        backPack.forEach(value => {\r\n            let node = cc.instantiate(this.item);\r\n            node.parent = this.content;\r\n            let id = value.id + '';\r\n            node.getChildByName('Bg').getChildByName('Count').getComponent(cc.Label).string = value.count\r\n            node.getChildByName('Name').getComponent(cc.Label).string = dataFunc.queryValue(table,\"name\",id)+'种子'\r\n            node.getChildByName('Reward').getComponent(cc.Label).string = '收获'+dataFunc.queryValue(table,\"reward\",id)+'个'+dataFunc.queryValue(table,\"name\",id)\r\n            node.getChildByName('Price').getComponent(cc.Label).string = '价格'+dataFunc.queryValue(table,\"price\",id)\r\n            cc.loader.loadRes('NongChang/'+dataFunc.queryValue(table,\"picture\",id),(err,res)=>{\r\n                if(err){\r\n                    console.error(err);\r\n                    return;\r\n                }\r\n                let spriteFrame = new cc.SpriteFrame(res)\r\n                node.getChildByName('Bg').getChildByName('Icon').getComponent(cc.Sprite).spriteFrame = spriteFrame\r\n                if(value.count>0){\r\n                    node.getChildByName('Bg').getChildByName('Count').active = true;\r\n                    node.getChildByName('Price').active = false;\r\n                    node.getChildByName('Buy').active = false;\r\n                    node.off(cc.Node.EventType.TOUCH_END)\r\n                    node.on(cc.Node.EventType.TOUCH_END,()=>{\r\n                        Global.ProtocolMgr.zhongZhi(id,GameData.ZhongZhiReady.pos)\r\n                    })\r\n                }else{\r\n                    node.getChildByName('Bg').getChildByName('Count').active = false;\r\n                    node.getChildByName('Price').active = true;\r\n                    node.getChildByName('Buy').active = true;\r\n                    node.getChildByName('Buy').on(cc.Node.EventType.TOUCH_END,()=>{\r\n                        Global.PageMgr.closeAllPages()\r\n                        Global.PageMgr.onOpenPage(1)\r\n                        Global.PageMgr.pages[1].getComponent('NongChangPanel').toggleChange('ShangCheng')\r\n                    })\r\n                }\r\n            })\r\n\r\n        })\r\n    },\r\n    start () {\r\n\r\n    },\r\n    onEnable(){\r\n        Global.ProtocolMgr.queryZhongZi()\r\n    },\r\n    // update (dt) {},\r\n});\r\n"]}