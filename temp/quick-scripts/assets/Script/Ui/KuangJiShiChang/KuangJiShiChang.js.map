{"version":3,"sources":["KuangJiShiChang.js"],"names":["cc","Class","extends","Component","properties","item","Prefab","Content","Node","KuangJiDetail","Tips","onLoad","director","GlobalEvent","on","onUpdateKuangJiData","Global","ProtocolMgr","queryKuangJi","backPack","GameData","KuangJiData","forEach","node","instantiate","parent","loader","load","url","e","picture","type","err","res","getChildByName","getComponent","Sprite","spriteFrame","SpriteFrame","Label","string","name","rent","coinIncome","mineIncome","tokenIncome","incomeHour","color","eval","rentAble","EventType","TOUCH_END","showDetail","tag","active","content","count","YuYueKuangJi","id","data","PageMgr","closeLoadingPage","code","showTipPage","closeDetail","closeTips","message","ZuYongKuangJi","start","closePage","onClosePage","onDestroy","off"],"mappings":"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","file":"KuangJiShiChang.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\Script\\Ui\\KuangJiShiChang","sourcesContent":["\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        item:cc.Prefab,\r\n        Content:cc.Node,\r\n        KuangJiDetail:cc.Node,\r\n        Tips:cc.Node,\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad () {\r\n        cc.director.GlobalEvent.on(\"KuangJiData\",this.onUpdateKuangJiData,this)\r\n        Global.ProtocolMgr.queryKuangJi();\r\n    },\r\n    onUpdateKuangJiData(){\r\n        let backPack = GameData.KuangJiData;\r\n        backPack.forEach(e=>{\r\n            let node = cc.instantiate(this.item);\r\n            node.parent = this.Content;\r\n            cc.loader.load({url:e.picture,type:'png'},(err,res)=>{\r\n                node.getChildByName('Mask').getChildByName('Icon').getComponent(cc.Sprite).spriteFrame = new cc.SpriteFrame(res)\r\n            })\r\n            node.getChildByName('Name').getComponent(cc.Label).string = e.name;\r\n            node.getChildByName('Text1').getComponent(cc.Label).string = '售价：'+e.rent;\r\n            node.getChildByName('Text2').getComponent(cc.Label).string = 'E金币收益：'+e.coinIncome;\r\n            node.getChildByName('Text3').getComponent(cc.Label).string = 'E矿场收益：'+e.mineIncome;\r\n            node.getChildByName('Text4').getComponent(cc.Label).string = 'E令牌收益：'+e.tokenIncome;\r\n            node.getChildByName('Text5').getComponent(cc.Label).string = '总收益时长：'+e.incomeHour+'小时';\r\n            node.getChildByName('ZuYong').getChildByName('Background').color = eval(e.rentAble) ? new cc.color(219,95,156,255) : new cc.color(102,102,102,102);\r\n            if(eval(e.rentAble)){\r\n                node.getChildByName('ZuYong').on(cc.Node.EventType.TOUCH_END,()=>{\r\n                    this.showDetail(e,'租用')\r\n                })\r\n            }\r\n            node.getChildByName('YuYue').on(cc.Node.EventType.TOUCH_END,()=>{\r\n                this.showDetail(e,'预约')\r\n            })\r\n        })\r\n    },\r\n    showDetail(e,tag){\r\n        this.KuangJiDetail.active = true;\r\n        cc.loader.load({url:e.picture,type:'png'},(err,res)=>{\r\n            this.KuangJiDetail.getChildByName('Mask').getChildByName('Icon').getComponent(cc.Sprite).spriteFrame = new cc.SpriteFrame(res)\r\n        })\r\n        let content = this.KuangJiDetail.getChildByName('Layout');\r\n        content.getChildByName('Name').getComponent(cc.Label).string = e.name;\r\n        content.getChildByName('Number').getComponent(cc.Label).string = '编号：'+e.name;\r\n        content.getChildByName('Count').getComponent(cc.Label).string = '预计投放：'+e.count+'(上限)';\r\n        content.getChildByName('Text').getComponent(cc.Label).string = 'E金币收益：'+e.coinIncome;\r\n        content.getChildByName('Text1').getComponent(cc.Label).string = 'E矿场收益：'+e.mineIncome;\r\n        content.getChildByName('Text2').getComponent(cc.Label).string = 'E令牌收益：'+e.tokenIncome;\r\n        content.getChildByName('Text3').getComponent(cc.Label).string = '总收益时长：'+e.incomeHour+'小时';\r\n        content.getChildByName('Text4').getComponent(cc.Label).string = '租用金额：'+e.rent+'E金币';\r\n        this.KuangJiDetail.getChildByName('Button').getChildByName('Label').getComponent(cc.Label).string = tag;\r\n        this.KuangJiDetail.getChildByName('Button').on(cc.Node.EventType.TOUCH_END,()=>{\r\n            this.Tips.active = true;\r\n            this.Tips.getChildByName('Content').getComponent(cc.Label).string = '是否消耗'+e.rent+'E金币进行'+tag+'?';\r\n            this.Tips.getChildByName('Button').on(cc.Node.EventType.TOUCH_END,()=>{\r\n                if(tag == '预约'){\r\n                    Global.ProtocolMgr.YuYueKuangJi(e.id,(data)=>{\r\n                        Global.PageMgr.closeLoadingPage()\r\n                        if(data.code==200){\r\n                            Global.PageMgr.showTipPage('预约成功')\r\n                            this.closeDetail()\r\n                            this.closeTips()\r\n                        }else{\r\n                            Global.PageMgr.showTipPage(data.message)\r\n                        }\r\n                    });\r\n                }else{\r\n                    Global.ProtocolMgr.ZuYongKuangJi(e.id,(data)=>{\r\n                        Global.PageMgr.closeLoadingPage()\r\n                        if(data.code==200){\r\n                            Global.PageMgr.showTipPage('租用成功')\r\n                            this.closeDetail()\r\n                            this.closeTips()\r\n                        }else{\r\n                            Global.PageMgr.showTipPage(data.message)\r\n                        }\r\n                    });\r\n                }\r\n            })\r\n        })\r\n    },\r\n    start () {\r\n\r\n    },\r\n    closeDetail(){\r\n        this.KuangJiDetail.active = false;\r\n    },\r\n    closeTips(){\r\n        this.Tips.active = false;\r\n    },\r\n    closePage(){\r\n        Global.PageMgr.onClosePage(5);\r\n    },\r\n    onDestroy(){\r\n        cc.director.GlobalEvent.off(\"KuangJiData\")\r\n    },\r\n    // update (dt) {},\r\n});\r\n"]}