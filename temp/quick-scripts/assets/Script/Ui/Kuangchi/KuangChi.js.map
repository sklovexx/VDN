{"version":3,"sources":["KuangChi.js"],"names":["cc","Class","extends","Component","properties","UserData","Node","SubPanel","GonGao","ECC","Prefab","Count","onLoad","director","GlobalEvent","on","onUpdateUserData","Global","ProtocolMgr","queryUserData","queryEcc","data","parseInt","number","i","node","instantiate","position","randomPosition","parent","x","y","jump","repeatForever","sequence","moveBy","v2","setTimeout","runAction","Math","random","EventType","TOUCH_END","name","addEcc","off","destroy","loader","load","url","GameData","type","err","res","getComponent","Sprite","spriteFrame","SpriteFrame","e","console","warn","length","Label","string","parseFloat","toFixed","start","canvas","getScene","getChildByName","Canvas","pad","minX","width","minY","height","maxX","maxY","dataFunc","randomNum","showSubPanel","event","index","active","closeSubPanel","filterClick","log","onDestroy"],"mappings":";;;;;;AACAA,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACRC,kBAAS,CAACL,GAAGM,IAAJ,CADD;AAERC,kBAAS,CAACP,GAAGM,IAAJ,CAFD;AAGRE,gBAAOR,GAAGM,IAHF;AAIRG,aAAIT,GAAGU,MAJC;AAKRC,eAAM;AALE,KAHP;;AAWL;;AAEAC,UAbK,oBAaK;AAAA;;AACNZ,WAAGa,QAAH,CAAYC,WAAZ,CAAwBC,EAAxB,CAA2B,UAA3B,EAAsC,KAAKC,gBAA3C,EAA4D,IAA5D;AACAC,eAAOC,WAAP,CAAmBC,aAAnB;AACAF,eAAOC,WAAP,CAAmBE,QAAnB,CAA4B,UAACC,IAAD,EAAQ;AAChC,kBAAKV,KAAL,GAAaW,SAASD,KAAKA,IAAL,CAAUE,MAAnB,CAAb;AACA;;AAFgC,uCAGxBC,CAHwB;AAI5B,oBAAIC,OAAOzB,GAAG0B,WAAH,CAAe,MAAKjB,GAApB,CAAX;AACA,oBAAIkB,WAAW,MAAKC,cAAL,EAAf;AACAH,qBAAKI,MAAL,GAAc,MAAKJ,IAAnB;AACAA,qBAAKK,CAAL,GAASH,SAASG,CAAlB;AACAL,qBAAKM,CAAL,GAASJ,SAASI,CAAlB;AACA,oBAAIC,OAAOhC,GAAGiC,aAAH,CAAiBjC,GAAGkC,QAAH,CAAYlC,GAAGmC,MAAH,CAAU,CAAV,EAAYnC,GAAGoC,EAAH,CAAM,CAAN,EAAQ,EAAR,CAAZ,CAAZ,EAAqCpC,GAAGmC,MAAH,CAAU,CAAV,EAAYnC,GAAGoC,EAAH,CAAM,CAAN,EAAQ,CAAC,EAAT,CAAZ,CAArC,CAAjB,CAAX;AACAC,2BAAW,YAAI;AAACZ,yBAAKa,SAAL,CAAeN,IAAf;AAAqB,iBAArC,EAAsCO,KAAKC,MAAL,KAAc,IAApD;AACAf,qBAAKV,EAAL,CAAQf,GAAGM,IAAH,CAAQmC,SAAR,CAAkBC,SAA1B,EAAoC,YAAI;AACpC;AACA,wBAAGjB,KAAKkB,IAAL,IAAW,KAAd,EAAoB;AAChB;AACA1B,+BAAOC,WAAP,CAAmB0B,MAAnB;AACAnB,6BAAKoB,GAAL,CAAS7C,GAAGM,IAAH,CAAQmC,SAAR,CAAkBC,SAA3B;AACAjB,6BAAKqB,OAAL;AACA;AACA;AACH;AACJ,iBAVD;AAX4B;;AAGhC,iBAAI,IAAItB,IAAI,CAAZ,EAAcA,IAAE,MAAKb,KAArB,EAA2Ba,GAA3B,EAA+B;AAAA,sBAAvBA,CAAuB;AAmB9B;AACJ,SAvBD;AAwBH,KAxCI;;AAyCL;AACAR,oBA1CK,8BA0Ca;AAAA;;AACd,YAAI;AACAhB,eAAG+C,MAAH,CAAUC,IAAV,CAAe,EAACC,KAAIC,SAAS7C,QAAT,CAAkB,CAAlB,CAAL,EAA0B8C,MAAK,KAA/B,EAAf,EAAqD,UAACC,GAAD,EAAKC,GAAL,EAAW;AAC5D,uBAAKhD,QAAL,CAAc,CAAd,EAAiBiD,YAAjB,CAA8BtD,GAAGuD,MAAjC,EAAyCC,WAAzC,GAAuD,IAAIxD,GAAGyD,WAAP,CAAmBJ,GAAnB,CAAvD;AACH,aAFD;AAGH,SAJD,CAIC,OAAOK,CAAP,EAAU;AACPC,oBAAQC,IAAR,CAAaF,CAAb;AACH;AACD,aAAI,IAAIlC,IAAI,CAAZ,EAAcA,IAAE,KAAKnB,QAAL,CAAcwD,MAA9B,EAAqCrC,GAArC,EAAyC;AACrC,iBAAKnB,QAAL,CAAcmB,CAAd,EAAiB8B,YAAjB,CAA8BtD,GAAG8D,KAAjC,EAAwCC,MAAxC,GAAgDC,WAAWd,SAAS7C,QAAT,CAAkBmB,CAAlB,CAAX,EAAiCyC,OAAjC,CAAyC,CAAzC,CAAhD;AACH;AACJ,KArDI;AAsDLC,SAtDK,mBAsDI,CAER,CAxDI;;AAyDL;AACAtC,kBA1DK,4BA0DW;AACZ,YAAIuC,SAASnE,GAAGa,QAAH,CAAYuD,QAAZ,GAAuBC,cAAvB,CAAsC,QAAtC,EAAgDf,YAAhD,CAA6DtD,GAAGsE,MAAhE,EAAwE7C,IAArF;AACA,YAAI8C,MAAM,EAAV;AAAA,YACMC,OAAO,CAACL,OAAOM,KAAR,GAAgB,CAAhB,GAAoBF,GADjC;AAAA,YAEMG,OAAO,CAACP,OAAOQ,MAAR,GAAiB,CAAjB,GAAqBJ,GAFlC;AAAA,YAGMK,OAAOT,OAAOM,KAAP,GAAe,CAAf,GAAmBF,GAHhC;AAAA,YAIMM,OAAOV,OAAOQ,MAAP,GAAgB,CAAhB,GAAoBJ,GAJjC;AAKA,YAAIzC,IAAIgD,SAASC,SAAT,CAAmBP,IAAnB,EAAwBI,IAAxB,CAAR;AAAA,YACM7C,IAAI+C,SAASC,SAAT,CAAmBL,IAAnB,EAAwBG,IAAxB,CADV;AAEA,eAAO,EAAC/C,IAAD,EAAGC,IAAH,EAAP;AACH,KApEI;AAqELiD,gBArEK,wBAqEQC,KArER,EAqEcC,KArEd,EAqEoB;AACrB,aAAK3E,QAAL,CAAc2E,KAAd,EAAqBC,MAArB,GAA8B,IAA9B;AACH,KAvEI;AAwELC,iBAxEK,yBAwESH,KAxET,EAwEeC,KAxEf,EAwEqB;AACtB,aAAK3E,QAAL,CAAc2E,KAAd,EAAqBC,MAArB,GAA8B,KAA9B;AACH,KA1EI;AA2ELE,eA3EK,yBA2EQ;AACT1B,gBAAQ2B,GAAR,CAAY,MAAZ;AACA;AACH,KA9EI;AA+ELC,aA/EK,uBA+EM;AACPvF,WAAGa,QAAH,CAAYC,WAAZ,CAAwB+B,GAAxB,CAA4B,UAA5B;AACH;AAjFI;AAkFL;AAlFJ","file":"KuangChi.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\Script\\Ui\\Kuangchi","sourcesContent":["\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        UserData:[cc.Node],\r\n        SubPanel:[cc.Node],\r\n        GonGao:cc.Node,\r\n        ECC:cc.Prefab,\r\n        Count:10\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad () {\r\n        cc.director.GlobalEvent.on(\"UserData\",this.onUpdateUserData,this)\r\n        Global.ProtocolMgr.queryUserData();\r\n        Global.ProtocolMgr.queryEcc((data)=>{\r\n            this.Count = parseInt(data.data.number);\r\n            //生成矿球\r\n            for(let i = 0;i<this.Count;i++){\r\n                let node = cc.instantiate(this.ECC);\r\n                let position = this.randomPosition();\r\n                node.parent = this.node\r\n                node.x = position.x;\r\n                node.y = position.y;\r\n                let jump = cc.repeatForever(cc.sequence(cc.moveBy(1,cc.v2(0,20)),cc.moveBy(1,cc.v2(0,-20))))\r\n                setTimeout(()=>{node.runAction(jump)},Math.random()*1000)\r\n                node.on(cc.Node.EventType.TOUCH_END,()=>{\r\n                    //防止操作其他节点\r\n                    if(node.name==\"ECC\"){\r\n                        //防止多次点击\r\n                        Global.ProtocolMgr.addEcc()\r\n                        node.off(cc.Node.EventType.TOUCH_END)\r\n                        node.destroy()\r\n                        // let fadeOut = cc.sequence(cc.fadeOut(0.5),cc.callFunc(function(){}));\r\n                        // node.runAction(fadeOut)\r\n                    }\r\n                },this)\r\n            }\r\n        })\r\n    },\r\n    //监听用户信息更新\r\n    onUpdateUserData(){\r\n        try {\r\n            cc.loader.load({url:GameData.UserData[0],type:'png'},(err,res)=>{\r\n                this.UserData[0].getComponent(cc.Sprite).spriteFrame = new cc.SpriteFrame(res)\r\n            })\r\n        }catch (e) {\r\n            console.warn(e)\r\n        }\r\n        for(let i = 1;i<this.UserData.length;i++){\r\n            this.UserData[i].getComponent(cc.Label).string =parseFloat(GameData.UserData[i]).toFixed(2);\r\n        }\r\n    },\r\n    start () {\r\n\r\n    },\r\n    //获取随机位置\r\n    randomPosition(){\r\n        let canvas = cc.director.getScene().getChildByName('Canvas').getComponent(cc.Canvas).node\r\n        let pad = 80\r\n            , minX = -canvas.width / 2 + pad\r\n            , minY = -canvas.height / 2 + pad\r\n            , maxX = canvas.width / 2 - pad\r\n            , maxY = canvas.height / 2 - pad;\r\n        let x = dataFunc.randomNum(minX,maxX)\r\n            , y = dataFunc.randomNum(minY,maxY);\r\n        return {x,y}\r\n    },\r\n    showSubPanel(event,index){\r\n        this.SubPanel[index].active = true;\r\n    },\r\n    closeSubPanel(event,index){\r\n        this.SubPanel[index].active = false;\r\n    },\r\n    filterClick(){\r\n        console.log('点击过滤')\r\n        return\r\n    },\r\n    onDestroy(){\r\n        cc.director.GlobalEvent.off(\"UserData\")\r\n    },\r\n    // update (dt) {},\r\n});\r\n"]}