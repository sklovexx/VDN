{"version":3,"sources":["PlayerCtrl.js"],"names":["Utils","require","cc","Class","extends","Component","properties","uidLabel","Label","uid","default","notify","string","avatar","Sprite","nickNameLabel","nickName","coinsLabel","coins","type","Integer","min","cardPanelLeft","Node","cardPanelRight","cardPanelNode","menuNode","startNode","readyNode","readyStateNode","kickNode","quitNode","bankerSp","menuLabel","bet1","bet2","bet3","bet4","isBanker","active","betLabel","node","showMenu","showStart","showReady","showReadyState","showKick","showQuit","cowLabel","rewardLabel","curBets","hands","typeReturn","onLoad","clearHands","start","initPlayer","name","loader","loadRes","randomInteger","SpriteFrame","err","sf","spriteFrame","load","url","tex","console","log","message","bind","initPlayerWithData","data","warn","nickname","isready","onBtnDown","send","downNum","parseInt","payBet","onBtnStart","GlobalNiuNiu","netProxy","startGame","onBtnReady","ready","onBtnQuit","quitRoom","setTimeout","audioEngine","pauseAll","loadScene","onBtnKick","kick","removeAllChildren","width","bet","delay","scheduleOnce","sum","length","i","card","point","config","ONLINE_MODE","undefined","showBet","openHands","names","getHandsType","handsType","audioMgr","playEffect","nCards","cardObj","instantiate","assetMgr","cardPrefab","getComponent","initCard","suit","x","y","addChild","pCards","addReward","addCoins","parseFloat","Animation","play"],"mappings":"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","file":"PlayerCtrl.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\NiuNiu\\script","sourcesContent":["// Learn cc.Class:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/class.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/life-cycle-callbacks.html\r\n\r\nlet Utils = require(\"./common/UtilsOther\");\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        uidLabel: cc.Label,\r\n        uid: {\r\n            default: 0,\r\n            notify(){\r\n                this.uidLabel.string = \"uid:\" + this.uid;\r\n            }\r\n        },\r\n        avatar: cc.Sprite,\r\n        nickNameLabel: cc.Label,\r\n        nickName: {\r\n            default:\"Mark\",\r\n            notify(){\r\n                this.nickNameLabel.string = this.nickName;\r\n            }\r\n        },\r\n        coinsLabel: cc.Label,\r\n        coins: {\r\n            default: 999999,\r\n            type: cc.Integer,\r\n            min: 0,\r\n            notify(){\r\n                this.coinsLabel.string = this.coins;\r\n            }\r\n        },\r\n        cardPanelLeft: cc.Node,\r\n        cardPanelRight: cc.Node,\r\n        cardPanelNode: cc.Node,\r\n        menuNode: cc.Node,\r\n        startNode: cc.Node,\r\n        readyNode:cc.Node,\r\n        readyStateNode:cc.Node,\r\n        kickNode: cc.Node,\r\n        quitNode: cc.Node,\r\n        bankerSp: cc.Node,\r\n        menuLabel:[cc.Label],\r\n        bet1:{\r\n            default: 0,\r\n            notify(){\r\n                this.menuLabel[0].string = this.bet1;\r\n            }\r\n        },\r\n        bet2:{\r\n            default: 0,\r\n            notify(){\r\n                this.menuLabel[1].string = this.bet2;\r\n            }\r\n        },\r\n        bet3:{\r\n            default: 0,\r\n            notify(){\r\n                this.menuLabel[2].string = this.bet3;\r\n            }\r\n        },\r\n        bet4:{\r\n            default: 0,\r\n            notify(){\r\n                this.menuLabel[3].string = this.bet4;\r\n            }\r\n        },\r\n        isBanker: {\r\n            default: false,\r\n            notify(){\r\n                this.bankerSp.active = this.isBanker;\r\n                this.betLabel.node.active = !this.isBanker;\r\n            }\r\n        },\r\n\r\n        showMenu: {\r\n            default: false,\r\n            notify(){\r\n                this.menuNode.active = this.showMenu;\r\n            }\r\n        },\r\n\r\n        showStart:{\r\n            default: true,\r\n            notify(){\r\n                this.startNode.active = this.showStart;\r\n            }\r\n        },\r\n        showReady:{\r\n            default: false,\r\n            notify(){\r\n                this.readyNode.active = this.showReady;\r\n            }\r\n        },\r\n        showReadyState:{\r\n            default: false,\r\n            notify(){\r\n                this.readyStateNode.active = this.showReadyState;\r\n            }\r\n        },\r\n        showKick:{\r\n            default: false,\r\n            notify(){\r\n                this.kickNode.active = this.showKick;\r\n            }\r\n        },\r\n        showQuit:{\r\n            default: true,\r\n            notify(){\r\n                this.quitNode.active = this.showQuit;\r\n            }\r\n        },\r\n        cowLabel: cc.Label,\r\n        rewardLabel: cc.Label,\r\n\r\n        betLabel: cc.Label,\r\n        curBets: 0,         // 当前下注\r\n\r\n        hands: [],\r\n\r\n        typeReturn: null,    // 牌型信息@TypeReturn\r\n\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad () {\r\n        this.clearHands();\r\n    },\r\n    start () {\r\n    },\r\n\r\n    initPlayer(name, avatar, coins){\r\n        this.nickName = name;\r\n        this.coins = coins;\r\n        if (!avatar){\r\n            // 随机一个头像\r\n            cc.loader.loadRes(\"userIcons/user_icon_woman\" + Utils.randomInteger(0,3), cc.SpriteFrame, (err, sf)=>{\r\n                if (!err){\r\n                    this.avatar.spriteFrame = sf;\r\n                }\r\n            });\r\n        }else{\r\n            cc.loader.load({url: avatar, type: 'jpg'},function(err,tex) {\r\n                if (err) {\r\n                    console.log(err.message || err);\r\n                    return;\r\n                }          \r\n                this.avatar.spriteFrame = new cc.SpriteFrame(tex);        \r\n            }.bind(this));\r\n        }\r\n    },\r\n\r\n    initPlayerWithData(data){\r\n        console.warn(data)\r\n        this.nickName = data.nickname;\r\n        this.coins = data.coins;\r\n        this.uid =data.uid;\r\n        this.isBanker = data.isBanker;\r\n        this.showReadyState = data.isready;\r\n        if (!data.avatar){\r\n            // 随机一个头像\r\n            cc.loader.loadRes(\"userIcons/user_icon_woman\" + Utils.randomInteger(0,3), cc.SpriteFrame, (err, sf)=>{\r\n                if (!err){\r\n                    this.avatar.spriteFrame = sf;\r\n                }\r\n            });\r\n        }else{\r\n            cc.loader.load({url: data.avatar, type: 'jpg'},function(err,tex) {\r\n                if (err) {\r\n                    console.log(err.message || err);\r\n                    return;\r\n                }          \r\n                this.avatar.spriteFrame = new cc.SpriteFrame(tex);        \r\n            }.bind(this));\r\n        }\r\n    },\r\n\r\n    onBtnDown(send, data){\r\n        let downNum = 0;\r\n        data = parseInt(data);\r\n        switch (data){\r\n            case 1:{\r\n                downNum = this.bet1;\r\n                break;\r\n            }\r\n            case 2:{\r\n                downNum = this.bet2;\r\n                break;\r\n            }\r\n            case 3:{\r\n                downNum = this.bet3;\r\n                break;\r\n            }\r\n            case 4:{\r\n                downNum = this.bet4;\r\n                break;\r\n            }\r\n            default:\r\n                downNum = this.bet1;\r\n                break;\r\n        }\r\n\r\n        this.menuNode.active = false;\r\n        this.payBet(downNum);\r\n    },\r\n\r\n    onBtnStart(){\r\n        cc.log(\"start.\");\r\n        GlobalNiuNiu.netProxy.startGame();\r\n    },\r\n    onBtnReady(){\r\n        cc.log(\"ready.\");\r\n        GlobalNiuNiu.netProxy.ready();\r\n    },\r\n    onBtnQuit(){\r\n        cc.log(\"quitRoom.\");\r\n        GlobalNiuNiu.netProxy.quitRoom();\r\n        setTimeout(()=>{\r\n            cc.audioEngine.pauseAll();\r\n            GlobalNiuNiu.loadScene(\"Menu\");\r\n        },500)\r\n    },\r\n    onBtnKick(){\r\n        cc.log(\"kick.\");\r\n        if(this.isBanker){\r\n            GlobalNiuNiu.netProxy.kick();\r\n        }\r\n    },\r\n    // 清空手牌\r\n    clearHands(){\r\n        this.cardPanelLeft.removeAllChildren();\r\n        this.cardPanelLeft.width = 0;\r\n        this.cardPanelRight.removeAllChildren();\r\n        this.cardPanelRight.width = 0;\r\n        this.hands = [];\r\n\r\n        // this.isBanker = false;\r\n        this.showMenu = false;\r\n        this.showStart = false;\r\n        this.cowLabel.node.active = false;\r\n        this.rewardLabel.node.active = false;\r\n        this.typeReturn = null;\r\n\r\n        this.curBets = 0;\r\n        this.betLabel.string = \"下注:\" + 0;\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param bet 下注，-1表示随机自动下注\r\n     * @param delay 延迟操作，方便机器人控制\r\n     */\r\n    payBet(bet, delay){\r\n        this.scheduleOnce(()=>{\r\n            if (bet < 0){\r\n                // 如果手中三张可以组成牛则下大注\r\n                let sum = 0;\r\n                if (this.hands.length > 3){\r\n                    for (let i=0; i<3; i++){\r\n                        let card = this.hands[i];\r\n                        sum += (card.point <= 10 ? card.point : 10);\r\n                    }\r\n                }\r\n                cc.log(\"sum: \" + sum + \",sum%10:\" + sum % 10);\r\n                if (sum > 0 && sum % 10 === 0){\r\n                    bet = [50,100][Utils.randomInteger(0,1)];\r\n                } else {\r\n                    bet = [10,20,50,100][Utils.randomInteger(0,3)];\r\n                }\r\n            }\r\n\r\n            this.curBets = bet;\r\n            this.betLabel.string = \"下注:\" + bet;\r\n\r\n            if (GlobalNiuNiu.config.ONLINE_MODE){\r\n                GlobalNiuNiu.netProxy.payBet(bet);\r\n            }\r\n        }, delay != undefined ? delay : 0);\r\n    },\r\n\r\n    showBet(bet){\r\n        this.curBets = bet;\r\n        this.betLabel.string = \"下注:\" + bet;\r\n    },\r\n\r\n    /**\r\n     * 开启手牌\r\n     * @param delay{Number} 延迟开牌(防止机器人同时开牌)\r\n     */\r\n    openHands(delay){\r\n        this.scheduleOnce(()=>{\r\n            let names = [\"没牛\", \"牛1\", \"牛2\", \"牛3\", \"牛4\", \"牛5\", \"牛6\", \"牛7\", \"牛8\", \"牛9\", \"牛牛\", \"银牛\", \"炸弹\", \"五花牛\", \"五小牛\"];\r\n            this.typeReturn = getHandsType(this.hands);\r\n            this.cowLabel.node.active = true;\r\n            this.cowLabel.string = names[this.typeReturn.handsType];\r\n\r\n            GlobalNiuNiu.audioMgr.playEffect(GlobalNiuNiu.audioMgr[\"effNiu_\" + this.typeReturn.handsType]);\r\n\r\n            // 把牌都翻开\r\n            this.cardPanelLeft.removeAllChildren(true);\r\n            for (let cardObj of this.typeReturn.nCards){\r\n                let card = cc.instantiate(GlobalNiuNiu.assetMgr.cardPrefab);\r\n                card.getComponent(\"CardCtrl\").initCard(cardObj.point, cardObj.suit, true);\r\n                card.x = card.y = 0;\r\n                this.cardPanelLeft.addChild(card);\r\n            }\r\n\r\n            this.cardPanelRight.removeAllChildren(true);\r\n            for (let cardObj of this.typeReturn.pCards){\r\n                let card = cc.instantiate(GlobalNiuNiu.assetMgr.cardPrefab);\r\n                card.getComponent(\"CardCtrl\").initCard(cardObj.point, cardObj.suit, true);\r\n                card.x = card.y = 0;\r\n                this.cardPanelRight.addChild(card);\r\n            }\r\n        }, delay != undefined ? delay : 0);\r\n    },\r\n\r\n    addReward(coins,addCoins){\r\n        // this.coins = parseFloat(this.coins) +parseFloat(coins);\r\n        this.coins = coins;\r\n        this.rewardLabel.string = (parseFloat(addCoins)>0?\"+\":\"\") + addCoins;\r\n        this.getComponent(cc.Animation).play(\"showReward\");\r\n    }\r\n\r\n\r\n    // update (dt) {},\r\n});\r\n"]}