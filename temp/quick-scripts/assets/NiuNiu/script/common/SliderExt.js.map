{"version":3,"sources":["SliderExt.js"],"names":["Direction","cc","Enum","Horizontal","Vertical","Class","extends","Slider","properties","barSprite","default","type","Sprite","notify","CC_EDITOR","_updateBarSprite","enableAutoGrayEffect","tooltip","CC_DEV","oldValue","_updateDisabledState","interactable","_handleSliderLogic","touch","_updateProgress","_emitSlideEvent","handle","_sgNode","setState","_updateHandlePosition","handlelocalPos","direction","p","node","width","anchorX","progress","height","anchorY","worldSpacePos","convertToWorldSpaceAR","position","parent","convertToNodeSpaceAR","maxRange","newPos","convertTouchToNodeSpaceAR","clamp01","x","y","maxWidth","curWidth"],"mappings":"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","file":"SliderExt.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\NiuNiu\\script\\common","sourcesContent":["/**\r\n * Created by skyxu on 2018/4/16.\r\n */\r\n\r\n\"use strict\";\r\n\r\nlet Direction = cc.Enum({\r\n    /**\r\n     * !#en The horizontal direction.\r\n     * !#zh 水平方向\r\n     * @property {Number} Horizontal\r\n     */\r\n    Horizontal: 0,\r\n    /**\r\n     * !#en The vertical direction.\r\n     * !#zh 垂直方向\r\n     * @property {Number} Vertical\r\n     */\r\n    Vertical: 1\r\n});\r\n\r\ncc.Class({\r\n    extends: cc.Slider,\r\n\r\n    properties: {\r\n        barSprite: {\r\n            default: null,\r\n            type: cc.Sprite,\r\n            notify: function() {\r\n                if (CC_EDITOR && this.barSprite) {\r\n                    this._updateBarSprite();\r\n                }\r\n            }\r\n        },\r\n\r\n        enableAutoGrayEffect: {\r\n            default: false,\r\n            tooltip: CC_DEV && 'i18n:COMPONENT.button.auto_gray_effect',\r\n            notify: function (oldValue) {\r\n                this._updateDisabledState();\r\n            }\r\n        },\r\n\r\n        interactable: {  \r\n            default: true,\r\n            tooltip: CC_DEV && 'i18n:COMPONENT.button.interactable',\r\n            notify: function (oldValue) {\r\n                this._updateDisabledState();\r\n            }\r\n        }\r\n    },\r\n\r\n    _handleSliderLogic: function (touch) {\r\n        if (!this.interactable){\r\n            return;\r\n        }\r\n\r\n        this._updateProgress(touch);\r\n        this._emitSlideEvent();\r\n    },\r\n\r\n    _updateDisabledState(){\r\n        if (this.handle){\r\n            this.handle.enableAutoGrayEffect = this.enableAutoGrayEffect;\r\n            this.handle.interactable = this.interactable;\r\n        }\r\n\r\n        if(this.barSprite) {\r\n            this.barSprite._sgNode.setState(0);\r\n        }\r\n        if(this.enableAutoGrayEffect) {\r\n            if(this.barSprite && !this.interactable) {\r\n                this.barSprite._sgNode.setState(1);\r\n            }\r\n        }\r\n    },\r\n\r\n    _updateHandlePosition: function () {\r\n        if (!this.handle) {\r\n            return;\r\n        }\r\n        let handlelocalPos;\r\n        if (this.direction === Direction.Horizontal) {\r\n            handlelocalPos = cc.p(-this.node.width * this.node.anchorX + this.progress * this.node.width, 0);\r\n        }\r\n        else {\r\n            handlelocalPos = cc.p(0, -this.node.height * this.node.anchorY + this.progress * this.node.height);\r\n        }\r\n        let worldSpacePos = this.node.convertToWorldSpaceAR(handlelocalPos);\r\n        this.handle.node.position = this.handle.node.parent.convertToNodeSpaceAR(worldSpacePos);\r\n        this._updateBarSprite();\r\n    },\r\n\r\n    _updateProgress: function (touch) {\r\n        if (!this.handle) {\r\n            return;\r\n        }\r\n        let maxRange = null, progress = 0, newPos = this.node.convertTouchToNodeSpaceAR(touch);\r\n        if (this.direction === Direction.Horizontal) {\r\n            maxRange = this.node.width / 2 - this.handle.node.width * this.handle.node.anchorX;\r\n            progress = cc.clamp01((newPos.x + maxRange) / (maxRange * 2), 0, 1);\r\n        }\r\n        else if (this.direction === Direction.Vertical) {\r\n            maxRange = this.node.height / 2 - this.handle.node.height * this.handle.node.anchorY;\r\n            progress = cc.clamp01((newPos.y + maxRange) / (maxRange * 2), 0, 1);\r\n        }\r\n        this.progress = progress;\r\n\r\n        this._updateBarSprite();\r\n    },\r\n\r\n    _updateBarSprite(){\r\n        if (!this.barSprite) {\r\n            return;\r\n        }\r\n        let maxWidth = this.node.width;\r\n        let curWidth = maxWidth * this.progress;\r\n        this.barSprite.node.width = curWidth;\r\n        // mark: 左对齐\r\n        this.barSprite.node.x = this.barSprite.node.anchorX * this.barSprite.node.width - this.node.width * this.node.anchorX;\r\n    }\r\n});"]}