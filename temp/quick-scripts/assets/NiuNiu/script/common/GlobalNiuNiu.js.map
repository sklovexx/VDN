{"version":3,"sources":["GlobalNiuNiu.js"],"names":["window","GlobalNiuNiu","UiUpdater","require","GCONFIG","AudioMgr","IapMgr","DataMgr","ViewMgr","UtilsCross","NetProxy","connectState","eventMgr","cc","EventTarget","uiUpdater","gameMgr","assetMgr","effectMgr","config","audioMgr","tips","iapMgr","getInstance","dataMgr","viewMgr","utilsCross","netProxy","init","preloadScene","_This","sceneName","onLoaded","onProgress","director","info","_getSceneUuid","emit","Director","EVENT_BEFORE_SCENE_LOADING","loader","load","uuid","type","e","a","call","error","asset","errorID","message","Error","loadScene","callback","EVENT_CHANGE_SCENE"],"mappings":";;;;AAAA;;;;AAIA;;AAEAA,OAAOC,YAAP,GAAsBD,OAAOC,YAAP,IAAuB,EAA7C;;AAEA,IAAIC,YAAYC,QAAQ,aAAR,CAAhB;AACA,IAAIC,UAAUD,QAAQ,WAAR,CAAd;AACA,IAAIE,WAAWF,QAAQ,YAAR,CAAf;AACA,IAAIG,SAASH,QAAQ,UAAR,CAAb;AACA,IAAII,UAAUJ,QAAQ,WAAR,CAAd;AACA,IAAIK,UAAUL,QAAQ,WAAR,CAAd;AACA,IAAIM,aAAaN,QAAQ,cAAR,CAAjB;AACA,IAAIO,WAAWP,QAAQ,0BAAR,CAAf;AACAF,aAAaU,YAAb,GAA4B,KAA5B;AACI;;;;AAIJV,aAAaW,QAAb,GAAwB,IAAIC,GAAGC,WAAP,EAAxB;;AAEA;AACAb,aAAac,SAAb,GAAyB,IAAIb,SAAJ,EAAzB;;AAEA;AACAD,aAAae,OAAb,GAAuB,IAAvB;;AAEA;AACAf,aAAagB,QAAb,GAAwB,IAAxB;;AAEAhB,aAAaiB,SAAb,GAAyB,IAAzB;;AAEAjB,aAAakB,MAAb,GAAsBf,OAAtB;;AAEA;AACAH,aAAamB,QAAb,GAAwB,IAAxB;;AAEAnB,aAAaoB,IAAb,GAAoB,IAApB;;AAEApB,aAAaqB,MAAb,GAAsBhB,OAAOiB,WAAP,EAAtB;;AAEAtB,aAAauB,OAAb,GAAuBjB,QAAQgB,WAAR,EAAvB;;AAEAtB,aAAawB,OAAb,GAAuBjB,QAAQe,WAAR,EAAvB;;AAEAtB,aAAayB,UAAb,GAA0BjB,UAA1B;;AAEAR,aAAa0B,QAAb,GAAwB,IAAIjB,QAAJ,EAAxB;AACAT,aAAa0B,QAAb,CAAsBC,IAAtB;;AAEA;;;;;;;AAOA3B,aAAa4B,YAAb,GAA4B,UAASC,KAAT,EAAgBC,SAAhB,EAA2BC,QAA3B,EAAqCC,UAArC,EAAiD;AACzE,QAAIC,WAAWrB,GAAGqB,QAAlB;AACA,QAAIC,OAAOD,SAASE,aAAT,CAAuBL,SAAvB,CAAX;AACA,QAAII,IAAJ,EAAU;AACND,iBAASG,IAAT,CAAcxB,GAAGyB,QAAH,CAAYC,0BAA1B,EAAqDR,SAArD;AACAlB,WAAG2B,MAAH,CAAUC,IAAV,CAAe;AACXC,kBAAMP,KAAKO,IADA;AAEXC,kBAAM;AAFK,SAAf,EAGG,QAAQV,UAAR,GAAqB,IAArB,GAA4B,UAASW,CAAT,EAAYC,CAAZ,EAAe;AAC1CZ,0BAAcA,WAAWa,IAAX,CAAgBhB,KAAhB,EAAuBc,CAAvB,EAA0BC,CAA1B,CAAd;AACH,SALD,EAKG,UAASE,KAAT,EAAgBC,KAAhB,EAAuB;AACtBD,qBAASlC,GAAGoC,OAAH,CAAW,IAAX,EAAiBlB,SAAjB,EAA4BgB,MAAMG,OAAlC,CAAT;AACAlB,wBAAYA,SAASe,KAAT,EAAgBC,KAAhB,CAAZ;AACH,SARD;AASH,KAXD,MAWO;AACH,YAAID,QAAQ,gCAAgChB,SAAhC,GAA4C,4CAAxD;AACAC,oBAAYA,SAAS,IAAImB,KAAJ,CAAUJ,KAAV,CAAT,CAAZ;AACAlC,WAAGkC,KAAH,CAAS,mBAAmBA,KAA5B;AACH;AACJ,CAnBD;;AAqBA9C,aAAamD,SAAb,GAAyB,UAASrB,SAAT,EAAmBsB,QAAnB,EAA4B;AACjDpD,iBAAaW,QAAb,CAAsByB,IAAtB,CAA2BpC,aAAakB,MAAb,CAAoBmC,kBAA/C;AACA,QAAGD,QAAH,EAAY;AACRxC,WAAGqB,QAAH,CAAYkB,SAAZ,CAAsBrB,SAAtB,EAAgCsB,QAAhC;AACH,KAFD,MAEK;AACDxC,WAAGqB,QAAH,CAAYkB,SAAZ,CAAsBrB,SAAtB;AACH;AACJ,CAPD","file":"GlobalNiuNiu.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\NiuNiu\\script\\common","sourcesContent":["/**\r\n * Created by skyxu on 2018/3/13.\r\n */\r\n\r\n\"use strict\";\r\n\r\nwindow.GlobalNiuNiu = window.GlobalNiuNiu || {};\r\n\r\nlet UiUpdater = require(\"./UiUpdater\");\r\nlet GCONFIG = require(\"./GCONFIG\");\r\nlet AudioMgr = require(\"./AudioMgr\");\r\nlet IapMgr = require(\"./IAPMgr\");\r\nlet DataMgr = require(\"./DataMgr\");\r\nlet ViewMgr = require(\"./ViewMgr\");\r\nlet UtilsCross = require(\"./UtilsCross\");\r\nlet NetProxy = require(\"./../net/socket/NetProxy\");\r\nGlobalNiuNiu.connectState = false;\r\n    /**\r\n * 全局事件管理器, 收发事件统一使用\r\n * esp: GlobalNiuNiu.eventMgr.on(\"event\",function(){});\r\n */\r\nGlobalNiuNiu.eventMgr = new cc.EventTarget();\r\n\r\n// 用来刷新ui\r\nGlobalNiuNiu.uiUpdater = new UiUpdater();\r\n\r\n// 常驻节点，用来管理游戏流程\r\nGlobalNiuNiu.gameMgr = null;\r\n\r\n// 用来管理游戏assets（prefab etc.)\r\nGlobalNiuNiu.assetMgr = null;\r\n\r\nGlobalNiuNiu.effectMgr = null;\r\n\r\nGlobalNiuNiu.config = GCONFIG;\r\n\r\n// 用来管理游戏音频播放\r\nGlobalNiuNiu.audioMgr = null;\r\n\r\nGlobalNiuNiu.tips = null;\r\n\r\nGlobalNiuNiu.iapMgr = IapMgr.getInstance();\r\n\r\nGlobalNiuNiu.dataMgr = DataMgr.getInstance();\r\n\r\nGlobalNiuNiu.viewMgr = ViewMgr.getInstance();\r\n\r\nGlobalNiuNiu.utilsCross = UtilsCross;\r\n\r\nGlobalNiuNiu.netProxy = new NetProxy();\r\nGlobalNiuNiu.netProxy.init();\r\n\r\n/**\r\n * hack preloadScene for add progress callback\r\n * @param _This\r\n * @param sceneName\r\n * @param onLoaded\r\n * @param onProgress\r\n */\r\nGlobalNiuNiu.preloadScene = function(_This, sceneName, onLoaded, onProgress) {\r\n    let director = cc.director;\r\n    let info = director._getSceneUuid(sceneName);\r\n    if (info) {\r\n        director.emit(cc.Director.EVENT_BEFORE_SCENE_LOADING,sceneName);\r\n        cc.loader.load({\r\n            uuid: info.uuid,\r\n            type: \"uuid\"\r\n        }, null == onProgress ? null : function(e, a) {\r\n            onProgress && onProgress.call(_This, e, a);\r\n        }, function(error, asset) {\r\n            error && cc.errorID(1215, sceneName, error.message);\r\n            onLoaded && onLoaded(error, asset);\r\n        });\r\n    } else {\r\n        let error = 'Can not preload the scene \"' + sceneName + '\" because it is not in the build settings.';\r\n        onLoaded && onLoaded(new Error(error));\r\n        cc.error(\"preloadScene: \" + error);\r\n    }\r\n};\r\n\r\nGlobalNiuNiu.loadScene = function(sceneName,callback){\r\n    GlobalNiuNiu.eventMgr.emit(GlobalNiuNiu.config.EVENT_CHANGE_SCENE);\r\n    if(callback){\r\n        cc.director.loadScene(sceneName,callback);\r\n    }else{\r\n        cc.director.loadScene(sceneName);\r\n    }\r\n};\r\n"]}