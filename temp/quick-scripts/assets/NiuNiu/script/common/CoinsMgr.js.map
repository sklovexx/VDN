{"version":3,"sources":["CoinsMgr.js"],"names":["DataMgr","require","ViewMgr","CoinsMgr","cc","Class","ctor","costCoins","coins","sucCall","failedCall","toShop","playerObj","getInstance","undefined","call","showShopView","GlobalNiuNiu","uiUpdater","updateUserCoins","addCoins","updateUi","achieveObj","accCoins","module","exports"],"mappings":";;;;AAAA;;;;AAIA;;AAEA,IAAIA,UAAUC,QAAQ,WAAR,CAAd;AACA,IAAIC,UAAUD,QAAQ,WAAR,CAAd;;AAEA,IAAIE,WAAWC,GAAGC,KAAH,CAAS;AACpBC,QADoB,kBACd,CACL;AAFmB,CAAT,CAAf;;AAKA;;;;;;;AAOAH,SAASI,SAAT,GAAqB,UAAUC,KAAV,EAAiBC,OAAjB,EAA0BC,UAA1B,EAAsCC,MAAtC,EAA8C;AAC/D,QAAIC,YAAYZ,QAAQa,WAAR,GAAsBD,SAAtC;AACAD,aAASA,WAASG,SAAT,GAAmB,IAAnB,GAAwBH,MAAjC;AACA,QAAIH,QAAQI,UAAUJ,KAAtB,EAA6B;AACzB,YAAIO,OAAO,IAAX;AACA,YAAIJ,MAAJ,EAAW;AACPI,mBAAO,gBAAI;AACPb,wBAAQW,WAAR,GAAsBG,YAAtB;AACH,aAFD;AAGH,SAJD,MAIO;AACHD,mBAAOL,UAAP;AAEH;AACD;AACA;AACAK;AAEH,KAdD,MAcO;AACHH,kBAAUJ,KAAV,IAAmBA,KAAnB;AACAS,qBAAaC,SAAb,CAAuBC,eAAvB;AACA,YAAIV,OAAJ,EAAa;AACTA;AACH;AACJ;AACJ,CAxBD;;AA0BA;;;;;AAKAN,SAASiB,QAAT,GAAoB,UAAUZ,KAAV,EAAiBa,QAAjB,EAA2B;AAC3C,QAAIT,YAAYZ,QAAQa,WAAR,GAAsBD,SAAtC;AACA,QAAIU,aAAatB,QAAQa,WAAR,GAAsBS,UAAvC;;AAEAV,cAAUJ,KAAV,IAAmBA,KAAnB;AACAc,eAAWC,QAAX,IAAuBf,KAAvB;;AAEA,QAAIa,aAAaP,SAAb,IAA0BO,aAAa,IAA3C,EAAgD;AAC5CA,mBAAW,IAAX;AACH;AACD,QAAIA,QAAJ,EAAa;AACTJ,qBAAaC,SAAb,CAAuBC,eAAvB;AACH;AACJ,CAbD;;AAeAK,OAAOC,OAAP,GAAiBtB,QAAjB","file":"CoinsMgr.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\NiuNiu\\script\\common","sourcesContent":["/**\n * Created by skyxu on 2018/5/3.\n */\n\n\"use strict\";\n\nlet DataMgr = require(\"./DataMgr\");\nlet ViewMgr = require(\"./ViewMgr\");\n\nlet CoinsMgr = cc.Class({\n    ctor(){\n    }\n});\n\n/**\n *\n * @param coins{Number}\n * @param sucCall{Function}\n * @param failedCall{Function}\n * @param toShop{Boolean} 金币不足是否进入商店(默认进入)\n */\nCoinsMgr.costCoins = function (coins, sucCall, failedCall, toShop) {\n    let playerObj = DataMgr.getInstance().playerObj;\n    toShop = toShop===undefined?true:toShop;\n    if (coins > playerObj.coins) {\n        let call = null;\n        if (toShop){\n            call = ()=>{\n                ViewMgr.getInstance().showShopView();\n            }\n        } else {\n            call = failedCall;\n\n        }\n        // mark: 统一弹框提示\n        // AlertView.showGreen(\"Alert\", \"You are out of coins. Visit the shop for more.\", \"OK\", call);\n        call();\n\n    } else {\n        playerObj.coins -= coins;\n        GlobalNiuNiu.uiUpdater.updateUserCoins();\n        if (sucCall) {\n            sucCall();\n        }\n    }\n};\n\n/**\n *\n * @param coins{Number}\n * @param updateUi{Boolean} 默认true, 是否刷新ui\n */\nCoinsMgr.addCoins = function (coins, updateUi) {\n    let playerObj = DataMgr.getInstance().playerObj;\n    let achieveObj = DataMgr.getInstance().achieveObj;\n\n    playerObj.coins += coins;\n    achieveObj.accCoins += coins;\n\n    if (updateUi === undefined || updateUi === null){\n        updateUi = true;\n    }\n    if (updateUi){\n        GlobalNiuNiu.uiUpdater.updateUserCoins();\n    }\n};\n\nmodule.exports = CoinsMgr;"]}