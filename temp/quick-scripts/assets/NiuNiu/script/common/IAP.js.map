{"version":3,"sources":["IAP.js"],"names":["IAPListener","onInitialized","res","cc","log","onSuccess","product","onFailure","msg","onCanceled","onRestored","onProductRequestSuccess","products","obj","i","length","onProductRequestFailure","IAP","Class","init","listener","isDebug","sdkbox","setListener","setDebug","enableUserSideVerification","refresh","pay","name","purchase","restore","module","exports"],"mappings":";;;;AAAA;;;;AAIA;;AAEA;;AAEA,IAAIA,cAAc;AACdC,mBAAe,uBAAUC,GAAV,EAAe;AAC1BC,WAAGC,GAAH,CAAO,sBAAsBF,GAA7B;AACH,KAHa;AAIdG,eAAY,mBAAUC,OAAV,EAAmB;AAC3B;AACH,KANa;AAOdC,eAAY,mBAAUD,OAAV,EAAmBE,GAAnB,EAAwB;AAChC;AACA;AACH,KAVa;AAWdC,gBAAa,oBAAUH,OAAV,EAAmB;AAC5B;AACH,KAba;AAcdI,gBAAa,oBAAUJ,OAAV,EAAmB;AAC5B;AACH,KAhBa;AAiBdK,6BAA0B,iCAAUC,QAAV,EAAoB;AAC1C;AACA;AACA;AACA,YAAIC,MAAM;AACN,oBAAO,cADD;AAEN,kBAAK,0BAFC;AAGN,qBAAQ,EAHF;AAIN,2BAAc,EAJR;AAKN,qBAAQ,EALF,EAKK,gBAAe,EALpB;AAMN,uBAAU,EANJ;AAON,sCAAyB;AAPnB,SAAV;;AAUA,aAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAIF,SAASG,MAA7B,EAAqCD,GAArC,EAA0C;AACtC;AACH;AACJ,KAlCa;AAmCdE,6BAA0B,iCAAUR,GAAV,EAAe;AACrC;AACH;AArCa,CAAlB;;AAwCA,IAAIS,MAAMd,GAAGe,KAAH,CAAS;;AAEf;;;;;AAKA;;;;;AAKAC,UAAM,cAAUC,QAAV,EAAoBC,OAApB,EAA6B;AAC/B,YAAG,OAAOC,MAAP,KAAkB,WAArB,EAAiC;AAC7BnB,eAAGC,GAAH,CAAO,kBAAP;AACA,mBAAO,KAAP;AACH;;AAEDkB,eAAOL,GAAP,CAAWM,WAAX,CAAuBH,QAAvB;AACAE,eAAOL,GAAP,CAAWE,IAAX;AACAG,eAAOL,GAAP,CAAWO,QAAX,CAAoBH,OAApB;AACAC,eAAOL,GAAP,CAAWQ,0BAAX,CAAsC,KAAtC;AACAH,eAAOL,GAAP,CAAWS,OAAX;;AAGA,eAAO,IAAP;AACH,KA1Bc;;AA4Bf;;;AAGAC,SAAK,aAAUC,IAAV,EAAgB;AACjB,YAAGN,OAAOL,GAAV,EAAc;AACVK,mBAAOL,GAAP,CAAWY,QAAX,CAAoBD,IAApB;AACH;AACJ,KAnCc;;AAqCfE,aAAS,mBAAY;AACjB,YAAGR,OAAOL,GAAV,EAAc;AACVK,mBAAOL,GAAP,CAAWa,OAAX;AACH;AACJ,KAzCc;;AA2CfJ,aAAS,mBAAY;AACjB,YAAGJ,OAAOL,GAAV,EAAc;AACVK,mBAAOL,GAAP,CAAWS,OAAX;AACH;AACJ;AA/Cc,CAAT,CAAV;;AAkDAK,OAAOC,OAAP,GAAiBf,GAAjB","file":"IAP.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\NiuNiu\\script\\common","sourcesContent":["/**\r\n * Created by skyxu on 2018/3/13.\r\n */\r\n\r\n//sdk 配置说明 http://docs.sdkbox.com/en/plugins/iap/v3-js/\r\n\r\n\"use strict\";\r\n\r\nlet IAPListener = {\r\n    onInitialized: function (res) {\r\n        cc.log(\"sdkbox iap init: \" + res);\r\n    },\r\n    onSuccess : function (product) {\r\n        //Purchase success\r\n    },\r\n    onFailure : function (product, msg) {\r\n        //Purchase failed\r\n        //msg is the error message\r\n    },\r\n    onCanceled : function (product) {\r\n        //Purchase was canceled by user\r\n    },\r\n    onRestored : function (product) {\r\n        //Purchase restored\r\n    },\r\n    onProductRequestSuccess : function (products) {\r\n        //Returns you the data for all the iap products\r\n        //You can get each item using following method\r\n        //products\r\n        let obj = {\r\n            \"name\":\"coin_package\",\r\n            \"id\":\"com.cocos2dx.plugintest2\",\r\n            \"title\":\"\",\r\n            \"description\":\"\",\r\n            \"price\":\"\",\"currencyCode\":\"\",\r\n            \"receipt\":\"\",\r\n            \"receiptCipheredPayload\":\"\"\r\n        };\r\n\r\n        for (let i = 0; i < products.length; i++) {\r\n            // loop\r\n        }\r\n    },\r\n    onProductRequestFailure : function (msg) {\r\n        //When product refresh request fails.\r\n    }\r\n};\r\n\r\nlet IAP = cc.Class({\r\n\r\n    /**\r\n     *SDKBOX 安装器会自动在您的工程中添加一个样例配置文件sdkbox_config.json.\r\n     * 在您编译工程前,请修改里面的参数,用您自己的应用信息\r\n     */\r\n\r\n    /**\r\n     * @param {Object} listener\r\n     * @param {boolean} isDebug\r\n     * @returns {boolean}\r\n     */\r\n    init: function (listener, isDebug) {\r\n        if(typeof sdkbox === \"undefined\"){\r\n            cc.log(\"sdkbox undefined\");\r\n            return false;\r\n        }\r\n\r\n        sdkbox.IAP.setListener(listener);\r\n        sdkbox.IAP.init();\r\n        sdkbox.IAP.setDebug(isDebug);\r\n        sdkbox.IAP.enableUserSideVerification(false);\r\n        sdkbox.IAP.refresh();\r\n\r\n\r\n        return true;\r\n    },\r\n\r\n    /**\r\n     * @param {string} name sdkbox_config.json对应的key\r\n     */\r\n    pay: function (name) {\r\n        if(sdkbox.IAP){\r\n            sdkbox.IAP.purchase(name);\r\n        }\r\n    },\r\n\r\n    restore: function () {\r\n        if(sdkbox.IAP){\r\n            sdkbox.IAP.restore();\r\n        }\r\n    },\r\n\r\n    refresh: function () {\r\n        if(sdkbox.IAP){\r\n            sdkbox.IAP.refresh();\r\n        }\r\n    }\r\n});\r\n\r\nmodule.exports = IAP;\r\n"]}