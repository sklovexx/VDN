{"version":3,"sources":["EnemyGroupData.js"],"names":["UtilsOther","require","EnemyBaseData","dataMap","dataList","EnemyGroupData","cc","Class","statics","_jsonData","properties","id","enemysInfo","enemyInfoArr","createTimes","init","jsonData","clone","Number","splitWithValueType","String","forEach","currentValue","index","array","enemyInfo","num","isLimitOthers","srcData","JSON","parse","stringify","getRandomEnemy","infoNum","length","idx","randomInteger","info","arrayRmObj","getData","isRemainEnemy","enemyId","setData","initData","list","key","i","data","push","getDataCopy","getDataList"],"mappings":"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","file":"EnemyGroupData.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\NiuNiu\\script\\config","sourcesContent":["/**\n * Created by edisonjiang on 2018/7/31.\n */\n\n\"use strict\";\n\nlet UtilsOther = require('./../common/UtilsOther');\nlet EnemyBaseData = require('./EnemyBaseData');\n\nlet dataMap = {};\nlet dataList = [];\n\nlet EnemyGroupData = cc.Class({\n    statics: {\n        _jsonData: null\n    },\n\n    properties: {\n        id: -1,\n\n        // 敌人信息集合(该集合中的敌人会逐一生成，并减少数量，直至所有敌人都已生成)\n        enemysInfo: \"\",\n        enemyInfoArr: [],\n\n        createTimes: 0\n    },\n\n    init (jsonData) {\n        UtilsOther.clone(jsonData, this);\n\n        this.id = Number(this.id);\n\n        this.enemyInfoArr = UtilsOther.splitWithValueType(this.enemysInfo, String, \";\");\n        this.enemyInfoArr.forEach(function (currentValue, index, array) {\n            let enemyInfo = UtilsOther.splitWithValueType(currentValue, Number, \",\");\n            array[index] = {id: enemyInfo[0], num: enemyInfo[1], isLimitOthers: enemyInfo[2]};\n        });\n\n        this.createTimes = Number(this.createTimes);\n    },\n\n    clone (srcData) {\n        this.id = srcData.id;\n        this.enemysInfo = srcData.enemysInfo;\n        this.enemyInfoArr = JSON.parse(JSON.stringify(srcData.enemyInfoArr));\n        this.createTimes = srcData.createTimes;\n\n        return this;\n    },\n\n    getRandomEnemy () {\n        let infoNum = this.enemyInfoArr.length;\n        if (infoNum <= 0 || this.createTimes <= 0) {\n            return null;\n        }\n\n        let idx = UtilsOther.randomInteger(0, infoNum - 1);\n        let info = this.enemyInfoArr[idx];\n        info.num--;\n        if (info.num <= 0) {\n            UtilsOther.arrayRmObj(this.enemyInfoArr, info);\n        }\n\n        this.createTimes--;\n\n        return EnemyBaseData.getData(info.id);\n    },\n    \n    isRemainEnemy () {\n        return (this.enemyInfoArr.length > 0 && this.createTimes > 0);\n    },\n\n    /**\n     * 在该敌人存在时是否不再产生其他的普通敌人\n     * @param enemyId\n     * @returns {Boolean}\n     */\n    isLimitOthers (enemyId) {\n        for (let enemyInfo of this.enemyInfoArr) {\n            if (enemyInfo.id == enemyId) {\n                return enemyInfo.isLimitOthers;\n            }\n        }\n\n        return false;\n    }\n});\n\nEnemyGroupData.setData = function (jsonData) {\n    EnemyGroupData._jsonData = jsonData;\n};\n\n/**\n * 初始化数据\n * @property {Object} jsonData\n */\nEnemyGroupData.initData = function () {\n    if (!EnemyGroupData._jsonData) {\n        return;\n    }\n\n    let list = EnemyGroupData._jsonData;\n    let key = 'id';\n    for (let i in list) {\n        let data = new EnemyGroupData();\n        data.init(list[i]);\n\n        dataMap[list[i][key]] = data;\n        dataList.push(data);\n    }\n\n    delete EnemyGroupData._jsonData;\n    EnemyGroupData._jsonData = null;\n};\n\n/**\n * 得到某个数据\n * @param {Number} id\n * @returns {EnemyGroupData}\n */\nEnemyGroupData.getData = function (id) {\n    return dataMap[id];\n};\n/**\n * 得到某个数据的副本\n * @param {EnemyGroupData} srcData\n * @returns {EnemyGroupData}\n */\nEnemyGroupData.getDataCopy = function (srcData) {\n    if (srcData instanceof EnemyGroupData) {\n        return new EnemyGroupData().clone(srcData);\n    } else {\n        return null;\n    }\n};\n\n/**\n * 获得数据的列表\n * @returns {Array.<EnemyGroupData>}\n */\nEnemyGroupData.getDataList = function () {\n    return dataList;\n};\n"]}