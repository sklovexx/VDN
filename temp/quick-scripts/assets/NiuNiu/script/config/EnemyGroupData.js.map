{"version":3,"sources":["EnemyGroupData.js"],"names":["UtilsOther","require","EnemyBaseData","dataMap","dataList","EnemyGroupData","cc","Class","statics","_jsonData","properties","id","enemysInfo","enemyInfoArr","createTimes","init","jsonData","clone","Number","splitWithValueType","String","forEach","currentValue","index","array","enemyInfo","num","isLimitOthers","srcData","JSON","parse","stringify","getRandomEnemy","infoNum","length","idx","randomInteger","info","arrayRmObj","getData","isRemainEnemy","enemyId","setData","initData","list","key","i","data","push","getDataCopy","getDataList"],"mappings":"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","file":"EnemyGroupData.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\NiuNiu\\script\\config","sourcesContent":["/**\r\n * Created by edisonjiang on 2018/7/31.\r\n */\r\n\r\n\"use strict\";\r\n\r\nlet UtilsOther = require('./../common/UtilsOther');\r\nlet EnemyBaseData = require('./EnemyBaseData');\r\n\r\nlet dataMap = {};\r\nlet dataList = [];\r\n\r\nlet EnemyGroupData = cc.Class({\r\n    statics: {\r\n        _jsonData: null\r\n    },\r\n\r\n    properties: {\r\n        id: -1,\r\n\r\n        // 敌人信息集合(该集合中的敌人会逐一生成，并减少数量，直至所有敌人都已生成)\r\n        enemysInfo: \"\",\r\n        enemyInfoArr: [],\r\n\r\n        createTimes: 0\r\n    },\r\n\r\n    init (jsonData) {\r\n        UtilsOther.clone(jsonData, this);\r\n\r\n        this.id = Number(this.id);\r\n\r\n        this.enemyInfoArr = UtilsOther.splitWithValueType(this.enemysInfo, String, \";\");\r\n        this.enemyInfoArr.forEach(function (currentValue, index, array) {\r\n            let enemyInfo = UtilsOther.splitWithValueType(currentValue, Number, \",\");\r\n            array[index] = {id: enemyInfo[0], num: enemyInfo[1], isLimitOthers: enemyInfo[2]};\r\n        });\r\n\r\n        this.createTimes = Number(this.createTimes);\r\n    },\r\n\r\n    clone (srcData) {\r\n        this.id = srcData.id;\r\n        this.enemysInfo = srcData.enemysInfo;\r\n        this.enemyInfoArr = JSON.parse(JSON.stringify(srcData.enemyInfoArr));\r\n        this.createTimes = srcData.createTimes;\r\n\r\n        return this;\r\n    },\r\n\r\n    getRandomEnemy () {\r\n        let infoNum = this.enemyInfoArr.length;\r\n        if (infoNum <= 0 || this.createTimes <= 0) {\r\n            return null;\r\n        }\r\n\r\n        let idx = UtilsOther.randomInteger(0, infoNum - 1);\r\n        let info = this.enemyInfoArr[idx];\r\n        info.num--;\r\n        if (info.num <= 0) {\r\n            UtilsOther.arrayRmObj(this.enemyInfoArr, info);\r\n        }\r\n\r\n        this.createTimes--;\r\n\r\n        return EnemyBaseData.getData(info.id);\r\n    },\r\n    \r\n    isRemainEnemy () {\r\n        return (this.enemyInfoArr.length > 0 && this.createTimes > 0);\r\n    },\r\n\r\n    /**\r\n     * 在该敌人存在时是否不再产生其他的普通敌人\r\n     * @param enemyId\r\n     * @returns {Boolean}\r\n     */\r\n    isLimitOthers (enemyId) {\r\n        for (let enemyInfo of this.enemyInfoArr) {\r\n            if (enemyInfo.id == enemyId) {\r\n                return enemyInfo.isLimitOthers;\r\n            }\r\n        }\r\n\r\n        return false;\r\n    }\r\n});\r\n\r\nEnemyGroupData.setData = function (jsonData) {\r\n    EnemyGroupData._jsonData = jsonData;\r\n};\r\n\r\n/**\r\n * 初始化数据\r\n * @property {Object} jsonData\r\n */\r\nEnemyGroupData.initData = function () {\r\n    if (!EnemyGroupData._jsonData) {\r\n        return;\r\n    }\r\n\r\n    let list = EnemyGroupData._jsonData;\r\n    let key = 'id';\r\n    for (let i in list) {\r\n        let data = new EnemyGroupData();\r\n        data.init(list[i]);\r\n\r\n        dataMap[list[i][key]] = data;\r\n        dataList.push(data);\r\n    }\r\n\r\n    delete EnemyGroupData._jsonData;\r\n    EnemyGroupData._jsonData = null;\r\n};\r\n\r\n/**\r\n * 得到某个数据\r\n * @param {Number} id\r\n * @returns {EnemyGroupData}\r\n */\r\nEnemyGroupData.getData = function (id) {\r\n    return dataMap[id];\r\n};\r\n/**\r\n * 得到某个数据的副本\r\n * @param {EnemyGroupData} srcData\r\n * @returns {EnemyGroupData}\r\n */\r\nEnemyGroupData.getDataCopy = function (srcData) {\r\n    if (srcData instanceof EnemyGroupData) {\r\n        return new EnemyGroupData().clone(srcData);\r\n    } else {\r\n        return null;\r\n    }\r\n};\r\n\r\n/**\r\n * 获得数据的列表\r\n * @returns {Array.<EnemyGroupData>}\r\n */\r\nEnemyGroupData.getDataList = function () {\r\n    return dataList;\r\n};\r\n"]}