{"version":3,"sources":["EnemyBaseData.js"],"names":["UtilsOther","require","Type","cc","Enum","NULL","NORMAL","ADVANCED","BOSS","EGG","TORTOISE","TIGER","FLY_REWARD","MoveType","THROW_TOP","THROW_SIDE","HORIZONTAL","SkillType","BOMB","CALL_ENEMYS","HIDE","DropItemType","COINS","PROP_FROZEN","PROP_SHIELD","COINS_SPECIAL","dataMap","dataList","EnemyBaseData","Class","statics","ID_DEFAULT","ID_NULL","GROUP_APPEAR","_jsonData","properties","id","type","minBlood","maxBlood","scale","scaleArr","rotatePeriod","rotatePeriodArr","moveType","moveTypeArr","breedBloodRatio","breedOdds","canSpeedUp","skillType","skillTypeArr","dropItem","dropItemArr","avatarId","avatarIdArr","fixPath","notCalcNum","subEnemyId","subEnemyIdArr","init","jsonData","clone","Number","splitWithValueType","String","forEach","currentValue","index","array","dropInfo","odds","num","getRandomScale","arrayRandomValue","getRandomRotatePeriod","getRandomMoveType","getRandomAvatarId","getSmallerScale","i","length","isOwnSkill","indexOf","getDropItemArr","resultItemArr","Math","random","push","getDropItem","itemType","setData","initData","list","key","data","getData","getDataList"],"mappings":"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","file":"EnemyBaseData.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\NiuNiu\\script\\config","sourcesContent":["/**\r\n * Created by edisonjiang on 2018/4/24.\r\n */\r\n\r\n\"use strict\";\r\n\r\nlet UtilsOther = require('./../common/UtilsOther');\r\n\r\nlet Type = cc.Enum({\r\n    NULL: 0,                // 无\r\n    NORMAL: 1,              // 普通敌人\r\n    ADVANCED: 2,            // 高级敌人\r\n    BOSS: 3,                // BOSS\r\n    EGG: 4,                 // 蛋\r\n    TORTOISE: 5,            // 乌龟\r\n    TIGER: 6,               // 老虎\r\n    FLY_REWARD: 7           // 飞行的奖励\r\n});\r\n\r\nlet MoveType = cc.Enum({\r\n    NULL: 0,                // 无\r\n    THROW_TOP: 1,           // 上方进入\r\n    THROW_SIDE: 2,          // 侧面进入\r\n    HORIZONTAL: 3           // 左右横移\r\n});\r\n\r\nlet SkillType = cc.Enum({\r\n    NULL: 0,                // 无\r\n    BOMB: 1,                // 投弹\r\n    CALL_ENEMYS: 2,         // 召唤小怪\r\n    HIDE: 3                 // 隐身\r\n});\r\n\r\nlet DropItemType = cc.Enum({\r\n    NULL: 0,                // 无\r\n    COINS: 1,               // 金币\r\n    PROP_FROZEN: 2,         // 冰冻道具\r\n    PROP_SHIELD: 3,         // 保护盾道具\r\n    COINS_SPECIAL: 4        // 特殊金币\r\n});\r\n\r\nlet dataMap = {};\r\nlet dataList = [];\r\n\r\n/**\r\n * @property {Number} id 编号\r\n * @property {Number} type 类型\r\n */\r\nlet EnemyBaseData = cc.Class({\r\n    statics: {\r\n        Type: Type,\r\n        MoveType: MoveType,\r\n        SkillType: SkillType,\r\n        DropItemType: DropItemType,\r\n        ID_DEFAULT: 1,\r\n        ID_NULL: 0,\r\n        GROUP_APPEAR: \"appear\",\r\n        \r\n        _jsonData: null\r\n    },\r\n\r\n    properties: {\r\n        id: -1,\r\n        type: Type.NULL,\r\n        minBlood: 0,\r\n        maxBlood: 0,\r\n\r\n        scale: \"\",\r\n        scaleArr: [],\r\n\r\n        rotatePeriod: \"\",\r\n        rotatePeriodArr: [],\r\n\r\n        moveType: \"\",\r\n        moveTypeArr: [],\r\n\r\n        breedBloodRatio: 0,\r\n        breedOdds: 0,\r\n        canSpeedUp: 0,\r\n\r\n        skillType: \"\",\r\n        skillTypeArr: [],\r\n\r\n        dropItem: \"\",\r\n        dropItemArr: [],\r\n\r\n        avatarId: \"\",\r\n        avatarIdArr: [],\r\n\r\n        fixPath: false,\r\n        notCalcNum: false, // 标示该敌人是否不计入关卡当前敌人数量中\r\n\r\n        subEnemyId: \"\", // 特殊敌人产生的子敌人ID集合\r\n        subEnemyIdArr: []\r\n    },\r\n\r\n    init (jsonData) {\r\n        UtilsOther.clone(jsonData, this);\r\n        \r\n        this.id = Number(this.id);\r\n        this.type = Number(this.type);\r\n        this.minBlood = Number(this.minBlood);\r\n        this.maxBlood = Number(this.maxBlood);\r\n        this.breedBloodRatio = Number(this.breedBloodRatio);\r\n        this.breedOdds = Number(this.breedOdds);\r\n        this.canSpeedUp = Number(this.canSpeedUp);\r\n\r\n        this.scaleArr = UtilsOther.splitWithValueType(this.scale, Number, \",\");\r\n        this.rotatePeriodArr = UtilsOther.splitWithValueType(this.rotatePeriod, Number, \",\");\r\n        this.moveTypeArr = UtilsOther.splitWithValueType(this.moveType, Number, \",\");\r\n        this.skillTypeArr = UtilsOther.splitWithValueType(this.skillType, Number, \",\");\r\n\r\n        if (this.dropItem && this.dropItem != \"-1\") {\r\n            this.dropItemArr = UtilsOther.splitWithValueType(this.dropItem, String, \";\");\r\n            this.dropItemArr.forEach(function (currentValue, index, array) {\r\n                let dropInfo = UtilsOther.splitWithValueType(currentValue, Number, \",\");\r\n                array[index] = {type: dropInfo[0], odds: dropInfo[1], num: dropInfo[2]};\r\n            });\r\n        }\r\n\r\n        this.avatarIdArr = UtilsOther.splitWithValueType(this.avatarId, Number, \",\");\r\n\r\n        this.fixPath = (this.fixPath === \"true\");\r\n        this.notCalcNum = (this.notCalcNum === \"true\");\r\n\r\n        if (this.subEnemyId && this.subEnemyId != \"-1\") {\r\n            this.subEnemyIdArr = UtilsOther.splitWithValueType(this.subEnemyId, Number, \",\");\r\n        }\r\n    },\r\n\r\n    getRandomScale () {\r\n        let scale = UtilsOther.arrayRandomValue(this.scaleArr);\r\n        if (scale == null) {\r\n            scale = 1;\r\n        }\r\n        return scale;\r\n    },\r\n\r\n    getRandomRotatePeriod () {\r\n        let rotatePeriod = UtilsOther.arrayRandomValue(this.rotatePeriodArr);\r\n        if (rotatePeriod == null) {\r\n            rotatePeriod = 0;\r\n        }\r\n        return rotatePeriod;\r\n    },\r\n\r\n    getRandomMoveType () {\r\n        let moveType = UtilsOther.arrayRandomValue(this.moveTypeArr);\r\n        if (moveType == null) {\r\n            moveType = MoveType.THROW_TOP;\r\n        }\r\n        return moveType;\r\n    },\r\n\r\n    getRandomAvatarId () {\r\n        let avatarId = UtilsOther.arrayRandomValue(this.avatarIdArr);\r\n        if (avatarId == null) {\r\n            avatarId = EnemyBaseData.ID_DEFAULT;\r\n        }\r\n        return avatarId;\r\n    },\r\n\r\n    getSmallerScale (scale) {\r\n        for (let i = this.scaleArr.length - 1; i >= 0; i--) {\r\n            if (this.scaleArr[i] < scale) {\r\n                return this.scaleArr[i];\r\n            }\r\n        }\r\n\r\n        return 0;\r\n    },\r\n\r\n    isOwnSkill (skillType) {\r\n        return (this.skillTypeArr.indexOf(skillType) >= 0);\r\n    },\r\n\r\n    getDropItemArr () {\r\n        let resultItemArr = [];\r\n        let dropItem = null;\r\n        for (let i in this.dropItemArr) {\r\n            dropItem = this.dropItemArr[i];\r\n            if (Math.random() < dropItem.odds) {\r\n                resultItemArr.push(dropItem);\r\n            }\r\n        }\r\n\r\n        return resultItemArr;\r\n    },\r\n    getDropItem (itemType) {\r\n        for (let dropItem of this.dropItemArr) {\r\n            if (dropItem.type == itemType) {\r\n                return dropItem;\r\n            }\r\n        }\r\n\r\n        return null;\r\n    }\r\n});\r\n\r\nEnemyBaseData.setData = function (jsonData) {\r\n    EnemyBaseData._jsonData = jsonData;\r\n};\r\n\r\n/**\r\n * 初始化数据\r\n * @property {Object} jsonData\r\n */\r\nEnemyBaseData.initData = function () {\r\n    if (!EnemyBaseData._jsonData) {\r\n        return;\r\n    }\r\n\r\n    let list = EnemyBaseData._jsonData;\r\n    let key = 'id';\r\n    for (let i in list) {\r\n        let data = new EnemyBaseData();\r\n        data.init(list[i]);\r\n\r\n        dataMap[list[i][key]] = data;\r\n        dataList.push(data);\r\n    }\r\n\r\n    delete EnemyBaseData._jsonData;\r\n    EnemyBaseData._jsonData = null;\r\n};\r\n\r\n/**\r\n * 得到某个数据\r\n * @param {Number} id\r\n * @returns {EnemyBaseData}\r\n */\r\nEnemyBaseData.getData = function (id) {\r\n    return dataMap[id];\r\n};\r\n\r\n/**\r\n * 获得数据的列表\r\n * @returns {Array.<EnemyBaseData>}\r\n */\r\nEnemyBaseData.getDataList = function () {\r\n    return dataList;\r\n};\r\n"]}