{"version":3,"sources":["gameingUI.js"],"names":["POSITION_UP","POSITION_DOWN","cc","Class","extends","Component","properties","gameingUI","Node","card_prefab","Prefab","failPanel","winPanel","robUI","bottom_card_pos_node","playingUI_node","tipsLabel","Label","startAudio","default","type","AudioClip","buyaoAudio","wangzhaAudio","daniAudio","qiangdizhuAudio","lianduiAudio","shunziAudio","zhadan","feiji","sandaiyi","sandaiyidui","baojin1","baojin2","baojin","onLoad","cards_nods","card_width","rob_player_accountid","fapai_end","bottom_card","bottom_card_data","choose_card_data","outcar_zone","push_card_tmp","node","on","EventType","TOUCH_START","startCallback","TOUCH_END","endCallback","TOUCH_MOVE","moveCallback","myglobal","socket","disconnect","data","gameScene_script","parent","getComponent","emitEventToPlayer","bind","onPushCards","console","log","JSON","stringify","card_data","cur_index_card","length","pushCard","isopen_sound","fapai_audioID","scheduleOnce","_runactive_pushcard","emit","onCanRobState","playerData","accountID","active","oninterval","accountid","roomState","getChildByName","string","time","onendInterval","onCanChuCard","clearOutZone","status","onOtherPlayerChuCard","outCard_node","getUserOutCardPosByAccount","cards","removeAllChildren","audioEngine","play","node_cards","i","card","instantiate","showCards","push","appendOtherCardsToOutZone","playPushCardSound","cardType","name","destoryCard","onGameResult","forEach","e","account","change","panel","script","initData","destoryAllCard","removeFromParent","show_data","call_data","run","callFunc","target","activedata","show_card","obj","runAction","sequence","rotateBy","scaleBy","master_accountid","pushThreeCard","event","detail","cardid","splice","setTimeout","_getCardForTouch","touch","pokerSprite","box","getBoundingBox","contains","isChiose","opacity","_checkSelectCardReserve","touchBegan","touchMoved","p1","x","sprite","warn","width","Math","abs","height","y","rect","intersects","gameScene_node","room_state","roomstate","RoomState","ROOM_PLAYING","touches","getTouches","touchLoc","getLocation","touchStart","convertToNodeSpaceAR","touchMove","carddata","card_id","start","stop","move_node","url","raw","newx","action","moveTo","v2","sortCard","sort","a","b","hasOwnProperty","value","king","timeout","zIndex","scale","index","di_card","position","schedulePushThreeCard","last_card_x","choose_card","destroy_card","j","appendCardsToOutZone","updateCards","children","destroy","pushCardSort","yoffset","addChild","zPoint","cardNode","getChildren","setScale","setPosition","zeroPoint","card_name","CardsValue","one","double","kingboom","doubleScroll","scroll","boom","threeWithOne","threeWithTwo","plane","planeWithOne","planeWithTwo","onButtonClick","customData","requestRobState","qian_state","qian","buqiang","request_buchu_card","request_chu_card","err"],"mappings":"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","file":"gameingUI.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\ddz\\scripts\\gameScene","sourcesContent":["import myglobal from \"../mygolbal.js\"\r\nconst POSITION_UP = 1;\r\nconst POSITION_DOWN = 2;\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        gameingUI: cc.Node,\r\n        card_prefab:cc.Prefab,\r\n        failPanel:cc.Prefab,\r\n        winPanel:cc.Prefab,\r\n        robUI:cc.Node,\r\n        bottom_card_pos_node:cc.Node,\r\n        playingUI_node:cc.Node,\r\n        tipsLabel:cc.Label, //玩家出牌不合法的tips\r\n        startAudio:{\r\n            default:null,\r\n            type:cc.AudioClip\r\n        },\r\n        buyaoAudio:{\r\n            default:null,\r\n            type:cc.AudioClip\r\n        },\r\n        wangzhaAudio:{\r\n            default:null,\r\n            type:cc.AudioClip\r\n        },\r\n        daniAudio:{\r\n            default:null,\r\n            type:cc.AudioClip\r\n        },\r\n        qiangdizhuAudio:{\r\n            default:null,\r\n            type:cc.AudioClip\r\n        },\r\n        lianduiAudio:{\r\n            default:null,\r\n            type:cc.AudioClip\r\n        },\r\n        shunziAudio:{\r\n            default:null,\r\n            type:cc.AudioClip\r\n        },\r\n        zhadan:{\r\n            default:null,\r\n            type:cc.AudioClip\r\n        },\r\n        feiji:{\r\n            default:null,\r\n            type:cc.AudioClip\r\n        },\r\n        sandaiyi:{\r\n            default:null,\r\n            type:cc.AudioClip\r\n        },\r\n        sandaiyidui:{\r\n            default:null,\r\n            type:cc.AudioClip\r\n        },\r\n        baojin1:{\r\n            default:null,\r\n            type:cc.AudioClip\r\n        },\r\n        baojin2:{\r\n            default:null,\r\n            type:cc.AudioClip\r\n        },\r\n        baojin:{\r\n            default:null,\r\n            type:cc.AudioClip\r\n        },\r\n    },\r\n\r\n    onLoad () {\r\n        //自己牌列表 \r\n        this.cards_nods = []\r\n        this.card_width = 0\r\n        //当前可以抢地主的accountid\r\n        this.rob_player_accountid = 0\r\n        //发牌动画是否结束\r\n        this.fapai_end = false\r\n        //底牌数组\r\n        this.bottom_card = []\r\n        //底牌的json对象数据\r\n        this.bottom_card_data=[]\r\n        this.choose_card_data=[]\r\n        this.outcar_zone = []\r\n\r\n        this.push_card_tmp = []\r\n        this.node.on(cc.Node.EventType.TOUCH_START, this.startCallback, this);\r\n        this.node.on(cc.Node.EventType.TOUCH_END, this.endCallback, this);\r\n        this.node.on(cc.Node.EventType.TOUCH_MOVE, this.moveCallback, this);\r\n        //监听服务器:断线消息\r\n        myglobal.socket.disconnect(function(data){\r\n            let gameScene_script = this.node.parent.parent.getComponent(\"gameScene\")\r\n            gameScene_script.emitEventToPlayer(\"disconnect\",data)\r\n        }.bind(this))\r\n        //监听服务器:下发牌消息\r\n        myglobal.socket.onPushCards(function(data){\r\n            console.log(\"onPushCards\"+JSON.stringify(data))\r\n            this.card_data = data\r\n            this.cur_index_card = data.length - 1\r\n            this.pushCard(data)\r\n            if(isopen_sound){\r\n                //循环播放发牌音效\r\n               // this.fapai_audioID = cc.audioEngine.play(cc.url.raw(\"resources/sound/fapai1.mp3\"),true)\r\n                console.log(\"start fapai_audioID\"+this.fapai_audioID) \r\n            }\r\n             //左边移动定时器\r\n            this.scheduleOnce(this._runactive_pushcard.bind(this),0.3)\r\n            this.node.parent.parent.emit(\"pushcard_other_event\")\r\n           \r\n        }.bind(this))\r\n\r\n        //监听服务器:通知抢地主消息,显示相应的UI\r\n        myglobal.socket.onCanRobState(function(data){\r\n            console.log(\"onCanRobState\"+JSON.stringify(data))\r\n            //这里需要2个变量条件：自己是下一个抢地主，2发牌动画结束\r\n            this.rob_player_accountid = data\r\n            if(data==myglobal.playerData.accountID && this.fapai_end==true){\r\n                this.robUI.active = true\r\n                // this.qdzTimer();\r\n            }\r\n          \r\n        }.bind(this))\r\n        myglobal.socket.oninterval(function(data){\r\n            let gameScene_script = this.node.parent.parent.getComponent(\"gameScene\")\r\n            gameScene_script.emitEventToPlayer(\"interval\",data)\r\n            if(data.accountid==myglobal.playerData.accountID){\r\n                if(myglobal.roomState==6){\r\n                    this.playingUI_node.active = true\r\n                    this.playingUI_node.getChildByName('clock').getChildByName('playing_clocl_label').getComponent(cc.Label).string = data.time\r\n                }else{\r\n                    this.robUI.active = true\r\n                    this.robUI.getChildByName('clock').getChildByName('clock_ Label').getComponent(cc.Label).string = data.time\r\n                }      \r\n            }\r\n        }.bind(this))\r\n        myglobal.socket.onendInterval(function(data){\r\n            let gameScene_script = this.node.parent.parent.getComponent(\"gameScene\")\r\n            gameScene_script.emitEventToPlayer(\"endInterval\",data)\r\n            if(data.accountid==myglobal.playerData.accountID){\r\n                this.robUI.active = false\r\n                this.playingUI_node.active = false\r\n            }\r\n        }.bind(this))\r\n        //监听服务器可以出牌消息\r\n        myglobal.socket.onCanChuCard(function(data){\r\n            console.log(\"onCanChuState\"+JSON.stringify(data))\r\n            let gameScene_script = this.node.parent.parent.getComponent(\"gameScene\")\r\n            gameScene_script.emitEventToPlayer(\"onCanChuCard\",data)\r\n            //判断是不是自己能出牌\r\n            if(data.accountid==myglobal.playerData.accountID){\r\n                //先清理出牌区域\r\n                this.clearOutZone(myglobal.playerData.accountID)\r\n                //先把自己出牌列表置空\r\n                //this.choose_card_data=[]\r\n                //显示可以出牌的UI\r\n                this.playingUI_node.active = true\r\n                if(data.status==1){\r\n                    this.playingUI_node.getChildByName(\"btn_buchu_node\").active = false;\r\n                }else{\r\n                    this.playingUI_node.getChildByName(\"btn_buchu_node\").active = true;\r\n                }\r\n            }\r\n        }.bind(this))\r\n\r\n        //监听服务器：其他玩家出牌消息\r\n        myglobal.socket.onOtherPlayerChuCard(function(data){\r\n            //{\"accountid\":\"2357540\",\"cards\":[{\"cardid\":4,\"card_data\":{\"index\":4,\"value\":1,\"shape\":1}}]}\r\n            console.log(\"onOtherPlayerChuCard\"+JSON.stringify(data))\r\n            var accountid = data.accountid\r\n            var gameScene_script = this.node.parent.parent.getComponent(\"gameScene\")\r\n            //获取出牌区域节点\r\n            var outCard_node = gameScene_script.getUserOutCardPosByAccount(accountid)\r\n            if(outCard_node==null){\r\n                return\r\n            }\r\n            if(data.cards==null){\r\n                gameScene_script.emitEventToPlayer(\"onBuChu\",data);\r\n                outCard_node.removeAllChildren(true);\r\n                cc.audioEngine.play(this.buyaoAudio)\r\n                return;\r\n            }\r\n            gameScene_script.emitEventToPlayer(\"onOtherPlayerChuCard\",data)\r\n            var node_cards = []\r\n            for(var i=0;i<data.cards.length;i++){\r\n                var card = cc.instantiate(this.card_prefab)\r\n                card.getComponent(\"card\").showCards(data.cards[i].card_data,myglobal.playerData.accountID)\r\n                node_cards.push(card)\r\n            }\r\n            this.appendOtherCardsToOutZone(outCard_node,node_cards,0)\r\n            this.playPushCardSound(data.cardType.name)\r\n            if(data.accountid==myglobal.playerData.accountID){\r\n                this.destoryCard(data.accountid,data.cards)\r\n                this.choose_card_data = []\r\n            }\r\n        }.bind(this))\r\n        //监听服务器：游戏结算消息\r\n        myglobal.socket.onGameResult(function(data){\r\n            console.log(\"onGameResult\"+JSON.stringify(data))\r\n            let gameScene_script = this.node.parent.parent.getComponent(\"gameScene\")\r\n            gameScene_script.emitEventToPlayer(\"onGameResult\",data)\r\n            data.forEach(e=>{\r\n                console.log(e)\r\n                if(e.account==myglobal.playerData.accountID){\r\n                    console.log(e.change)\r\n                    if(e.change<0){\r\n                        let panel = cc.instantiate(this.failPanel)\r\n                        let script = panel.getComponent('failPanel')\r\n                        script.initData(data)\r\n                        panel.parent = this.node.parent;\r\n                    }else{\r\n                        let panel = cc.instantiate(this.winPanel)\r\n                        let script = panel.getComponent('winPanel')\r\n                        script.initData(data)\r\n                        panel.parent = this.node.parent;\r\n                    }\r\n                }\r\n            })\r\n        }.bind(this))\r\n        //内部事件：准备阶段初始化\r\n        this.node.on(\"room_waitready\",function(){\r\n            this.robUI.active = false;\r\n            this.fapai_end = false;\r\n            this.playingUI_node.active = false;\r\n            this.push_card_tmp = [];\r\n            this.choose_card_data=[]\r\n            this.destoryAllCard();\r\n            this.bottom_card.forEach(e=>{\r\n                e.removeFromParent(true)\r\n            })\r\n            this.bottom_card_data = []\r\n            this.bottom_card = []\r\n        }.bind(this))\r\n        //内部事件:显示底牌事件,data是三张底牌数据\r\n        this.node.on(\"show_bottom_card_event\",function(data){\r\n            console.log(\"----show_bottom_card_event\",+data)\r\n          \r\n            this.bottom_card_data = data\r\n            \r\n            for(var i=0;i<data.length;i++){\r\n                var card = this.bottom_card[i]\r\n                var show_data = data[i]\r\n                var call_data = {\r\n                    \"obj\":card,\r\n                    \"data\":show_data,\r\n                }\r\n                console.log(\"bottom show_data:\"+JSON.stringify(show_data))\r\n                var run =  cc.callFunc(function(target,activedata){\r\n                   \r\n                    var show_card = activedata.obj\r\n                    var show_data = activedata.data\r\n                    //console.log(\"cc.callFunc:\"+JSON.stringify(show_data))\r\n                    show_card.getComponent(\"card\").showCards(show_data)\r\n                   \r\n                },this,call_data)\r\n\r\n                card.runAction(cc.sequence(cc.rotateBy(0,0,180),cc.rotateBy(0.2,0,-90), run,\r\n                cc.rotateBy(0.2,0,-90),cc.scaleBy(1, 1.2)));\r\n               \r\n                if(true){\r\n                    cc.audioEngine.play(this.startAudio) \r\n                 }\r\n            }\r\n            //this.node.parent.emit(\"change_room_state_event\",RoomState.ROOM_PLAYING)\r\n            //如果自己地主，给加上三张底牌\r\n            if(myglobal.playerData.accountID==myglobal.playerData.master_accountid){\r\n                this.scheduleOnce(this.pushThreeCard.bind(this),0.2)\r\n            }\r\n            let gameScene_script = this.node.parent.parent.getComponent(\"gameScene\")\r\n            gameScene_script.emitEventToPlayer(\"show_bottom_card_event\")\r\n              \r\n        }.bind(this))\r\n\r\n        //注册监听一个选择牌消息 \r\n        this.node.on(\"choose_card_event\",function(event){\r\n            console.log(\"choose_card_event:\"+JSON.stringify(event))\r\n            var detail = event\r\n            this.choose_card_data.push(detail)\r\n        }.bind(this))\r\n\r\n        this.node.on(\"unchoose_card_event\",function(event){\r\n            console.log(\"unchoose_card_event:\"+ event)\r\n            var detail = event\r\n            for(var i=0;i<this.choose_card_data.length;i++){\r\n                if(this.choose_card_data[i].cardid==detail){\r\n                    this.choose_card_data.splice(i,1)\r\n                }\r\n            }\r\n        }.bind(this))\r\n        this.node.on(\"game_settle_event\",function(data){\r\n            console.log(\"game_settle_event:\"+data)\r\n            this.tipsLabel.string=\"正在结算!\"\r\n            setTimeout(function(){\r\n                this.tipsLabel.string=\"\"\r\n            }.bind(this), 2000);\r\n        }.bind(this))\r\n    },\r\n    _getCardForTouch: function(touch){\r\n        for(var i = this.cards_nods.length - 1; i >= 0; i--){// 需要倒序\r\n            var pokerSprite = this.cards_nods[i];\r\n            var box = pokerSprite.getBoundingBox();\r\n            if (box.contains(touch)) {\r\n                console.log('in');\r\n                pokerSprite.isChiose = true;\r\n                pokerSprite.opacity = 185;\r\n                return;//关键， 找到一个就返回\r\n            }\r\n        }\r\n    },\r\n    _checkSelectCardReserve(touchBegan, touchMoved) {\r\n        // console.log('_checkSelectCardReserve');\r\n        var p1 = touchBegan.x-5 < touchMoved.x ? touchBegan : touchMoved;\r\n        console.log(touchBegan.x,touchMoved.x)\r\n        \r\n        if (p1 === touchMoved) {\r\n            // for (let i = this.pokerSpriteList.length - 1; i >= 0; i--) {\r\n            for(let i in this.cards_nods){\r\n                var sprite = this.cards_nods[i];\r\n                if (p1.x - sprite.x > -25) {  //\r\n                    sprite.opacity = 255;\r\n                    console.warn(false)\r\n                    sprite.isChiose = false;\r\n                }\r\n            }\r\n        }\r\n        else{\r\n            var width = Math.abs(touchBegan.x - touchMoved.x);\r\n            var height = Math.abs(touchBegan.y - touchMoved.y) > 5 ? Math.abs(touchBegan.y - touchMoved.y) : 5;\r\n            var rect = cc.rect(p1.x, p1.y, width, height);\r\n\r\n            for (let i = 0; i < this.cards_nods.length; i++) {\r\n                if (!this.cards_nods[i].getBoundingBox().intersects(rect)) {\r\n                    this.cards_nods[i].isChiose = false;\r\n                    console.warn(true)\r\n                    this.cards_nods[i].opacity = 255;\r\n                }\r\n            }\r\n        }\r\n\r\n    },\r\n    startCallback: function(event){\r\n        var gameScene_node = this.node.parent.parent  \r\n        var room_state = gameScene_node.getComponent(\"gameScene\").roomstate\r\n        if(room_state==RoomState.ROOM_PLAYING){\r\n            console.log('start');\r\n            var touches = event.getTouches();\r\n            var touchLoc = touches[0].getLocation();\r\n            // console.log(touchLoc.x + \",\" + touchLoc.y)\r\n            this.touchStart = this.node.parent.convertToNodeSpaceAR(touchLoc);//将坐标转换为当前节点坐标\r\n            // console.log(this.touchStart.x + \",\" + this.touchStart.y)\r\n            this._getCardForTouch(this.touchStart);\r\n        }\r\n    },\r\n    moveCallback: function(event){\r\n        var gameScene_node = this.node.parent.parent  \r\n        var room_state = gameScene_node.getComponent(\"gameScene\").roomstate\r\n        if(room_state==RoomState.ROOM_PLAYING){\r\n            console.log('move');\r\n            var touches = event.getTouches();\r\n            var touchLoc = touches[0].getLocation();\r\n            this.touchMove = this.node.parent.convertToNodeSpaceAR(touchLoc);//将坐标转换为当前节点坐标\r\n            this._getCardForTouch(this.touchMove);\r\n            //当选过头了，往回拖的时候取消选择\r\n            this._checkSelectCardReserve(this.touchStart, this.touchMove);\r\n        }\r\n    },\r\n    endCallback: function(event){\r\n        var gameScene_node = this.node.parent.parent  \r\n        var room_state = gameScene_node.getComponent(\"gameScene\").roomstate\r\n        if(room_state==RoomState.ROOM_PLAYING){\r\n            console.log('end');\r\n            for(var i = 0; i < this.cards_nods.length; i++){\r\n                var pokerSprite = this.cards_nods[i];\r\n                var carddata = {    \r\n                    \"cardid\":pokerSprite.card_id,\r\n                    \"card_data\":pokerSprite.card_data,\r\n                }\r\n                if (pokerSprite.isChiose) {\r\n                    pokerSprite.isChiose = false;\r\n                    pokerSprite.opacity = 255;\r\n                    if(pokerSprite.status === POSITION_UP){\r\n                        pokerSprite.status = POSITION_DOWN;\r\n                        pokerSprite.y -= 20;\r\n                        this.node.emit(\"unchoose_card_event\",pokerSprite.card_id)\r\n                    }\r\n                    else{\r\n                        pokerSprite.status = POSITION_UP;\r\n                        pokerSprite.y += 20;\r\n                        this.node.emit(\"choose_card_event\",carddata)\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    start () {\r\n     \r\n    },\r\n    //处理发牌的效果\r\n    _runactive_pushcard(){\r\n        //console.log(\"_runactive_pushcard:\"+this.cur_index_card)\r\n        if(this.cur_index_card < 0){\r\n            console.log(\"pushcard end\")\r\n            //发牌动画完成，显示抢地主按钮\r\n            //this.robUI.active = true\r\n            this.fapai_end = true\r\n            // if(this.rob_player_accountid==myglobal.playerData.accountID){\r\n            //     this.robUI.active = true\r\n            // }\r\n\r\n            if(true){\r\n                //console.log(\"start fapai_audioID\"+this.fapai_audioID) \r\n                cc.audioEngine.stop(this.fapai_audioID)\r\n            }\r\n           \r\n\r\n              //通知gamescene节点，倒计时\r\n            // var sendevent = this.rob_player_accountid\r\n            // this.node.parent.parent.emit(\"canrob_event\",sendevent)\r\n\r\n            return\r\n        }\r\n\r\n        //原有逻辑  \r\n        // var move_node = this.cards_nods[this.cur_index_card]\r\n        // move_node.active = true\r\n        // var newx = move_node.x + (this.card_width * 0.4*this.cur_index_card) - (this.card_width * 0.4)\r\n        // var action = cc.moveTo(0.1, cc.v2(newx, -250));\r\n        // move_node.runAction(action)\r\n        // this.cur_index_card--\r\n        // this.scheduleOnce(this._runactive_pushcard.bind(this),0.3)\r\n\r\n        \r\n        var move_node = this.cards_nods[this.cards_nods.length-this.cur_index_card-1]\r\n        move_node.active = true\r\n        this.push_card_tmp.push(move_node)\r\n        this.fapai_audioID = cc.audioEngine.play(cc.url.raw(\"resources/sound/fapai1.mp3\"))\r\n        for(var i=0;i<this.push_card_tmp.length-1;i++){\r\n                var move_node = this.push_card_tmp[i]\r\n                var newx = move_node.x - (this.card_width * 0.4)\r\n                var action = cc.moveTo(0.05, cc.v2(newx, -250));\r\n                move_node.runAction(action)\r\n        }\r\n        \r\n        this.cur_index_card--\r\n        this.scheduleOnce(this._runactive_pushcard.bind(this),0.15)\r\n    },\r\n \r\n    //对牌排序\r\n    sortCard(){\r\n        this.cards_nods.sort(function(x,y){\r\n            var a = x.getComponent(\"card\").card_data;\r\n            var b = y.getComponent(\"card\").card_data;\r\n\r\n            if (a.hasOwnProperty('value') && b.hasOwnProperty('value')) {\r\n                return  b.value-a.value;\r\n            }\r\n            if (a.hasOwnProperty('king') && !b.hasOwnProperty('king')) {\r\n                return -1;\r\n            }\r\n            if (!a.hasOwnProperty('king') && b.hasOwnProperty('king')) {\r\n                return 1;\r\n            }\r\n            if (a.hasOwnProperty('king') && b.hasOwnProperty('king')) {\r\n                return  b.king-a.king;\r\n            }\r\n        })\r\n        //var x = this.cards_nods[0].x;\r\n        //这里使用固定坐标，因为取this.cards_nods[0].xk可能排序为完成，导致x错误\r\n        //所以做1000毫秒的延时\r\n        var timeout = 1000\r\n        setTimeout(function(){\r\n            //var x = -417.6 \r\n            var x = this.cards_nods[0].x;\r\n            console.log(\"sort x:\"+ x)\r\n            if(x>0){\r\n                x = -400;\r\n            }\r\n            for (let i = 0; i < this.cards_nods.length; i++) {\r\n                var card = this.cards_nods[i];\r\n                card.zIndex = i; //设置牌的叠加次序,zindex越大显示在上面\r\n                card.x = x + card.width * 0.4 * i;\r\n            }\r\n        }.bind(this), timeout);\r\n        \r\n       \r\n    },\r\n\r\n  \r\n    pushCard(data){\r\n    if (data) {\r\n            data.sort(function (a, b) {\r\n                if (a.hasOwnProperty('value') && b.hasOwnProperty('value')) {\r\n                    return b.value - a.value;\r\n                }\r\n                if (a.hasOwnProperty('king') && !b.hasOwnProperty('king')) {\r\n                    return -1;\r\n                }\r\n                if (!a.hasOwnProperty('king') && b.hasOwnProperty('king')) {\r\n                    return 1;\r\n                }\r\n                if (a.hasOwnProperty('king') && b.hasOwnProperty('king')) {\r\n                    return b.king - a.king;\r\n                }\r\n            });\r\n        }\r\n      //创建card预制体\r\n      this.cards_nods = []\r\n      for(var i=0;i<17;i++){\r\n        \r\n        var card = cc.instantiate(this.card_prefab)\r\n        card.scale=0.8\r\n        card.parent = this.node.parent\r\n        //card.x = card.width * 0.4 * (17 - 1) * (-0.5) + card.width * 0.4 * 0;\r\n        card.x = card.width * 0.4 * (-0.5) * (-16) + card.width * 0.4 * 0;\r\n        //这里实现为，每发一张牌，放在已经发的牌最后，然后整体移动\r\n        card.y = -250\r\n        card.active = false\r\n\r\n        card.getComponent(\"card\").showCards(data[i],myglobal.playerData.accountID)\r\n        //存储牌的信息,用于后面发牌效果\r\n        card.card_id = data[i].index;\r\n        card.card_data = data[i]\r\n        card.status = 2;\r\n        this.cards_nods.push(card)\r\n        this.card_width = card.width\r\n      }\r\n      \r\n      //创建3张底牌\r\n      this.bottom_card = []\r\n      for(var i=0;i<3;i++){\r\n        var di_card = cc.instantiate(this.card_prefab)\r\n        di_card.scale=0.4\r\n        di_card.position = this.bottom_card_pos_node.position \r\n        //三张牌，中间坐标就是bottom_card_pos_node节点坐标，\r\n        //0,和2两张牌左右移动windth*0.4\r\n        if(i==0){\r\n            \r\n            di_card.x = di_card.x - di_card.width*0.4\r\n        }else if(i==2){\r\n            di_card.x = di_card.x + di_card.width*0.4\r\n        }\r\n        \r\n\r\n        //di_card.x = di_card.width-i*di_card.width-20\r\n        //di_card.y=60\r\n        di_card.parent = this.node.parent\r\n        //存储在容器里\r\n        this.bottom_card.push(di_card)\r\n      }\r\n\r\n    },\r\n\r\n    //给玩家发送三张底牌后，过1s,把牌设置到y=-250位置效果\r\n    schedulePushThreeCard(){\r\n        for(var i=0;i<this.cards_nods.length;i++){\r\n            var card = this.cards_nods[i]\r\n            if(card.y==-230){\r\n                card.y = -250\r\n            }\r\n        }\r\n    },\r\n    //给地主发三张排，并显示在原有牌的后面\r\n    pushThreeCard(){\r\n        //每张牌的其实位置 \r\n        var last_card_x =  this.cards_nods[this.cards_nods.length-1].x\r\n        for(var i=0;i<this.bottom_card_data.length;i++){\r\n            var card = cc.instantiate(this.card_prefab)\r\n            card.scale=0.8\r\n            card.parent = this.node.parent\r\n          \r\n            card.x = last_card_x + ((i+1)*this.card_width * 0.4)\r\n            card.y = -230  //先把底盘放在-230，在设置个定时器下移到-250的位置\r\n           \r\n            //console.log(\"pushThreeCard x:\"+card.x)\r\n            card.getComponent(\"card\").showCards(this.bottom_card_data[i],myglobal.playerData.accountID)\r\n            card.active = true\r\n            card.card_id = this.bottom_card_data[i].index;\r\n            card.card_data = this.bottom_card_data[i]\r\n            card.status = 2\r\n            this.cards_nods.push(card)\r\n        }\r\n\r\n        this.sortCard()\r\n        //设置一个定时器，在2s后，修改y坐标为-250\r\n        this.scheduleOnce(this.schedulePushThreeCard.bind(this),2)\r\n\r\n    },\r\n    destoryAllCard(){\r\n        this.cards_nods.forEach(e => {\r\n            e.removeFromParent(true)\r\n        });\r\n    },\r\n    destoryCard(accountid,choose_card){\r\n        if(choose_card.length==0){\r\n            return\r\n        }\r\n\r\n        /*出牌逻辑\r\n          1. 将选中的牌 从父节点中移除\r\n          2. 从this.cards_nods 数组中，删除 选中的牌 \r\n          3. 将 “选中的牌” 添加到出牌区域\r\n              3.1 清空出牌区域\r\n              3.2 添加子节点\r\n              3.3 设置scale\r\n              3.4 设置position\r\n          4.  重新设置手中的牌的位置  this.updateCards();\r\n        */\r\n        //1/2步骤删除自己手上的card节点 \r\n        var destroy_card = []\r\n        for(var i=0;i<choose_card.length;i++){\r\n            for(var j=0;j<this.cards_nods.length;j++){\r\n                var card_id = this.cards_nods[j].getComponent(\"card\").card_id\r\n                if(card_id==choose_card[i].cardid){\r\n                    console.log(\"destroy card id:\"+card_id)\r\n                    //this.cards_nods[j].destroy()\r\n                    this.cards_nods[j].removeFromParent(true);\r\n                    destroy_card.push(this.cards_nods[j])\r\n                    this.cards_nods.splice(j,1)\r\n                }\r\n            }\r\n        }\r\n        if(this.cards_nods.length==1){\r\n            cc.audioEngine.play(this.baojin)\r\n            cc.audioEngine.play(this.baojin1)\r\n        }\r\n        if(this.cards_nods.length==2){\r\n            cc.audioEngine.play(this.baojin)\r\n            cc.audioEngine.play(this.baojin2)\r\n        }\r\n        this.appendCardsToOutZone(accountid,destroy_card)\r\n        this.updateCards()\r\n        this.cards_nods.forEach(e=>{\r\n            e.y = -250;\r\n            e.isChiose = false;\r\n            e.status = POSITION_DOWN;\r\n        })\r\n    },\r\n\r\n    //清除显示出牌节点全部子节点(就是把出牌的清空)\r\n    clearOutZone(accountid){\r\n        var gameScene_script = this.node.parent.parent.getComponent(\"gameScene\")\r\n        var outCard_node = gameScene_script.getUserOutCardPosByAccount(accountid)\r\n        var children = outCard_node.children;\r\n        for(var i=0;i<children.length;i++){\r\n            var card = children[i]; \r\n            card.destroy()\r\n        }\r\n        outCard_node.removeAllChildren(true);\r\n    },\r\n    //对出的牌做排序\r\n    pushCardSort(cards){\r\n        if(cards.length==1){\r\n            return\r\n        }\r\n        cards.sort(function(x,y){\r\n            var a = x.getComponent(\"card\").card_data;\r\n            var b = y.getComponent(\"card\").card_data;\r\n\r\n            if (a.hasOwnProperty('value') && b.hasOwnProperty('value')) {\r\n                return b.value - a.value;\r\n            }\r\n            if (a.hasOwnProperty('king') && !b.hasOwnProperty('king')) {\r\n                return -1;\r\n            }\r\n            if (!a.hasOwnProperty('king') && b.hasOwnProperty('king')) {\r\n                return 1;\r\n            }\r\n            if (a.hasOwnProperty('king') && b.hasOwnProperty('king')) {\r\n                return b.king - a.king;\r\n            }\r\n        })\r\n    },\r\n\r\n    appendOtherCardsToOutZone(outCard_node,cards,yoffset){\r\n       outCard_node.removeAllChildren(true);\r\n\r\n       //console.log(\"appendOtherCardsToOutZone length\"+cards.length)\r\n       //添加新的子节点\r\n       for(var i=0;i<cards.length;i++){\r\n           var card = cards[i]; \r\n           outCard_node.addChild(card,100+i) //第二个参数是zorder,保证牌不能被遮住\r\n       }\r\n\r\n       //对出牌进行排序\r\n       //设置出牌节点的坐标\r\n       var zPoint = cards.length / 2;\r\n       //console.log(\"appendOtherCardsToOutZone zeroPoint:\"+zPoint)\r\n       for(var i=0;i<cards.length;i++){\r\n        var cardNode = outCard_node.getChildren()[i]\r\n        var x = (i - zPoint) * 30;\r\n        var y = cardNode.y+yoffset; //因为每个节点需要的Y不一样，做参数传入\r\n        //console.log(\"-----cardNode: x:\"+x+\" y:\"+y)\r\n        cardNode.setScale(0.5, 0.5);                   \r\n        cardNode.setPosition(x,y);                     \r\n\r\n       }\r\n    },\r\n    //将 “选中的牌” 添加到出牌区域\r\n    //destroy_card是玩家本次出的牌\r\n    appendCardsToOutZone(accountid,destroy_card){\r\n        if(destroy_card.length==0){\r\n            return\r\n        }\r\n        //先给本次出的牌做一个排序\r\n       this.pushCardSort(destroy_card)\r\n       //console.log(\"appendCardsToOutZone\")\r\n       var gameScene_script = this.node.parent.parent.getComponent(\"gameScene\")\r\n       //获取出牌区域节点\r\n       var outCard_node = gameScene_script.getUserOutCardPosByAccount(accountid)\r\n       this.appendOtherCardsToOutZone(outCard_node,destroy_card,360)\r\n       //sconsole.log(\"OutZone:\"+outCard_node.name)\r\n\r\n    },\r\n\r\n    //重新排序手上的牌,并移动\r\n    updateCards(){\r\n    \r\n        var zeroPoint = this.cards_nods.length / 2;\r\n        //var last_card_x = this.cards_nods[this.cards_nods.length-1].x\r\n        for(var i=0;i<this.cards_nods.length;i++){\r\n            var cardNode = this.cards_nods[i]\r\n            var x = (i - zeroPoint)*(this.card_width * 0.4);\r\n            cardNode.setPosition(x, -250);  \r\n        }\r\n\r\n    },\r\n    \r\n    playPushCardSound(card_name){\r\n        console.log(\"playPushCardSound:\"+card_name)\r\n        \r\n        if(card_name==\"\"){\r\n            return\r\n        }\r\n\r\n        switch(card_name){\r\n            case CardsValue.one.name:\r\n                break\r\n            case CardsValue.double.name:\r\n                    if(true){\r\n                        cc.audioEngine.play(cc.url.raw(\"resources/sound/duizi.mp3\")) \r\n                     }\r\n                break\r\n            case CardsValue.kingboom.name:\r\n                console.log('王炸')\r\n                cc.audioEngine.play(this.wangzhaAudio)\r\n                break\r\n            case CardsValue.doubleScroll.name:\r\n                cc.audioEngine.play(this.lianduiAudio)\r\n                break\r\n            case CardsValue.scroll.name:\r\n                cc.audioEngine.play(this.shunziAudio)\r\n                break\r\n            case CardsValue.boom.name:\r\n                cc.audioEngine.play(this.zhadan)\r\n                break\r\n            case CardsValue.threeWithOne.name:\r\n                cc.audioEngine.play(this.sandaiyi)\r\n                break\r\n            case CardsValue.threeWithTwo.name:\r\n                cc.audioEngine.play(this.sandaiyidui)\r\n                break\r\n            case CardsValue.plane.name:\r\n                cc.audioEngine.play(this.feiji)\r\n                break\r\n            case CardsValue.planeWithOne.name:\r\n                cc.audioEngine.play(this.feiji)\r\n                break\r\n            case CardsValue.planeWithTwo.name:\r\n                cc.audioEngine.play(this.feiji)\r\n                break                                     \r\n        }\r\n    },\r\n    // update (dt) {},\r\n    onButtonClick(event,customData){\r\n        switch(customData){\r\n            case \"btn_qiandz\":\r\n                console.log(\"btn_qiandz\")\r\n                myglobal.socket.requestRobState(qian_state.qian)\r\n                this.robUI.active = false\r\n                if(true){\r\n                    cc.audioEngine.play(cc.url.raw(\"resources/sound/woman_jiao_di_zhu.ogg\")) \r\n                 }\r\n                break\r\n            case \"btn_buqiandz\":\r\n                console.log(\"btn_buqiandz\")\r\n                myglobal.socket.requestRobState(qian_state.buqiang)\r\n                this.robUI.active = false\r\n                if(true){\r\n                    cc.audioEngine.play(cc.url.raw(\"resources/sound/woman_bu_jiao.ogg\")) \r\n                 }\r\n                 break    \r\n             case \"nopushcard\":  //不出牌\r\n                 myglobal.socket.request_buchu_card([],null)\r\n                 this.playingUI_node.active = false\r\n                 break\r\n             case \"pushcard\":   //出牌\r\n                 //先获取本次出牌数据\r\n                 if(this.choose_card_data.length==0){\r\n                    this.tipsLabel.string=\"请选择牌!\"\r\n                    setTimeout(function(){\r\n                        this.tipsLabel.string=\"\"\r\n                    }.bind(this), 2000);\r\n                 }\r\n                 myglobal.socket.request_chu_card(this.choose_card_data,function(err,data){\r\n                   \r\n                    if(err){\r\n                        console.log(\"request_chu_card:\"+err)\r\n                        console.log(\"request_chu_card\"+JSON.stringify(data))\r\n                        if(this.tipsLabel.string==\"\"){\r\n                            this.tipsLabel.string = data\r\n                            setTimeout(function(){\r\n                                this.tipsLabel.string=\"\"\r\n                            }.bind(this), 2000);\r\n                        }\r\n                        \r\n                        //出牌失败，把选择的牌归位\r\n                        for(var i=0;i<this.cards_nods.length;i++){\r\n                            var card = this.cards_nods[i]\r\n                            card.emit(\"reset_card_flag\")\r\n                        }\r\n                        this.choose_card_data = []\r\n                     }else{\r\n                         //出牌成功\r\n                         console.log(\"resp_chu_card data:\"+JSON.stringify(data))\r\n                         this.playingUI_node.active = false\r\n                         //播放出牌的声音\r\n                         //resp_chu_card data:{\"account\":\"2519901\",\"msg\":\"sucess\",\"cardvalue\":{\"name\":\"Double\",\"value\":1}}\r\n                         //{\"type\":\"other_chucard_notify\",\"result\":0,\"data\":{\"accountid\":\"2519901\",\"cards\":[{\"cardid\":24,\"card_data\":{\"index\":24,\"value\":6,\"shape\":1}},{\"cardid\":26,\"card_data\":{\"index\":26,\"value\":6,\"shape\":3}}]},\"callBackIndex\":0}\r\n                        //  this.playPushCardSound(data.cardvalue.name)\r\n                        //  this.destoryCard(data.account,this.choose_card_data)\r\n                        //  this.choose_card_data = []\r\n                     }\r\n                    \r\n                 }.bind(this))\r\n                 //this.playingUI_node.active = false\r\n                 break\r\n             case \"tipcard\":\r\n                 break            \r\n            default:\r\n                break\r\n        }\r\n    }\r\n\r\n\r\n});\r\n"]}