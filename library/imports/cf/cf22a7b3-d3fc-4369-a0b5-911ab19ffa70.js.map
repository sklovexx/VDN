{"version":3,"sources":["..\\..\\..\\..\\..\\..\\assets\\ddz\\scripts\\gameScene/assets\\ddz\\scripts\\gameScene\\gameScene.js"],"names":["cc","Class","extends","Component","properties","di_label","Label","beishu_label","roomid_label","player_node_prefabs","Prefab","players_seat_pos","Node","webview","bgAudio","default","type","AudioClip","gameEnd","onLoad","playerNodeList","string","myglobal","playerData","bottom","rate","roomstate","RoomState","ROOM_INVALID","node","on","console","log","i","length","emit","bind","socket","onRoomChangeState","data","roomState","gameui_node","getChildByName","gamebeforeUI","event","active","emitEventToPlayer","onQuitPlayer","removePlayerNode","request_enter_room","err","result","JSON","stringify","seatid","seatindex","playerdata_list_pos","setPlayerSeatPos","playerdata_list","playerdata","roomid","housemanageid","addPlayerNode","isopen_sound","audioEngine","stopAll","play","gamebefore_node","onPlayerJoinRoom","join_playerdata","onPlayerReady","onGameStart","onRobState","onChangeMaster","master_accountid","onShowBottomCard","onBeiShuUpdate","seat_index","player_data","forEach","e","accountid","destroy","splice","playernode_inst","instantiate","parent","push","index","position","children","getComponent","init_data","allPlayerData","start","getUserOutCardPosByAccount","node_script","seat_node","index_name","out_card_node","openWebView","closeWebView","quitRoom","request_quit_room","tipsLabel","setTimeout","director","loadScene","onDestroy","clearEvent"],"mappings":"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","file":"gameScene.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\ddz\\scripts\\gameScene","sourcesContent":["import myglobal from \"../mygolbal.js\"\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        di_label:cc.Label,\n        beishu_label:cc.Label,\n        roomid_label:cc.Label,\n        player_node_prefabs:cc.Prefab,\n        //绑定玩家座位,下面有3个子节点\n        players_seat_pos:cc.Node,\n        webview:cc.Node,\n        bgAudio:{\n            default:null,\n            type:cc.AudioClip\n        }\n    },\n    //本局结束，做状态清除\n    gameEnd(){\n\n    },\n    onLoad () {\n        this.playerNodeList = []\n        this.di_label.string = \"底:\" +  myglobal.playerData.bottom\n        this.beishu_label.string = \"倍数:\" + myglobal.playerData.rate\n        this.roomstate = RoomState.ROOM_INVALID\n        //监听，给其他玩家发牌(内部事件)\n        this.node.on(\"pushcard_other_event\",function(){\n            console.log(\"gamescene pushcard_other_event\")\n            for(var i=0;i<this.playerNodeList.length;i++){\n                    var node = this.playerNodeList[i]\n                    if(node){\n                    //给playernode节点发送事件\n                        node.emit(\"push_card_event\")\n                    }\n            }\n        }.bind(this))\n\n        //监听房间状态改变事件\n        myglobal.socket.onRoomChangeState(function(data){\n            //回调的函数参数是进入房间用户消息\n            console.log(\"onRoomChangeState:\"+data)\n            this.roomstate = data\n            myglobal.roomState = data\n            var gameui_node =  this.node.getChildByName('container').getChildByName(\"gameingUI\")\n            var gamebeforeUI = this.node.getChildByName('container').getChildByName(\"gamebeforeUI\")\n            if(gameui_node==null){\n               console.log(\"get childer name gameingUI\")\n               return\n            }\n            if(this.roomstate==7){\n                console.log('正在结算');\n                gameui_node.emit(\"game_settle_event\",event)\n            }\n            if(this.roomstate==1){\n                //准备阶段\n                gamebeforeUI.active = true\n                myglobal.playerData.rate = 1;\n                this.beishu_label.string = \"倍数:\" + 1\n                gameui_node.emit(\"room_waitready\")\n                gamebeforeUI.emit(\"room_waitready\")\n                this.emitEventToPlayer(\"room_waitready\")\n            }\n        }.bind(this))\n        //监听玩家退出房间事件\n        myglobal.socket.onQuitPlayer(function(data){\n            console.log(\"onQuitPlayer:\"+data)\n            this.removePlayerNode(data)\n        }.bind(this))\n        //\n        this.node.on(\"canrob_event\",function(event){\n            console.log(\"gamescene canrob_event:\"+event)\n            //通知给playernode子节点\n            for(var i=0;i<this.playerNodeList.length;i++){\n                var node = this.playerNodeList[i]\n                if(node){\n                    //给playernode节点发送事件\n                    node.emit(\"playernode_canrob_event\",event)\n                }\n            }\n        }.bind(this))\n\n        this.node.on(\"choose_card_event\",function(event){\n            console.log(\"--------choose_card_event-----------\")\n            var gameui_node =  this.node.getChildByName('container').getChildByName(\"gameingUI\")\n            if(gameui_node==null){\n               console.log(\"get childer name gameingUI\")\n               return\n            }\n            gameui_node.emit(\"choose_card_event\",event)\n           \n        }.bind(this))\n\n        this.node.on(\"unchoose_card_event\",function(event){\n            console.log(\"--------unchoose_card_event-----------\")\n            var gameui_node =  this.node.getChildByName('container').getChildByName(\"gameingUI\")\n            if(gameui_node==null){\n               console.log(\"get childer name gameingUI\")\n               return\n            }\n            gameui_node.emit(\"unchoose_card_event\",event)\n        }.bind(this))\n        //监听给玩家添加三张底牌\n        // this.node.on(\"add_three_card\",function(event){\n        //     console.log(\"add_three_card:\"+event)\n        //     for(var i=0;i<this.playerNodeList.length;i++){\n        //         var node = this.playerNodeList[i]\n        //         if(node){\n        //             //给playernode节点发送事件\n        //             node.emit(\"playernode_add_three_card\",event)\n        //         }\n        //     }\n        // }.bind(this))\n\n        myglobal.socket.request_enter_room({},function(err,result){\n            console.log(\"enter_room_resp\"+ JSON.stringify(result))\n            if(err!=0){\n               console.log(\"enter_room_resp err:\"+err)\n            }else{\n             \n              //enter_room成功\n              //notify ={\"seatid\":1,\"playerdata\":[{\"accountid\":\"2117836\",\"nick_name\":\"tiny543\",\"avatarUrl\":\"http://xxx\",\"goldcount\":1000}]}\n                var seatid = result.seatindex //自己在房间里的seatid\n                this.playerdata_list_pos = []  //3个用户创建一个空用户列表\n                this.setPlayerSeatPos(seatid)\n\n                var playerdata_list = result.playerdata\n                var roomid = result.roomid\n                this.roomid_label.string = \"房间号:\" + roomid\n                myglobal.playerData.housemanageid = result.housemanageid\n                for(var i=0;i<playerdata_list.length;i++){\n                    //consol.log(\"this----\"+this)\n                    this.addPlayerNode(playerdata_list[i])\n                }\n\n                if(isopen_sound){\n                    cc.audioEngine.stopAll()\n                    cc.audioEngine.play(this.bgAudio,true) \n                 }\n            }\n            var gamebefore_node = this.node.getChildByName('container').getChildByName(\"gamebeforeUI\")\n            gamebefore_node.emit(\"init\")\n        }.bind(this))\n\n        //在进入房间后，注册其他玩家进入房间的事件\n        myglobal.socket.onPlayerJoinRoom(function(join_playerdata){\n            //回调的函数参数是进入房间用户消息\n            console.log(\"onPlayerJoinRoom:\"+JSON.stringify(join_playerdata))\n            this.addPlayerNode(join_playerdata)\n        }.bind(this))\n        \n        //回调参数是发送准备消息的accountid\n        myglobal.socket.onPlayerReady(function(data){\n            console.log(\"-------onPlayerReady:\"+data)\n            for(var i=0;i<this.playerNodeList.length;i++){\n                var node = this.playerNodeList[i]\n                if(node){\n                    node.emit(\"player_ready_notify\",data)\n                }\n            }\n        }.bind(this))\n\n        myglobal.socket.onGameStart(function(){\n            for(var i=0;i<this.playerNodeList.length;i++){\n                var node = this.playerNodeList[i]\n                if(node){\n                    node.emit(\"gamestart_event\")\n                }\n            }\n\n            //隐藏gamebeforeUI节点\n            var gamebeforeUI = this.node.getChildByName('container').getChildByName(\"gamebeforeUI\")\n            if(gamebeforeUI){\n                gamebeforeUI.active = false\n            }\n        }.bind(this))\n\n        //监听服务器玩家抢地主消息\n        myglobal.socket.onRobState(function(event){\n                console.log(\"-----onRobState\"+JSON.stringify(event))\n                //onRobState{\"accountid\":\"2162866\",\"state\":1}\n                for(var i=0;i<this.playerNodeList.length;i++){\n                    var node = this.playerNodeList[i]\n                    if(node){\n                        //给playernode节点发送事件\n                        node.emit(\"playernode_rob_state_event\",event)\n                    }\n                }\n        }.bind(this))\n\n        //注册监听服务器确定地主消息\n        myglobal.socket.onChangeMaster(function(event){\n            console.log(\"onChangeMaster\"+event)\n            //保存一下地主id\n            myglobal.playerData.master_accountid = event\n            for(var i=0;i<this.playerNodeList.length;i++){\n                var node = this.playerNodeList[i]\n                if(node){\n                    //给playernode节点发送事件\n                    node.emit(\"playernode_changemaster_event\",event)\n                }\n            }\n        }.bind(this))\n        \n        //注册监听服务器显示底牌消息\n        myglobal.socket.onShowBottomCard(function(event){\n           console.log(\"onShowBottomCard---------\"+event)\n           var gameui_node =  this.node.getChildByName('container').getChildByName(\"gameingUI\")\n           if(gameui_node==null){\n              console.log(\"get childer name gameingUI\")\n              return\n           }\n           gameui_node.emit(\"show_bottom_card_event\",event)\n        }.bind(this))\n        //注册监听服务器倍数更新消息\n        myglobal.socket.onBeiShuUpdate(function(data){\n            console.log(\"onBeiShuUpdate----------\"+data);\n            console.log(myglobal.playerData.rate)\n            this.beishu_label.string = \"倍数:\" + data\n            myglobal.playerData.rate = data\n        }.bind(this))\n    },\n\n    //seat_index自己在房间的位置id\n    setPlayerSeatPos(seat_index){\n        if(seat_index < 1 || seat_index > 3){\n            console.log(\"seat_index error\"+seat_index)\n            return\n        }\n\n        console.log(\"setPlayerSeatPos seat_index:\" + seat_index)\n       \n        //界面位置转化成逻辑位置\n        switch(seat_index){\n            case 1:\n                   this.playerdata_list_pos[1] = 0\n                   this.playerdata_list_pos[2] = 1 \n                   this.playerdata_list_pos[3] = 2\n              break\n             case 2:\n                    this.playerdata_list_pos[2] = 0\n                    this.playerdata_list_pos[3] = 1\n                    this.playerdata_list_pos[1] = 2\n                    break\n             case 3:\n                    this.playerdata_list_pos[3] = 0     \n                    this.playerdata_list_pos[1] = 1\n                    this.playerdata_list_pos[2] = 2\n                    break\n            default: \n              break      \n        } \n\n    },\n    removePlayerNode(player_data){\n        this.playerNodeList.forEach((e,i)=>{\n            if(e.accountid==player_data.accountid){\n                e.destroy();\n                this.playerNodeList.splice(i,1)\n                console.log(e,i)\n            }\n        })\n        console.log(this.playerNodeList)\n    },\n    addPlayerNode(player_data){\n        var playernode_inst = cc.instantiate(this.player_node_prefabs)\n        playernode_inst.parent = this.node.getChildByName('container')\n        playernode_inst.accountid = player_data.accountid;\n        //创建的节点存储在gamescene的列表中\n        this.playerNodeList.push(playernode_inst)\n\n        //玩家在room里的位置索引(逻辑位置)\n        var index = this.playerdata_list_pos[player_data.seatindex]\n        console.log(\"index \"+player_data.seatindex+ \" \"+index)\n        playernode_inst.position = this.players_seat_pos.children[index].position\n        playernode_inst.getComponent(\"player_node\").init_data(player_data,index)\n        myglobal.allPlayerData.push(player_data)\n        console.log(this.node.getChildByName('container').children)\n    },\n    emitEventToPlayer(event,data){\n        for(var i=0;i<this.playerNodeList.length;i++){\n            var node = this.playerNodeList[i]\n            if(node){\n                //给playernode节点发送事件\n                node.emit(event,data)\n            }\n        }\n    },\n    start () {\n    },\n\n    /*\n     //通过accountid获取用户出牌放在gamescend的位置 \n     做法：先放3个节点在gameacene的场景中cardsoutzone(012)\n           \n    */\n    getUserOutCardPosByAccount(accountid){\n        console.log(\"getUserOutCardPosByAccount accountid:\"+accountid)\n        for(var i=0;i<this.playerNodeList.length;i++){\n            var node = this.playerNodeList[i]\n            if(node){\n                //获取节点绑定的组件\n                var node_script = node.getComponent(\"player_node\")\n                //如果accountid和player_node节点绑定的accountid相同\n                //接获取player_node的子节点\n                if(node_script.accountid===accountid){\n                  var seat_node = this.players_seat_pos.children[node_script.seat_index]\n                  var index_name = \"cardsoutzone\"+node_script.seat_index\n                  //console.log(\"getUserOutCardPosByAccount index_name:\"+index_name)\n                  var out_card_node = seat_node.getChildByName(index_name)\n                  //console.log(\"OutZone:\"+ out_card_node.name)\n                  return out_card_node\n                }\n            }\n        }\n\n        return null\n    },\n    openWebView(){\n        this.webview.active = true;\n    },\n    closeWebView(){\n        this.webview.active = false;\n    },\n    quitRoom(){\n        myglobal.socket.request_quit_room({},function(err,data){\n            if(err!=0){\n                console.log(\"requestStart err\"+err)\n                this.tipsLabel.string=data\n                setTimeout(function(){\n                    this.tipsLabel.string=\"\"\n                }.bind(this), 2000);\n            }else{\n                console.log(\"requestStart data\"+ JSON.stringify(data))\n                cc.director.loadScene(\"hallScene\")\n            }\n        }.bind(this))\n    },\n    onDestroy(){\n        myglobal.socket.clearEvent()\n    }\n    // update (dt) {},\n});\n"]}