{"version":3,"sources":["..\\..\\..\\..\\..\\..\\assets\\NiuNiu\\script\\config/assets\\NiuNiu\\script\\config\\GameCfg.js"],"names":["EnemyBaseData","require","GunData","EnemyGroupData","AchievementData","DailyRewardData","UtilsOther","GameCfg","cc","Class","properties","isLoadOver","enemyCfg","loadLocalCfg","finishCall","loadCounts","enemyInfo","name","onLoad","setData","enemyGroupInfo","gunBase","setBaseData","gunLevel","setLevelData","achieveInfo","dailyRewardInfo","fileArray","file","fileName","isObject","loader","loadRes","err","data","log","length","initData","initBaseData","initLevelData","bind","instance","getInstance","module","exports"],"mappings":"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","file":"GameCfg.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\NiuNiu\\script\\config","sourcesContent":["/**\r\n * Created by skyxu on 2018/4/26.\r\n */\r\n\r\n\"use strict\";\r\n\r\nlet EnemyBaseData = require(\"./EnemyBaseData\");\r\nlet GunData = require(\"./GunData\");\r\nlet EnemyGroupData = require(\"./EnemyGroupData\");\r\nlet AchievementData = require(\"./AchievementData\");\r\nlet DailyRewardData = require(\"./DailyRewardData\");\r\nlet UtilsOther = require(\"./../Common/UtilsOther\");\r\n\r\nlet GameCfg = cc.Class({\r\n    properties: {\r\n        isLoadOver: false,\r\n        // mark: 重要，变量名要保持和文件名一致\r\n        enemyCfg: null\r\n    },\r\n\r\n    /**\r\n     * 读取本地配置文件\r\n     * @param finishCall {Function} 完成回调\r\n     */\r\n    loadLocalCfg(finishCall){\r\n        this.loadCounts = 0;\r\n\r\n        let enemyInfo = {name: \"enemyCfg\", onLoad: EnemyBaseData.setData};\r\n        let enemyGroupInfo = {name: \"enemyGroupCfg\", onLoad: EnemyGroupData.setData};\r\n\r\n        let gunBase = {name: \"gunBaseCfg\", onLoad: GunData.setBaseData};\r\n        let gunLevel = {name: \"gunLevelCfg\", onLoad: GunData.setLevelData};\r\n        \r\n        let achieveInfo = {name: \"achievementCfg\", onLoad: AchievementData.setData};\r\n        let dailyRewardInfo = {name: \"dailyRewardCfg\", onLoad: DailyRewardData.setData};\r\n\r\n        let fileArray = [enemyInfo, enemyGroupInfo, gunBase, gunLevel, achieveInfo, dailyRewardInfo];\r\n        for (let file of fileArray){\r\n            let fileName = file;\r\n            if (UtilsOther.isObject(file)) {\r\n                fileName = file.name;\r\n            }\r\n\r\n            cc.loader.loadRes(\"config/\" + fileName, function (err, data) {\r\n                if (err) {\r\n                    cc.log(\"load local cfg \" + fileName + \" error: \" + err);\r\n                } else {\r\n                    cc.log(\"load local cfg \" + fileName + \" suc.\");\r\n                    this[fileName] = data;\r\n\r\n                    if (UtilsOther.isObject(file) && file.onLoad) {\r\n                        file.onLoad(data);\r\n                    }\r\n                }\r\n                this.loadCounts++;\r\n                this.isLoadOver = this.loadCounts >= fileArray.length;\r\n                if (this.isLoadOver) {\r\n                    EnemyBaseData.initData();\r\n                    EnemyGroupData.initData();\r\n                    GunData.initBaseData();\r\n                    GunData.initLevelData();\r\n                    AchievementData.initData();\r\n                    DailyRewardData.initData();\r\n                    \r\n                    if (finishCall) {\r\n                        finishCall();\r\n                    }\r\n                }\r\n            }.bind(this));\r\n        }\r\n    }\r\n});\r\nGameCfg.instance = null;\r\nGameCfg.getInstance = function () {\r\n    if (!GameCfg.instance) {\r\n        GameCfg.instance = new GameCfg();\r\n    }\r\n    return GameCfg.instance;\r\n};\r\n\r\nmodule.exports = GameCfg;"]}