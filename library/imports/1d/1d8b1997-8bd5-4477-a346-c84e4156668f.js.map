{"version":3,"sources":["..\\..\\..\\..\\..\\..\\assets\\Script\\Ui\\LuckyDrawPanel/assets\\Script\\Ui\\LuckyDrawPanel\\TurntableMgr.js"],"names":["cc","Class","extends","Component","properties","boolRandom","default","displayName","tooltip","intTotalPrize","type","Integer","intResultId","floatAccelerated","Float","floatDeceleration","floatMaxRangeSpeed","item_name","Label","item_Prizename","Panle","Node","Panle2","Panle3","Panle4","winning_name","winning_Prizename","winning_icon","Sprite","editBox_name","EditBox","editBox_weixin","editBox_phone","label_mendian","selectItem","Prefab","container_mendian","scroll_mendian","item_icon","onLoad","onEnable","initProperties","active","_range","_currentRotationSpeed","isLuckyDraw","_targetRotation","_turntableBg","node","getChildByName","angle","_interval","updatePrizeList","Global","ProtocolMgr","queryPrizeList","res","code","data","list","PrizeList","ModifyPrizeList","i","loader","load","url","good_img","err","spriteFrame","SpriteFrame","string","js","formatStr","level","good_name","length","PageMgr","showTipPage","message","arr","empty","len","index","push","UpsetArray","newArr","copyArray","randomNumber","Math","random","sort","JSON","parse","stringify","getPrizeListData","_id","id","onRandomPlace","onStart","queryLuckDraw","LuckDrawdata","yes_good_id","_currentState","undefined","schedule","updateRotation","onClickBreak","onStop","log","unschedule","onVirtualCompute","virtualRotationAngle","rotationSpeed","onGetValue","targetRotation","temp","detectionAngle","tempRotation","setTheWinning","tempRotationSpeed","is_win","yes_goode_img","yes_good_name","yes_goode_level","onClickToReceive","onClickMessagePanle","queryGetPickUpLocation","removeAllChildren","instantiate","getComponent","address","on","EventType","TOUCH_END","tid","addChild","submit","did","reqData","name","phone","wx_number","lid","toString","console","queryReceivePrizes","event","customData","parseInt","showScroll","onDestroy"],"mappings":"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","file":"TurntableMgr.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\Script\\Ui\\LuckyDrawPanel","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        boolRandom:{\r\n            default : false,\r\n            displayName : \"随机位置\",\r\n            tooltip : '确定结果区域后,是否在该区域内随机落下'\r\n        },\r\n\r\n        intTotalPrize:{\r\n            default : 6,\r\n            type : cc.Integer,\r\n            displayName : \"奖品/区域总数\",\r\n            tooltip : '游戏总奖品数'\r\n        },\r\n\r\n        intResultId:{\r\n            default : 1,\r\n            type : cc.Integer,\r\n            displayName : \"奖品/目标Id\",\r\n            tooltip : '中奖奖品'\r\n        },\r\n\r\n        floatAccelerated:{\r\n            default : 360 * 2,\r\n            type : cc.Float,\r\n            displayName : \"加速度\",\r\n            tooltip : '加速度值,每秒速度增加几度,°/s²'\r\n        },\r\n\r\n        floatDeceleration:{\r\n            default : -270,\r\n            type : cc.Float,\r\n            displayName : \"减速度\",\r\n            tooltip : '加速度值,每秒速度减少几度,°/s²'\r\n        },\r\n\r\n        floatMaxRangeSpeed:{\r\n            default : 360 * 3,\r\n            type : cc.Float,\r\n            displayName : \"最大速度\",\r\n            tooltip : '每秒速度减少几度,°/s'\r\n        },\r\n        item_name:[cc.Label],\r\n        item_Prizename:[cc.Label],\r\n        Panle:cc.Node,\r\n        Panle2:cc.Node,\r\n        Panle3:cc.Node,\r\n        Panle4:cc.Node,\r\n        winning_name:cc.Label,\r\n        winning_Prizename:cc.Label,\r\n        winning_icon:cc.Sprite,\r\n\r\n\r\n        editBox_name:cc.EditBox,\r\n        editBox_weixin:cc.EditBox,\r\n        editBox_phone:cc.EditBox,\r\n        label_mendian:cc.Label,\r\n\r\n        selectItem:cc.Prefab,\r\n        container_mendian:cc.Node,\r\n        scroll_mendian:cc.Node,\r\n\r\n\r\n        item_icon:[cc.Sprite]\r\n    },\r\n\r\n    onLoad() {\r\n        \r\n    },\r\n\r\n    onEnable(){\r\n        this.initProperties();\r\n    },\r\n\r\n    // 初始化属性\r\n    initProperties() {\r\n        this.Panle.active = false;\r\n        this.Panle2.active = false;\r\n        this.Panle3.active = false;\r\n        this.Panle4.active = false;\r\n        // 旋转角度范围\r\n        this._range = 360;\r\n        // 当前旋转速度\r\n        this._currentRotationSpeed = 0; \r\n        this.isLuckyDraw = true;\r\n        // 目标角度\r\n        this._targetRotation = 0;\r\n        // 目标节点\r\n        this._turntableBg = this.node.getChildByName(\"TurntableBg\");\r\n\r\n        this._turntableBg.angle = 0;\r\n        // 说明节点\r\n        // this._labExplain = this.node.getChildByName(\"LabExplain\").getComponent(cc.Label);\r\n        // this._labExplain.string = '初始化成功' \r\n\r\n        // 处理奖品Id\r\n        if(this.intResultId <= 0 || this.intTotalPrize < this.intResultId || this.intTotalPrize <= 0)\r\n        {\r\n            // this._labExplain.string = '区域总数或奖品Id不准确...'\r\n        }\r\n        // 时间间隔\r\n        this._interval = 0.02;   \r\n        this.updatePrizeList();\r\n    },\r\n\r\n    //获取抽奖列表\r\n    updatePrizeList()\r\n    {\r\n        Global.ProtocolMgr.queryPrizeList((res)=>{\r\n            if(res.code==200){\r\n                let data = res.data.list;\r\n                this.PrizeList = this.ModifyPrizeList(data);\r\n                for(let i = 0;i < this.PrizeList.length;i++){\r\n                    cc.loader.load({url:this.PrizeList[i].good_img,type:'png'},(err,res)=>{\r\n                        \r\n                        this.item_icon[i].spriteFrame = new cc.SpriteFrame(res);\r\n                    });\r\n                    this.item_name[i].string =  cc.js.formatStr(\"%s\",this.PrizeList[i].level);\r\n                    this.item_Prizename[i].string = this.PrizeList[i].good_name;\r\n                }\r\n            }else{\r\n                Global.PageMgr.showTipPage(res.message);\r\n            }\r\n        });\r\n    },\r\n    //修改数组\r\n    ModifyPrizeList(arr)\r\n    {\r\n        var empty = [];\r\n        var data;\r\n        var len = arr.length;\r\n        for (let index = 0; index < 8; index++) {\r\n            data = arr[index % len];\r\n            empty.push(data); \r\n        }\r\n        // empty = this.UpsetArray(empty);\r\n        return empty;\r\n    },\r\n    //打乱数组\r\n    UpsetArray(arr)\r\n    {\r\n        var newArr =this.copyArray(arr)\r\n        var randomNumber = function(){\r\n            return 0.5 - Math.random()\r\n        }\r\n        newArr.sort(randomNumber)\r\n        return newArr\r\n    },\r\n\r\n    //复制数组\r\n    copyArray(arr)\r\n    {\r\n        return JSON.parse( JSON.stringify( arr ) )\r\n    },\r\n\r\n    getPrizeListData(_id)\r\n    {\r\n        for (let index = 0; index < this.PrizeList.length; index++) {\r\n            if(this.PrizeList[index].id == _id )\r\n            {\r\n                return index + 1;\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * 随机函数\r\n     * 方法: 将目标区域分为多个小块,随机落到除两边外其他位置(防止指针指到边上指示不明确)\r\n     */\r\n    onRandomPlace() {\r\n        var random = (Math.random() - 0.5) * this._range / (this.intTotalPrize + 2);\r\n        return random;\r\n    },\r\n\r\n    // 开始\r\n    onStart()\r\n    {\r\n        if(!this.isLuckyDraw)\r\n        {\r\n            return ;\r\n        }\r\n        // Global.PageMgr.showTipPage(\"每周六下午5点,官方统一抽奖\",2); \r\n        // return;\r\n        Global.ProtocolMgr.queryLuckDraw((res)=>{\r\n            if(res.code==200){\r\n                let data = res.data;\r\n                this.LuckDrawdata = data;\r\n                this.intResultId = this.getPrizeListData(data.yes_good_id);\r\n                if(this._currentState == undefined || this._currentState == 0)\r\n                {\r\n                    this._currentState = 1; // 0:静止 1:加速 2减速\r\n                    // this._turntableBg.rotation = 0;\r\n                    this._turntableBg.angle = 0;\r\n                }else{\r\n                    // cc.log(\"转盘已经开始转动...\");\r\n                    this.isLuckyDraw = false;\r\n                }\r\n                this.schedule(this.updateRotation, this._interval);\r\n        \r\n            }else{\r\n                Global.PageMgr.showTipPage(res.message);\r\n            }\r\n        });\r\n\r\n    },\r\n    onClickBreak()\r\n    {\r\n        this.Panle.active = false;\r\n        this.isLuckyDraw = true;\r\n    },\r\n    // 暂停\r\n    onStop()\r\n    {\r\n        if(this._currentState == undefined || this._currentState == 0)\r\n        {\r\n            cc.log(\"转盘已经停止...\");\r\n        }else{\r\n            // 当前状态静止\r\n            cc.log(\"转盘已经停止2...\");\r\n            this.unschedule(this.updateRotation);\r\n        }\r\n    },\r\n\r\n    // 计算开始减速时机\r\n    onVirtualCompute()\r\n    {\r\n        // 虚拟转动角度\r\n        var virtualRotationAngle = 0;\r\n        // 虚拟角度速度\r\n        var rotationSpeed = this.floatMaxRangeSpeed;\r\n        while(rotationSpeed > 0){\r\n            virtualRotationAngle = virtualRotationAngle + rotationSpeed * this._interval;\r\n            rotationSpeed = rotationSpeed + this._interval * this.floatDeceleration;\r\n        }\r\n\r\n        return virtualRotationAngle;\r\n    },\r\n\r\n    // 获取开始减速的时机 角度\r\n    onGetValue(targetRotation)\r\n    {\r\n        var temp = targetRotation - this.onVirtualCompute();\r\n        if(temp > 0) {\r\n            while (temp >= 360) {\r\n                temp -= this._range;\r\n            }\r\n        } else {\r\n            while (temp < 0) {\r\n                temp += this._range;\r\n            }\r\n        }\r\n        return temp;\r\n    },\r\n\r\n    /**\r\n     * 转动检测\r\n     */\r\n    detectionAngle() {\r\n        // 目标旋转角度\r\n        var targetRotation = this._range / this.intTotalPrize * (this.intResultId - 1);\r\n        if(this.boolRandom) {\r\n            targetRotation += this.onRandomPlace();\r\n        }\r\n        var tempRotation = this.onGetValue(targetRotation);\r\n        // this._turntableBg.rotation = tempRotation;\r\n        this._turntableBg.angle = tempRotation;\r\n        this._currentState = 2;\r\n    },\r\n\r\n    /**\r\n     * 每一帧回调\r\n     * @param {*}  \r\n     */\r\n    updateRotation() {\r\n        switch (this._currentState) {\r\n            case 0:\r\n                break;\r\n            case 1:\r\n                {\r\n                    if(this._currentRotationSpeed >= this.floatMaxRangeSpeed)\r\n                    {\r\n                        this._currentRotationSpeed = this.floatMaxRangeSpeed;\r\n                        this.detectionAngle();\r\n                    }else\r\n                    {\r\n                        this._currentRotationSpeed += this.floatAccelerated * this._interval;\r\n                    }\r\n                }\r\n                break;\r\n            case 2:\r\n                {\r\n                    if(this._currentRotationSpeed <= 0)\r\n                    {\r\n                        this._currentRotationSpeed = 0; //当前速度设置为 0rad/s\r\n                        this._currentState = 0;         //当前状态设置为 0\r\n                        \r\n                        this.setTheWinning();\r\n                    }else{\r\n                        this._currentRotationSpeed += this.floatDeceleration * this._interval;\r\n                    }\r\n                }\r\n                break;\r\n            default:\r\n                {\r\n                    this._currentRotationSpeed = 0; //当前速度设置为 0rad/s\r\n                    this._currentState = 0;         //当前状态设置为 0\r\n                }\r\n                break;\r\n        }\r\n        var tempRotationSpeed = this._currentRotationSpeed * this._interval;\r\n        // this._labExplain.string = this._labExplain.string + \"\\n当前转盘转动速度: \" +  Math.round(this._currentRotationSpeed) + \"°/s\";\r\n        // this._turntableBg.rotation += tempRotationSpeed;\r\n        this._turntableBg.angle += tempRotationSpeed;\r\n    },\r\n\r\n    setTheWinning()\r\n    {\r\n        this.Panle.active = true;\r\n        if(this.LuckDrawdata.is_win == 0)\r\n        {\r\n            this.Panle3.active = true;\r\n        }else\r\n        {\r\n            this.Panle2.active = true;\r\n            cc.loader.load({url:this.LuckDrawdata.yes_goode_img,type:'png'},(err,res)=>{\r\n                        \r\n                this.winning_icon.spriteFrame = new cc.SpriteFrame(res);\r\n            });\r\n            this.winning_name.string =  cc.js.formatStr(\"%s\",this.LuckDrawdata.yes_good_name);\r\n            this.winning_Prizename.string = this.LuckDrawdata.yes_goode_level;\r\n        }\r\n    },\r\n    onClickToReceive()\r\n    {\r\n        this.onClickMessagePanle(null,1);\r\n        this.Panle.active = false;\r\n\r\n        Global.ProtocolMgr.queryGetPickUpLocation((res)=>{\r\n            if(res.code==200){\r\n                let data = res.data\r\n                this.container_mendian.removeAllChildren();\r\n                for(let i = 0;i<data.length;i++){\r\n                    let selectItem = cc.instantiate(this.selectItem);\r\n                    selectItem.getComponent(cc.Label).string = data[i].address;\r\n                    selectItem.on(cc.Node.EventType.TOUCH_END,()=>{\r\n                        this.label_mendian.string = data[i].address;\r\n                        this.tid = data[i].id;\r\n                        this.scroll_mendian.active = false;\r\n                    })\r\n                    this.container_mendian.addChild(selectItem);\r\n                }\r\n            }else{\r\n                Global.PageMgr.showTipPage(res.message);\r\n            }\r\n        })\r\n        this.editBox_name.string = \"\";\r\n        this.editBox_weixin.string = \"\";\r\n        this.editBox_phone.string = \"\";\r\n    },\r\n\r\n    submit(){\r\n        if(this.did==0){\r\n            Global.PageMgr.showTipPage(\"还未选择门店\");\r\n            return;\r\n        }\r\n        if(this.editBox_name.string==\"\"){\r\n            Global.PageMgr.showTipPage(\"还未填写姓名\");\r\n            return;\r\n        }\r\n        if(this.editBox_phone.string==\"\"){\r\n            Global.PageMgr.showTipPage(\"还未填写手机号\");\r\n            return;\r\n        }\r\n        if(this.editBox_weixin.string==\"\"){\r\n            Global.PageMgr.showTipPage(\"还未填写微信\");\r\n            return;\r\n        }\r\n        let reqData = {\r\n            name:this.editBox_name.string,\r\n            phone:this.editBox_phone.string,\r\n            wx_number:this.editBox_weixin.string,\r\n            lid:this.tid.toString(),\r\n        }\r\n        console.log(\"选择的游戏是：\"+this.tid.toString());\r\n        Global.ProtocolMgr.queryReceivePrizes(reqData,(res)=>{\r\n            if(res.code==200){\r\n                Global.PageMgr.showTipPage(\"提交成功\");\r\n                // Global.PageMgr.onClosePage(17);\r\n                this.onClickMessagePanle(null,0);\r\n            }else{\r\n                Global.PageMgr.showTipPage(res.message);\r\n            }\r\n        })\r\n    },\r\n\r\n    onClickMessagePanle(event,customData)\r\n    {\r\n        var index = parseInt(customData);\r\n        this.Panle4.active = index == 1 ? true:false;\r\n    },\r\n\r\n    showScroll(event,customData){\r\n        switch (customData) {\r\n            case \"mendian\":\r\n                this.scroll_mendian.active = true;\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n    },\r\n    /**\r\n     * 统一回收组件\r\n     */\r\n    onDestroy() {\r\n        this.node.onDestroy();\r\n    }\r\n});"]}