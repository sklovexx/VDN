{"version":3,"sources":["..\\..\\..\\..\\..\\..\\assets\\ddz\\scripts\\gameScene/assets\\ddz\\scripts\\gameScene\\gamebeforeUI.js"],"names":["cc","Class","extends","Component","properties","btn_ready","Node","btn_gamestart","tipsLabel","Label","btn_quit","onLoad","active","node","on","console","log","myglobal","playerData","housemanageid","accountID","bind","socket","onChangeHouseManage","data","JSON","stringify","gameScene_script","parent","getComponent","emitEventToPlayer","start","onButtonClick","event","customData","requestReady","requestStart","err","string","setTimeout"],"mappings":"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","file":"gamebeforeUI.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\ddz\\scripts\\gameScene","sourcesContent":["import myglobal from \"../mygolbal.js\"\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        btn_ready:cc.Node,\r\n        btn_gamestart:cc.Node,\r\n        tipsLabel:cc.Label,\r\n        btn_quit:cc.Node\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad () {\r\n\r\n        this.btn_gamestart.active = false\r\n        this.btn_ready.active = false\r\n\r\n        //监听本地的发送的消息\r\n        this.node.on(\"init\",function(){\r\n            console.log(\"game beforeui init\")\r\n            console.log(\"myglobal.playerData.housemanageid\"+myglobal.playerData.housemanageid)\r\n            console.log(\"myglobal.playerData.accountID\"+myglobal.playerData.accountID)\r\n            if(myglobal.playerData.housemanageid==myglobal.playerData.accountID){\r\n                //自己就是房主\r\n                this.btn_gamestart.active = true\r\n                this.btn_ready.active = false\r\n            }else{\r\n                this.btn_gamestart.active = false\r\n                this.btn_ready.active = true\r\n            }\r\n        }.bind(this))\r\n        //内部事件：准备阶段初始化\r\n        this.node.on(\"room_waitready\",function(){\r\n            if(myglobal.playerData.housemanageid==myglobal.playerData.accountID){\r\n                //自己就是房主\r\n                this.btn_gamestart.active = true\r\n                this.btn_ready.active = false\r\n                this.btn_quit.active = true\r\n            }else{\r\n                this.btn_gamestart.active = false\r\n                this.btn_ready.active = true\r\n                this.btn_quit.active = true\r\n            }\r\n        }.bind(this))\r\n        //监听服务器发送来的消息\r\n        // myglobal.socket.onGameStart(function(){\r\n        //     console.log(\"gamebrforeUI onGameStart revice\")\r\n        //     this.node.active = false\r\n        // }.bind(this))\r\n        this.node.on(\"ready\",function(){\r\n            this.btn_ready.active = false\r\n            this.btn_quit.active = false\r\n        }.bind(this))\r\n        myglobal.socket.onChangeHouseManage(function(data){\r\n            console.log(\"gamebrforeUI onChangeHouseManage revice\"+JSON.stringify(data))\r\n            myglobal.playerData.housemanageid = data\r\n            let gameScene_script = this.node.parent.parent.getComponent(\"gameScene\")\r\n            gameScene_script.emitEventToPlayer(\"onChangeHouseManage\")\r\n            if(myglobal.playerData.housemanageid==myglobal.playerData.accountID){\r\n                //自己就是房主\r\n                this.btn_gamestart.active = true\r\n                this.btn_ready.active = false\r\n                this.btn_quit.active = true\r\n            }else{\r\n                this.btn_gamestart.active = false\r\n                // this.btn_ready.active = true\r\n            }\r\n\r\n        }.bind(this))\r\n    },\r\n\r\n    start () {\r\n\r\n    },\r\n\r\n    // update (dt) {},\r\n    onButtonClick(event,customData){\r\n        switch(customData){\r\n            case \"btn_ready\":\r\n                console.log(\"btn_ready\")\r\n                myglobal.socket.requestReady()\r\n                this.btn_ready.active = false\r\n                this.btn_quit.active = false\r\n                break\r\n            case \"btn_start\":\r\n                // if(isopen_sound){\r\n                //    cc.audioEngine.play(cc.url.raw(\"resources/sound/start_a.ogg\")) \r\n                //  }\r\n                 console.log(\"btn_start\")\r\n                 myglobal.socket.requestStart(function(err,data){\r\n                    if(err!=0){\r\n                        console.log(\"requestStart err\"+err)\r\n                        this.tipsLabel.string=data\r\n                        setTimeout(function(){\r\n                            this.tipsLabel.string=\"\"\r\n                        }.bind(this), 2000);\r\n                    }else{\r\n                        console.log(\"requestStart data\"+ JSON.stringify(data))\r\n                        \r\n                    }\r\n                 }.bind(this))\r\n                 break    \r\n            default:\r\n                break\r\n        }\r\n    }\r\n});\r\n"]}