{"version":3,"sources":["..\\..\\..\\..\\..\\..\\assets\\Script\\Ui\\GivingCrystalPanel/assets\\Script\\Ui\\GivingCrystalPanel\\GivingCrystalPanel.js"],"names":["app","require","cc","Class","extends","Component","properties","editBox_ID","EditBox","editBox_SUM","gold","Label","jiesao","jine","panle","Node","shouxufei","onLoad","onEnable","reqData","Post","res","code","data","goleSum","parseFloat","totalUsdt","toFixed","string","js","formatStr","updataUI","onClickBreak","onClickGiving","myreg","test","Global","PageMgr","showTipPage","sum1","parseInt","shoufeiyong","active","onClickOK","transferType","transferAccount","number","ProtocolMgr","queryTransfer","onClosePage","pages","getComponent","goGamePanelUI","message"],"mappings":"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","file":"GivingCrystalPanel.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\Script\\Ui\\GivingCrystalPanel","sourcesContent":["let app = require('../../Util/appScript')\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        editBox_ID:cc.EditBox,\r\n        editBox_SUM:cc.EditBox,\r\n        gold:cc.Label,\r\n        jiesao:cc.Label,\r\n        jine:cc.Label,\r\n        panle:cc.Node,\r\n        shouxufei:cc.Node,\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad () {\r\n       \r\n    },\r\n    onEnable(){\r\n        let reqData = {};\r\n        app.Post('member/getMemberInfo',reqData,(res)=>{\r\n            if(res.code==200){\r\n                if(res.data){\r\n                    this.goleSum = parseFloat(res.data.totalUsdt).toFixed(4);\r\n                    this.gold.string = cc.js.formatStr(\"可用余额:%sPMV\",this.goleSum);\r\n                    this.updataUI();\r\n                }\r\n            }\r\n        });\r\n        \r\n    },\r\n\r\n    updataUI(){\r\n        this.editBox_ID.string = \"\";\r\n        this.editBox_SUM.string = \"\";\r\n        this.onClickBreak();\r\n    },\r\n\r\n    //赠送货币\r\n    onClickGiving(){\r\n        if(this.editBox_ID.string != \"\" && this.editBox_SUM.string != \"\")\r\n        {\r\n            var myreg = /^([a-zA-Z]|[0-9])(\\w|\\-)+@[a-zA-Z0-9]+\\.([a-zA-Z]{2,4})$/;\r\n            if(!myreg.test(this.editBox_ID.string))\r\n            {\r\n                Global.PageMgr.showTipPage(\"请输入正确的好友账号\"); \r\n            }else\r\n            {\r\n               var sum1 = parseInt(this.editBox_SUM.string) \r\n               this.shoufeiyong = sum1 * 0.01;\r\n               if(this.shoufeiyong < 0.1)\r\n               {\r\n                    this.shoufeiyong = 0.1; \r\n               }\r\n            //    var sum2 = sum1 + this.shoufeiyong;\r\n                if(sum1 > this.goleSum)\r\n                {\r\n                    Global.PageMgr.showTipPage(\"PMV不足\"); \r\n                }else\r\n                {\r\n                    this.jiesao.string = cc.js.formatStr(\"您将给好友(%s)赠送%sPMV,请仔细核对 好友账号与赠送数量是否有误？\",this.editBox_ID.string,this.editBox_SUM.string);\r\n                    this.jine.string = cc.js.formatStr(\"手续费:%sPMV\",this.shoufeiyong);\r\n                    this.panle.active = true;\r\n                }\r\n            }\r\n        }\r\n        else\r\n        {\r\n            if(this.editBox_ID.string ==\"\")\r\n            {\r\n                Global.PageMgr.showTipPage(\"好友账号不能为空\"); \r\n            }else if(this.editBox_SUM.string ==\"\")\r\n            {\r\n                Global.PageMgr.showTipPage(\"输入金额不能为空\"); \r\n            }\r\n        }\r\n    },\r\n\r\n    //赠送\r\n    onClickOK()\r\n    {\r\n        let reqData = {\r\n            transferType:0,\r\n            transferAccount:this.editBox_ID.string,\r\n            number:this.editBox_SUM.string,\r\n        }\r\n        Global.ProtocolMgr.queryTransfer(reqData,(res)=>{\r\n            if(res.code != 3001){\r\n                Global.PageMgr.showTipPage(\"赠送成功\");\r\n                this.updataUI();\r\n                Global.PageMgr.onClosePage(22);\r\n                Global.PageMgr.onClosePage(24);\r\n                Global.PageMgr.pages[11].getComponent(\"ChongWuPanel\").goGamePanelUI(); \r\n            }else{\r\n                Global.PageMgr.showTipPage(res.message);\r\n            }\r\n        })\r\n    },\r\n\r\n    //返回\r\n    onClickBreak()\r\n    {\r\n        this.panle.active = false;\r\n    },\r\n});\r\n"]}