{"version":3,"sources":["..\\..\\..\\..\\..\\..\\..\\assets\\NiuNiu\\script\\net\\socket/assets\\NiuNiu\\script\\net\\socket\\NetProxy.js"],"names":["GameNetwork","require","GameProtocols","playerData","getInstance","playerObj","GAME_SERVER_URL","NetProxy","cc","Class","ctor","network","_cachePushCallback","init","setDelegate","initPushCallback","connect","closeConnect","isNetworkOpened","isSocketOpened","isNetworkClosed","isSocketClosed","onNetworkOpen","GlobalNiuNiu","eventMgr","emit","config","EVENT_NETWORK_OPENED","onNetworkClose","EVENT_NETWORK_CLOSED","self","pushCallback","resp","registerPushResponseCallback","registerPush","key","cb","target","bind","act","offPush","offCallback","dealCachePush","beatHeart","callback","req","HeartRequest","t","Date","now","sendRequest","chat","msg","ChatRequest","uid","createRoom","CreateRoomRequest","enterRoom","rid","EnterRoomRequest","quitRoom","QuitRoomRequest","startGame","StartGameRequest","ready","ReadyRequest","console","log","ConfigRequest","kick","KickRequest","payBet","bet","BetRequest","GetQueryVariable","variable","query","window","location","search","substring","vars","split","i","length","pair","login","origin","token","LoginRequest","os","sys","osVersion","err","EVENT_LOGIN_FAILED","EVENT_LOGIN_SUC","logout","bindFacebook","getRank","rankType","response","pushFriendSendTakeSp","pushPlayChess","pushChat","pushExitRoom","EVENT_CHAT","EVENT_EXITROOM","EVENT_PLAYCHESS","debug_addCoins","name","DebugChangeMeRequest","cmd","module","exports"],"mappings":"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","file":"NetProxy.js","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\assets\\NiuNiu\\script\\net\\socket","sourcesContent":["/**\n * Created by skyxu on 2018/10/9.\n */\n\n\"use strict\";\n\nlet GameNetwork = require(\"./GameNetwork\");\nlet GameProtocols = require(\"./GameProtocols\");\nlet playerData = require(\"./../../Common/DataMgr\").getInstance().playerObj;\n\nlet GAME_SERVER_URL = 'ws://8.210.235.222:3005/ws';\n// GAME_SERVER_URL = 'wss://echo.websocket.org';\n// let GAME_SERVER_URL = \"ws://\"+Config.socketUrl+\":3005/ws\";\n\nlet NetProxy = cc.Class({\n    ctor: function () {\n        this.network = null;\n        this._cachePushCallback = [];\n    },\n\n    init: function () {\n        this.network = new GameNetwork();\n        this.network.setDelegate(this);\n        this.initPushCallback();\n    },\n    connect: function () {\n        this.network.connect(GAME_SERVER_URL);\n    },\n\n    closeConnect: function () {\n        this.network.closeConnect();\n    },\n\n    isNetworkOpened: function () {\n        return this.network.isSocketOpened();\n    },\n\n    isNetworkClosed: function () {\n        return this.network.isSocketClosed();\n    },\n\n    onNetworkOpen: function () {\n        GlobalNiuNiu.eventMgr.emit(GlobalNiuNiu.config.EVENT_NETWORK_OPENED);\n    },\n\n    onNetworkClose: function () {\n        GlobalNiuNiu.eventMgr.emit(GlobalNiuNiu.config.EVENT_NETWORK_CLOSED);\n    },\n\n    /**\n     * 注册push回调接口\n     */\n    initPushCallback: function () {\n        let self = this;\n        let pushCallback = function (resp) {\n            self.pushCallback(resp);\n        };\n\n        this.network.registerPushResponseCallback('chat', pushCallback);\n        this.network.registerPushResponseCallback('exitRoom', pushCallback);\n        this.network.registerPushResponseCallback('playChess', pushCallback);\n    },\n\n    /**\n     * 注册推送\n     * @param {String} key\n     * @param {function(resp)} cb\n     */\n    registerPush(key, cb, target){\n        let self = this;\n        if (cb && target){\n            cb = cb.bind(target);\n        }\n        let pushCallback = function (resp) {\n            if (cb){\n                cb(resp);\n            }\n            GlobalNiuNiu.eventMgr.emit(resp.act, resp);\n        };\n\n        this.network.registerPushResponseCallback(key, pushCallback);\n    },\n    offPush(key, cb){\n        this.network.offCallback(key,cb);\n    },\n    /**\n     * 处理缓存push\n     */\n    dealCachePush: function () {\n        // if(this._cachePushCallback.length > 0){\n        //     for(var i = 0; i < this._cachePushCallback.length; i++){\n        //         this.pushCallback(this._cachePushCallback[i]);\n        //     }\n        // }\n        // this._cachePushCallback = [];\n    },\n\n    beatHeart: function (callback) {\n        let req = new GameProtocols.HeartRequest();\n        req.t = Date.now();\n        this.network.sendRequest(req, callback);\n    },\n\n    chat: function (msg) {\n        let req = new GameProtocols.ChatRequest();\n        let uid = playerData.uid;\n        req.uid = uid;\n        req.msg = msg;\n        this.network.sendRequest(req);\n    },\n\n\n    createRoom: function (cb) {\n        let req = new GameProtocols.CreateRoomRequest();\n        req.uid = playerData.uid;\n        this.network.sendRequest(req, cb);\n    },\n\n    enterRoom: function (rid, cb) {\n        let req = new GameProtocols.EnterRoomRequest();\n        req.rid = rid;\n        req.uid = playerData.uid;\n        this.network.sendRequest(req, cb);\n    },\n    quitRoom: function (rid, cb) {\n        let req = new GameProtocols.QuitRoomRequest();\n        req.rid = rid;\n        req.uid = playerData.uid;\n        this.network.sendRequest(req, cb);\n    },\n    startGame: function () {\n        let req = new GameProtocols.StartGameRequest();\n        req.uid = playerData.uid;\n        this.network.sendRequest(req);\n    },\n    ready: function (callback){\n        let req = new GameProtocols.ReadyRequest();\n        req.uid = playerData.uid;\n        this.network.sendRequest(req,callback)\n    },\n    config: function (){\n        console.log(1)\n        let req = new GameProtocols.ConfigRequest();\n        this.network.sendRequest(req)\n    },\n    kick: function (){\n        let req = new GameProtocols.KickRequest();\n        req.uid = playerData.uid;\n        this.network.sendRequest(req)\n    },\n    payBet: function (bet) {\n        let req = new GameProtocols.BetRequest();\n        req.uid = playerData.uid;\n        req.bet = bet;\n        this.network.sendRequest(req);\n    },\n    GetQueryVariable:function(variable)\n    {\n        let query = window.location.search.substring(1);\n        let vars = query.split(\"&\");\n        for (let i=0;i<vars.length;i++) {\n            let pair = vars[i].split(\"=\");\n            if(pair[0] == variable){return pair[1];}\n        }\n        return(false);\n    },\n    /**\n     * Facebook或者游客登录接口\n     * @param {Object.<LoginOriginType>} origin\n     * @param token\n     */\n    login: function (origin, token) {\n        let req = new GameProtocols.LoginRequest();\n        if(token) req.token = token;\n        req.origin = origin;\n        req.os = cc.sys.os;\n        req.osVersion = cc.sys.osVersion;\n        playerData.uid = this.GetQueryVariable('token')\n        let uid = playerData.uid;\n        req.uid = uid;\n        // req.language = cc.sys.language;//farm.FarmPlatformHelper.jsToOc(farm.FarmPlatformHelper.JSB_EVENT_JTO_GetCurrentLanguage);\n        /*\n         req.deviceModel = '';\n         req.channelId = 0;\n         req.idfa = '';\n         req.androidId = '';\n         req.googleAid = '';\n         req.appVersion = '';\n         req.packName = '';\n         */\n        let callback =  function (resp) {\n            if(resp.err != 0){\n                GlobalNiuNiu.eventMgr.emit(GlobalNiuNiu.config.EVENT_LOGIN_FAILED, resp);\n                return;\n            }\n            // if(resp.token && resp.token.length > 0){\n            //     farm.localStorage.setItem(farm.game.gmConst.GLS_KEY_GUEST_TOKEN, resp.token);\n            // }\n            // farm.localStorage.removeItem(farm.game.gmConst.GLS_KEY_IS_LOGOUT);\n            //\n            // //\n            // farm.game.initConfig(resp);\n            // farm.game.initData(resp);\n            // farm.game.loginSuccess = true;\n\n            // js 调取其他平台的sdk，传过去玩家id\n            // farm.FarmPlatformHelper.jsToOc(farm.FarmPlatformHelper.JSB_EVENT_JTO_setSessionWithUid, farm.game.player.id.toString());\n            //\n\n            //登录\n            GlobalNiuNiu.eventMgr.emit(GlobalNiuNiu.config.EVENT_LOGIN_SUC, resp);\n        };\n        this.network.sendRequest(req, callback);\n    },\n\n    /**\n     * Facebook或者游客登出\n     */\n    logout: function () {\n        // let req = new GameProtocols.LogoutRequest();\n        // this.network.sendRequest(req, function (resp) {\n        //     if(resp.err != 0){\n        //         cc.log(\"网络请求---LogoutRequest 失败\");\n        //         farm.eventManager.emit(farm.game.gmConst.SP_EVENT_LOGOUT_FAILED);\n        //         return;\n        //     }\n        //     cc.log(\"网络请求---LogoutRequest 成功\");\n        //     GlobalNiuNiu.eventMgr.emit(farm.game.gmConst.SP_EVENT_LOGOUT_SUCCESS);\n        // });\n    },\n\n    /**\n     * 绑定fb账号\n     * @param {String} token\n     */\n    bindFacebook: function (token) {\n        // let req = new GameProtocols.BindFacebookRequest();\n        // req.token = token;\n        // let callback =  function (resp) {\n        //     //绑定过得逻辑\n        //     if(resp.err == farm.game.gmConst.ERROR_USER_HAS_REGISTERED){\n        //         cc.log(\"网络请求---BindFacebookRequest 已绑定\");\n        //         farm.eventManager.emit(farm.game.gmConst.SP_EVENT_HAS_BIND_FACEBOOK);\n        //         return;\n        //     }\n        //     //绑定失败\n        //     if(resp.err != 0){\n        //         cc.log(\"网络请求---BindFacebookRequest 失败\");\n        //         farm.eventManager.emit(farm.game.gmConst.SP_EVENT_BIND_FACEBOOK_FAILED);\n        //         return;\n        //     }\n        //     //绑定成功\n        //     cc.log(\"网络请求---BindFacebookRequest 成功\");\n        //     if(resp.me){\n        //         farm.game.player.parse(resp.me);\n        //     }\n        //     if(resp.friends){\n        //         farm.game.initFriends(resp.friends);\n        //     }\n        //     //绑定成功后删除本地token\n        //     farm.localStorage.removeItem(farm.game.gmConst.GLS_KEY_GUEST_TOKEN);\n        //     farm.eventManager.emit(farm.game.gmConst.SP_EVENT_BIND_FACEBOOK_SUCCESS);\n        // };\n        // this.network.sendRequest(req, callback);\n    },\n\n    /**\n     * 获取排名\n     * @param {Number} rankType 0全部，1本地，2好友\n     */\n    getRank: function (rankType) {\n        // let req = new GameProtocols.RankRequest();\n        // req.type = rankType;\n        // let callback =  function (resp) {\n        //     if(resp.err != 0){\n        //         cc.log(\"网络请求---getRank 失败\");\n        //         GlobalNiuNiu.eventMgr.emit(farm.game.gmConst.SP_EVENT_GET_RANK_FAILED, resp);\n        //         return;\n        //     }\n        //     cc.log(\"网络请求---getRank 成功\");\n        //     // todo 暂定排名类型\n        //     resp._rankType = rankType;\n        //     //farm.game.initLeaderBoardArray(rankType, resp.myRank, resp.men);\n        //     if(rankType == 2 && resp.men){\n        //         farm.game.updateFriends(resp.men);\n        //         resp.men = farm.game.sortFriendsByStar();\n        //     }\n        //     GlobalNiuNiu.eventMgr.emit(farm.game.gmConst.SP_EVENT_GET_RANK_SUCCESS, resp);\n        // };\n        // this.network.sendRequest(req, callback);\n    },\n\n\n    //push回调------------------------------------------------------------------------------\n\n    /**\n     * 推送回调\n     */\n    pushCallback: function (response) {\n        switch (response.act){\n            case \"friendInfoSync\":\n                this.pushFriendSendTakeSp(response);\n                break;\n            case \"playChess\":\n                this.pushPlayChess(response);\n                break;\n            case \"chat\":\n                this.pushChat(response);\n                break;\n            case \"exitRoom\":\n                this.pushExitRoom(response);\n                break;\n            default:\n                break;\n        }\n    },\n    /**\n     * 好友间互赠体力推送\n     * @param {PushSendSpResponse|PushTakeSpResponse} resp\n     */\n    pushFriendSendTakeSp: function (resp) {\n        // cc.log(\"网络请求---push--- pushFriendSendTakeSp 成功\");\n        // if(resp.friend) farm.game.updateFriends(resp.friend);\n        // farm.eventManager.emit(farm.game.gmConst.SP_PUSH_EVENT_UPDATE_FRIEND);\n    },\n\n\n    pushChat: function (resp) {\n        GlobalNiuNiu.eventMgr.emit(GlobalNiuNiu.config.EVENT_CHAT, resp);\n    },\n\n    pushExitRoom: function (resp) {\n        GlobalNiuNiu.eventMgr.emit(GlobalNiuNiu.config.EVENT_EXITROOM, resp);\n    },\n\n    pushPlayChess: function(resp){\n        GlobalNiuNiu.eventMgr.emit(GlobalNiuNiu.config.EVENT_PLAYCHESS, resp);\n    },\n\n    /**\n     * debug调试请求\n     * @param {String} name\n     */\n    debug_addCoins: function (name) {\n        var req = new GameProtocols.DebugChangeMeRequest();\n        if (name === \"btnAddCoins\") {\n            req.cmd = \"player coins add 100000000\";\n        } else if (name === \"btnClearCoins\") {\n            req.cmd = \"player coins 0\";\n        } else if (name === \"btnAddEnergy\") {\n            req.cmd = \"player sp add 10\";\n        } else if (name === \"btnClearEnergy\") {\n            req.cmd = \"player sp 0\";\n        } else if (name == \"btnAddWp\") {\n            req.cmd = \"player wp add 10\";\n        } else if (name == \"btnClearWp\") {\n            req.cmd = \"player wp 0\";\n        } else if (name == \"btnUnwrap\"){\n            req.cmd = \"player fbuid null\";\n        } else if (name == \"btnWizard1\"){\n            req.cmd = \"player wizard1 0\";\n        } else if (name == \"btnWizard2\"){\n            req.cmd = \"player wizard2 0\";\n        } else if (name == \"btnClearShield\"){\n            req.cmd = \"player shield 0\";\n        } else if (name == \"btnSpEc\"){\n            req.cmd = \"SpEc stepInterval 60000\";\n        } else if (name == \"btnFarmEc\"){\n            req.cmd = \"FarmEc stepInterval 60000\";\n        } else if (name == \"btnSpEcBack\"){\n            req.cmd = \"SpEc stepInterval 3600000\";\n        } else if (name == \"btnFarmBack\"){\n            req.cmd = \"FarmEc stepInterval 86400000\";\n        } else if (name == \"btnUpdateBuild\"){\n            req.cmd = \"Building lv 5\";\n        } else {\n            req.cmd = name;\n        }\n        // var callback = function (resp) {\n        //     if (resp.err != 0) {\n        //         return;\n        //     }\n        //     farm.game.player.parse(resp.me);\n        //     farm.game.spTimer.updateSpTime(resp.spStepLeftTime, resp.spInterval);\n        //     farm.game.dataUpdater.updateCoin();\n        //     farm.game.dataUpdater.updateSp();\n        //     farm.game.dataUpdater.updateShield();\n        //     farm.game.dataUpdater.updateStar();\n        //     //\n        //     if((req.cmd == \"FarmEc stepInterval 60000\" || req.cmd == \"FarmEc stepInterval 86400000\")\n        //         && farm.util.isNumber(resp.farmDailyOut)\n        //         && farm.util.isNumber(resp.farmCoins)){\n        //         farm.game.piggyBankTimer.init(resp.farmDailyOut, resp.farmCoins, resp.farmInterval);\n        //     }\n        //     if(req.cmd == \"SpEc stepInterval 60000\" || req.cmd == \"SpEc stepInterval 3600000\"){\n        //         farm.game.spTimer.updateSpTime(resp.spStepLeftTime, resp.spInterval);\n        //     }\n        //     if(resp.buildings){\n        //         for(var i = 0; i < resp.buildings.length; ++i){\n        //             farm.game.buildings[i].parse(resp.buildings[i]);\n        //         }\n        //         farm.eventManager.emit(farm.game.gmConst.SP_EVENT_UPGRADE_BUILDING_SUCCESS, resp);\n        //         farm.eventManager.emit(farm.game.gmConst.SP_DEBUG_EVENT_BUILD_TO_24_SUCCESS, resp);\n        //     }\n        // };\n        // this.network.sendRequest(req, callback);\n    },\n});\n\nmodule.exports = NetProxy;"]}