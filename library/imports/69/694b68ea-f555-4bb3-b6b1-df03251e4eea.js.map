{"version":3,"sources":["..\\..\\..\\..\\..\\..\\assets\\NiuNiu\\script\\common/assets\\NiuNiu\\script\\common\\ViewBase.js"],"names":["cc","Class","extends","Component","properties","onShowHandler","default","type","EventHandler","tooltip","onHideHandler","aniClipShow","AnimationClip","aniClipHide","mask","Node","immediatelyHandle","visible","_owner","showWithAni","animation","node","getComponent","Animation","addComponent","addClip","play","once","emit","bind","destroyWithAni","destroy","onDestroy","onViewDestroy","onBtnClose","GlobalNiuNiu","audioMgr","playEffect","effBtnClose"],"mappings":"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","file":"ViewBase.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\NiuNiu\\script\\common","sourcesContent":["/**\n * Created by skyxu on 2018/4/4.\n *\n * 所有的弹出框都要添加这个组件\n * 方便统一使用ViewManager进行管理\n * 如果子类重写了onDestroy则必须手动调用父类的onDestroy\n * 结构统一为:\n * node|\n *     |mask\n *     |root\n *          |sub node\n */\n\n\"use strict\";\n\ncc.Class({\n    extends: cc.Component,\n\n    properties:{\n        onShowHandler: {\n            default: null,\n            type: cc.Component.EventHandler,\n            tooltip: \"视图显示时的回掉\"\n        },\n        onHideHandler: {\n            default: null,\n            type: cc.Component.EventHandler,\n            tooltip: \"视图消失时的回掉\"\n        },\n\n        aniClipShow: {\n            default: null,\n            type: cc.AnimationClip,\n            tooltip: \"出现动画\"\n        },\n\n        aniClipHide: {\n            default: null,\n            type: cc.AnimationClip,\n            tooltip: \"消失动画\"\n        },\n\n        mask: {\n            default: null,\n            type: cc.Node,\n            tooltip: \"半透明遮罩\"\n        },\n\n        immediatelyHandle: {\n            default: false,\n            visible: false\n        },\n\n        _owner: null,   // viewMgr maybe null\n    },\n\n    showWithAni(){\n        if (!this.aniClipShow && !this.aniClipHide){\n            return;\n        }\n        let animation = this.node.getComponent(cc.Animation);\n        if (!animation){\n            animation = this.node.addComponent(cc.Animation);\n        }\n        if (this.aniClipHide){\n            animation.addClip(this.aniClipHide, \"aniHide\");\n        }\n        if (this.aniClipShow){\n            animation.addClip(this.aniClipShow, \"aniShow\");\n            animation.play(\"aniShow\").once(\"finished\", function () {\n                if (!this.immediatelyHandle && this.onShowHandler){\n                    this.onShowHandler.emit();\n                }\n            }.bind(this));\n            if (this.immediatelyHandle && this.onShowHandler){\n                this.onShowHandler.emit();\n            }\n        } else {\n            if (this.onShowHandler){\n                this.onShowHandler.emit();\n            }\n        }\n    },\n\n    /**\n     * called by ViewMgr\n     */\n    destroyWithAni(){\n        let animation = this.node.getComponent(cc.Animation);\n        if (this.aniClipHide){\n            animation.play(\"aniHide\").once(\"finished\", function () {\n                if (!this.immediatelyHandle && this.onHideHandler){\n                    this.onHideHandler.emit();\n                }\n                this.node.destroy();\n            }.bind(this));\n\n            if (this.immediatelyHandle && this.onHideHandler){\n                this.onHideHandler.emit();\n            }\n        } else {\n            if (this.onHideHandler){\n                this.onHideHandler.emit();\n            }\n            this.node.destroy();\n        }\n    },\n\n    onDestroy(){\n        if (this._owner){\n            this._owner.onViewDestroy();\n        }\n    },\n\n    onBtnClose(){\n        this.destroyWithAni();\n        GlobalNiuNiu.audioMgr.playEffect(GlobalNiuNiu.audioMgr.effBtnClose);\n    }\n});"]}