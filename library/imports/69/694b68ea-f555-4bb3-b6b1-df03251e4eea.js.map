{"version":3,"sources":["..\\..\\..\\..\\..\\..\\assets\\NiuNiu\\script\\common/assets\\NiuNiu\\script\\common\\ViewBase.js"],"names":["cc","Class","extends","Component","properties","onShowHandler","default","type","EventHandler","tooltip","onHideHandler","aniClipShow","AnimationClip","aniClipHide","mask","Node","immediatelyHandle","visible","_owner","showWithAni","animation","node","getComponent","Animation","addComponent","addClip","play","once","emit","bind","destroyWithAni","destroy","onDestroy","onViewDestroy","onBtnClose","GlobalNiuNiu","audioMgr","playEffect","effBtnClose"],"mappings":"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","file":"ViewBase.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\NiuNiu\\script\\common","sourcesContent":["/**\r\n * Created by skyxu on 2018/4/4.\r\n *\r\n * 所有的弹出框都要添加这个组件\r\n * 方便统一使用ViewManager进行管理\r\n * 如果子类重写了onDestroy则必须手动调用父类的onDestroy\r\n * 结构统一为:\r\n * node|\r\n *     |mask\r\n *     |root\r\n *          |sub node\r\n */\r\n\r\n\"use strict\";\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties:{\r\n        onShowHandler: {\r\n            default: null,\r\n            type: cc.Component.EventHandler,\r\n            tooltip: \"视图显示时的回掉\"\r\n        },\r\n        onHideHandler: {\r\n            default: null,\r\n            type: cc.Component.EventHandler,\r\n            tooltip: \"视图消失时的回掉\"\r\n        },\r\n\r\n        aniClipShow: {\r\n            default: null,\r\n            type: cc.AnimationClip,\r\n            tooltip: \"出现动画\"\r\n        },\r\n\r\n        aniClipHide: {\r\n            default: null,\r\n            type: cc.AnimationClip,\r\n            tooltip: \"消失动画\"\r\n        },\r\n\r\n        mask: {\r\n            default: null,\r\n            type: cc.Node,\r\n            tooltip: \"半透明遮罩\"\r\n        },\r\n\r\n        immediatelyHandle: {\r\n            default: false,\r\n            visible: false\r\n        },\r\n\r\n        _owner: null,   // viewMgr maybe null\r\n    },\r\n\r\n    showWithAni(){\r\n        if (!this.aniClipShow && !this.aniClipHide){\r\n            return;\r\n        }\r\n        let animation = this.node.getComponent(cc.Animation);\r\n        if (!animation){\r\n            animation = this.node.addComponent(cc.Animation);\r\n        }\r\n        if (this.aniClipHide){\r\n            animation.addClip(this.aniClipHide, \"aniHide\");\r\n        }\r\n        if (this.aniClipShow){\r\n            animation.addClip(this.aniClipShow, \"aniShow\");\r\n            animation.play(\"aniShow\").once(\"finished\", function () {\r\n                if (!this.immediatelyHandle && this.onShowHandler){\r\n                    this.onShowHandler.emit();\r\n                }\r\n            }.bind(this));\r\n            if (this.immediatelyHandle && this.onShowHandler){\r\n                this.onShowHandler.emit();\r\n            }\r\n        } else {\r\n            if (this.onShowHandler){\r\n                this.onShowHandler.emit();\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * called by ViewMgr\r\n     */\r\n    destroyWithAni(){\r\n        let animation = this.node.getComponent(cc.Animation);\r\n        if (this.aniClipHide){\r\n            animation.play(\"aniHide\").once(\"finished\", function () {\r\n                if (!this.immediatelyHandle && this.onHideHandler){\r\n                    this.onHideHandler.emit();\r\n                }\r\n                this.node.destroy();\r\n            }.bind(this));\r\n\r\n            if (this.immediatelyHandle && this.onHideHandler){\r\n                this.onHideHandler.emit();\r\n            }\r\n        } else {\r\n            if (this.onHideHandler){\r\n                this.onHideHandler.emit();\r\n            }\r\n            this.node.destroy();\r\n        }\r\n    },\r\n\r\n    onDestroy(){\r\n        if (this._owner){\r\n            this._owner.onViewDestroy();\r\n        }\r\n    },\r\n\r\n    onBtnClose(){\r\n        this.destroyWithAni();\r\n        GlobalNiuNiu.audioMgr.playEffect(GlobalNiuNiu.audioMgr.effBtnClose);\r\n    }\r\n});"]}