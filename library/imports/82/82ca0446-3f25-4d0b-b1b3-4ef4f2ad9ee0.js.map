{"version":3,"sources":["..\\..\\..\\..\\..\\..\\assets\\NiuNiu\\script\\common/assets\\NiuNiu\\script\\common\\AudioMgr.js"],"names":["DataMgr","require","Utils","cc","Class","extends","Component","properties","effNiu_0","url","AudioClip","default","effNiu_1","effNiu_2","effNiu_3","effNiu_4","effNiu_5","effNiu_6","effNiu_7","effNiu_8","effNiu_9","effNiu_10","effNiu_11","effNiu_12","effNiu_13","effNiu_14","roomMusic","gameMusic","effFlyCoins","effFapai","effMdls","effKaipai","effBtnClose","onLoad","_bgMusicID","_lastBGM","_setData","getInstance","settingObj","_allEffects","GlobalNiuNiu","audioMgr","playEffect","efx","loop","effectOn","undefined","audioId","audioEngine","play","effectVol","push","setFinishCallback","onEffectPlayFinished","bind","stopEffect","stop","arrayRmObj","stopAllEffects","pauseAllEffects","pause","resumeAllEffects","resume","setEffectVolume","vol","setVolume","a","b","log","length","playMusic","m","musicOn","musicVol","getLastMusic","playLastMusic","stopMusic","pauseMusic","resumeMusic","setMusicVolume"],"mappings":"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","file":"AudioMgr.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\NiuNiu\\script\\common","sourcesContent":["/**\r\n * Created by skyxu on 2018/4/17.\r\n *\r\n * 用来管理音频的播放\r\n * 挂置在一个常驻节点上\r\n */\r\n\r\n\"use strict\";\r\n\r\nlet DataMgr = require(\"./DataMgr\");\r\nlet Utils = require(\"./UtilsOther\");\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        effNiu_0: {\r\n            url: cc.AudioClip,\r\n            default: null\r\n        },\r\n        effNiu_1: {\r\n            url: cc.AudioClip,\r\n            default: null\r\n        },\r\n        effNiu_2: {\r\n            url: cc.AudioClip,\r\n            default: null\r\n        },\r\n        effNiu_3: {\r\n            url: cc.AudioClip,\r\n            default: null\r\n        },\r\n        effNiu_4: {\r\n            url: cc.AudioClip,\r\n            default: null\r\n        },\r\n        effNiu_5: {\r\n            url: cc.AudioClip,\r\n            default: null\r\n        },\r\n        effNiu_6: {\r\n            url: cc.AudioClip,\r\n            default: null\r\n        },\r\n        effNiu_7: {\r\n            url: cc.AudioClip,\r\n            default: null\r\n        },\r\n        effNiu_8: {\r\n            url: cc.AudioClip,\r\n            default: null\r\n        },\r\n        effNiu_9: {\r\n            url: cc.AudioClip,\r\n            default: null\r\n        },\r\n        effNiu_10: {\r\n            url: cc.AudioClip,  // 牛牛\r\n            default: null\r\n        },\r\n        effNiu_11: {\r\n            url: cc.AudioClip,  // 银牛\r\n            default: null\r\n        },\r\n        effNiu_12: {\r\n            url: cc.AudioClip,  // 四炸\r\n            default: null\r\n        },\r\n        effNiu_13: {\r\n            url: cc.AudioClip,  // 五花牛\r\n            default: null\r\n        },\r\n        effNiu_14: {\r\n            url: cc.AudioClip,  // 五小牛\r\n            default: null\r\n        },\r\n\r\n\r\n        roomMusic: {\r\n            url: cc.AudioClip,\r\n            default: null,\r\n        },\r\n        gameMusic: {\r\n            url: cc.AudioClip,\r\n            default: null\r\n        },\r\n        effFlyCoins: {\r\n            url: cc.AudioClip,\r\n            default: null\r\n        },\r\n        effFapai: {\r\n            url: cc.AudioClip,\r\n            default: null\r\n        },\r\n        effMdls: {\r\n            url: cc.AudioClip,\r\n            default: null\r\n        },\r\n        effKaipai: {\r\n            url: cc.AudioClip,\r\n            default: null\r\n        },\r\n        effBtnClose: {\r\n            url: cc.AudioClip,\r\n            default: null\r\n        }\r\n    },\r\n\r\n    onLoad: function () {\r\n        this._bgMusicID = null;\r\n        this._lastBGM = null;\r\n        this._setData = DataMgr.getInstance().settingObj;\r\n        this._allEffects = [];\r\n\r\n        GlobalNiuNiu.audioMgr = this;\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param efx {cc.AudioClip}\r\n     * @param loop {Boolean} 循环\r\n     */\r\n    playEffect: function (efx, loop) {\r\n        if (!this._setData.effectOn) return null;\r\n        loop = loop !== undefined?loop:false;\r\n        let audioId = cc.audioEngine.play(efx, loop, this._setData.effectVol);\r\n        this._allEffects.push(audioId);\r\n        cc.audioEngine.setFinishCallback(audioId, this.onEffectPlayFinished.bind(this, audioId));\r\n        return audioId;\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param audioId\r\n     */\r\n    stopEffect: function (audioId) {\r\n        if (audioId !== undefined && audioId !== null) {\r\n            cc.audioEngine.stop(audioId);\r\n            Utils.arrayRmObj(this._allEffects, audioId);\r\n        }\r\n    },\r\n\r\n    stopAllEffects: function () {\r\n        for (let audioId of this._allEffects) {\r\n            cc.audioEngine.stop(audioId);\r\n        }\r\n    },\r\n\r\n    pauseAllEffects: function () {\r\n        for (let audioId of this._allEffects) {\r\n            cc.audioEngine.pause(audioId);\r\n        }\r\n    },\r\n\r\n    resumeAllEffects: function () {\r\n        for (let audioId of this._allEffects) {\r\n            cc.audioEngine.resume(audioId);\r\n        }\r\n    },\r\n\r\n    setEffectVolume: function (vol) {\r\n        for (let audioId of this._allEffects) {\r\n            cc.audioEngine.setVolume(audioId, vol);\r\n        }\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param a {AudioID}\r\n     * @param b\r\n     */\r\n    onEffectPlayFinished(a, b){\r\n        Utils.arrayRmObj(this._allEffects, a);\r\n        cc.log(\"_allEffects:\" + this._allEffects.length);\r\n    },\r\n\r\n    /**\r\n     *\r\n     * @param m {cc.AudioClip}\r\n     */\r\n    playMusic: function (m) {\r\n        // mark: 必须优先保存，后面用来恢复播放\r\n        this._lastBGM = m;\r\n\r\n        if (!this._setData.musicOn) return;\r\n\r\n        //todo 先暂停再播放\r\n        if (this._bgMusicID !== null) {\r\n            cc.audioEngine.stop(this._bgMusicID);\r\n        }\r\n        this._bgMusicID = cc.audioEngine.play(m, true, this._setData.musicVol);\r\n    },\r\n\r\n    getLastMusic: function () {\r\n        return this._lastBGM;\r\n    },\r\n\r\n    playLastMusic: function () {\r\n        if (!this._setData.musicOn) return;\r\n\r\n        if (this._lastBGM) {\r\n            //todo 先暂停再播放\r\n            if (this._bgMusicID !== null) {\r\n                cc.audioEngine.stop(this._bgMusicID);\r\n            }\r\n            this._bgMusicID = cc.audioEngine.play(this._lastBGM, true, this._setData.musicVol);\r\n        }\r\n    },\r\n\r\n    stopMusic: function () {\r\n        if (this._bgMusicID === null) {\r\n            return;\r\n        }\r\n        cc.audioEngine.stop(this._bgMusicID);\r\n    },\r\n\r\n    pauseMusic: function () {\r\n        if (this._bgMusicID === null) {\r\n            return;\r\n        }\r\n        cc.audioEngine.pause(this._bgMusicID);\r\n    },\r\n\r\n    resumeMusic: function () {\r\n        if (this._bgMusicID === null) {\r\n            return;\r\n        }\r\n        cc.audioEngine.resume(this._bgMusicID);\r\n    },\r\n\r\n    setMusicVolume(vol){\r\n        if (this._bgMusicID === null) {\r\n            return;\r\n        }\r\n        cc.audioEngine.setVolume(this._bgMusicID, vol);\r\n    }\r\n});\r\n"]}