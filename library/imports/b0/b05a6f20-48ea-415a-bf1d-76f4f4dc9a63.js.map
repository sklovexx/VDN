{"version":3,"sources":["..\\..\\..\\..\\..\\..\\assets\\ddz\\scripts\\loginscene/assets\\ddz\\scripts\\loginscene\\loginScene.js"],"names":["cc","Class","extends","Component","properties","wait_node","Node","tipsLabel","Label","loginBg","default","type","AudioClip","onLoad","audioEngine","play","director","GlobalEvent","on","myglobal","socket","login","token","GetQueryVariable","err","result","console","log","string","setTimeout","bind","JSON","stringify","playerData","gobal_count","goldCount","accountID","avatarUrl","nickName","loadScene","initSocket","start","onButtonCilck","event","customData","variable","query","window","location","search","substring","vars","split","i","length","pair"],"mappings":";;;;;;AAAA;;;;;;AACAA,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACTC,mBAAUL,GAAGM,IADJ;AAETC,mBAAUP,GAAGQ,KAFJ,EAEW;AACpBC,iBAAQ;AACPC,qBAAQ,IADD;AAEPC,kBAAKX,GAAGY;AAFD;AAHC,KAHP;;AAYL;;AAEAC,UAdK,oBAcK;AAAA;;AACN;AACA,YAAG,IAAH,EAAQ;AACJb,eAAGc,WAAH,CAAeC,IAAf,CAAoB,KAAKN,OAAzB,EAAiC,IAAjC;AACH;AACDT,WAAGgB,QAAH,CAAYC,WAAZ,CAAwBC,EAAxB,CAA2B,WAA3B,EAAuC,YAAI;AACvCC,+BAASC,MAAT,CAAgBC,KAAhB,CAAsB;AAClBC,uBAAM,MAAKC,gBAAL,CAAsB,OAAtB;AADY,aAAtB,EAEE,UAASC,GAAT,EAAaC,MAAb,EAAoB;AAClB;AACA;AACA;AACA,oBAAGD,OAAK,CAAR,EAAU;AACPE,4BAAQC,GAAR,CAAY,SAAOH,GAAnB;AACA,yBAAKjB,SAAL,CAAeqB,MAAf,GAAsBH,MAAtB;AACAI,+BAAW,YAAU;AACjB,6BAAKtB,SAAL,CAAeqB,MAAf,GAAsB,EAAtB;AACH,qBAFU,CAETE,IAFS,CAEJ,IAFI,CAAX,EAEc,IAFd;AAGA;AACF;;AAEDJ,wBAAQC,GAAR,CAAY,iBAAiBI,KAAKC,SAAL,CAAeP,MAAf,CAA7B;AACAC,wBAAQC,GAAR,CAAYF,MAAZ;AACAN,mCAASc,UAAT,CAAoBC,WAApB,GAAkCT,OAAOU,SAAzC;AACAhB,mCAASc,UAAT,CAAoBG,SAApB,GAAgCX,OAAOW,SAAvC;AACAjB,mCAASc,UAAT,CAAoBI,SAApB,GAAgCZ,OAAOY,SAAvC;AACAlB,mCAASc,UAAT,CAAoBK,QAApB,GAA+Bb,OAAOa,QAAtC;AACAtC,mBAAGgB,QAAH,CAAYuB,SAAZ,CAAsB,WAAtB;AACH,aApBC,CAoBAT,IApBA,OAFF;AAuBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACH,SA1CD,EA0CE,IA1CF;AA2CAX,2BAASC,MAAT,CAAgBoB,UAAhB;AACH,KA/DI;AAiELC,SAjEK,mBAiEI,CAER,CAnEI;AAqELC,iBArEK,yBAqESC,KArET,EAqEeC,UArEf,EAqE0B;AAC3B,gBAAOA,UAAP;AACI,iBAAK,UAAL;AACIlB,wBAAQC,GAAR,CAAY,kBAAZ;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACJ;AACI;AA3BR;AA6BH,KAnGI;;AAoGLJ,sBAAiB,0BAASsB,QAAT,EACjB;AACI,YAAIC,QAAQC,OAAOC,QAAP,CAAgBC,MAAhB,CAAuBC,SAAvB,CAAiC,CAAjC,CAAZ;AACA,YAAIC,OAAOL,MAAMM,KAAN,CAAY,GAAZ,CAAX;AACA,aAAK,IAAIC,IAAE,CAAX,EAAaA,IAAEF,KAAKG,MAApB,EAA2BD,GAA3B,EAAgC;AAC5B,gBAAIE,OAAOJ,KAAKE,CAAL,EAAQD,KAAR,CAAc,GAAd,CAAX;AACA,gBAAGG,KAAK,CAAL,KAAWV,QAAd,EAAuB;AAAC,uBAAOU,KAAK,CAAL,CAAP;AAAgB;AAC3C;AACD,eAAO,KAAP;AACH;AACD;;;AA9GK,CAAT","file":"loginScene.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\ddz\\scripts\\loginscene","sourcesContent":["import myglobal from \"../mygolbal.js\"\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n       wait_node:cc.Node,\n       tipsLabel:cc.Label, //tips\n       loginBg:{\n        default:null,\n        type:cc.AudioClip\n    }\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad () {\n        //console.log(\"qian_state.qian:\"+ qian_state.qian)\n        if(true){\n            cc.audioEngine.play(this.loginBg,true) \n        }\n        cc.director.GlobalEvent.on('connected',()=>{\n            myglobal.socket.login({\n                token:this.GetQueryVariable('token')\n            },function(err,result){\n                //请求返回\n                //先隐藏等待UI\n                //this.wait_node.active = false\n                if(err!=0){\n                   console.log(\"err:\"+err)\n                   this.tipsLabel.string=result\n                   setTimeout(function(){\n                       this.tipsLabel.string=\"\"\n                   }.bind(this), 2000);\n                   return     \n                }\n \n                console.log(\"login sucess\" + JSON.stringify(result))\n                console.log(result)\n                myglobal.playerData.gobal_count = result.goldCount\n                myglobal.playerData.accountID = result.accountID\n                myglobal.playerData.avatarUrl = result.avatarUrl\n                myglobal.playerData.nickName = result.nickName\n                cc.director.loadScene(\"hallScene\")\n            }.bind(this))\n            // myglobal.socket.request_wxLogin({\n            //     uniqueID:myglobal.playerData.uniqueID,\n            //     accountID:myglobal.playerData.accountID,\n            //     nickName:myglobal.playerData.nickName,\n            //     avatarUrl:myglobal.playerData.avatarUrl,\n            // },function(err,result){\n            //     //请求返回\n            //     //先隐藏等待UI\n            //     //this.wait_node.active = false\n            //     if(err!=0){\n            //        console.log(\"err:\"+err)\n            //        return     \n            //     }\n\n            //     console.log(\"login sucess\" + JSON.stringify(result))\n            //     myglobal.playerData.gobal_count = result.goldcount\n            //     cc.director.loadScene(\"hallScene\")\n            // }.bind(this))\n        },this)\n        myglobal.socket.initSocket()\n    },\n    \n    start () {\n        \n    },\n    \n    onButtonCilck(event,customData){\n        switch(customData){\n            case \"wx_login\":\n                console.log(\"wx_login request\")\n                \n                //this.wait_node.active = true\n                \n                // myglobal.socket.login({\n                //     token:this.GetQueryVariable('token')\n                // },function(err,result){\n                //     //请求返回\n                //     //先隐藏等待UI\n                //     //this.wait_node.active = false\n                //     if(err!=0){\n                //        console.log(\"err:\"+err)\n                //        this.tipsLabel.string=result.data\n                //        setTimeout(function(){\n                //            this.tipsLabel.string=\"\"\n                //        }.bind(this), 2000);\n                //        return     \n                //     }\n\n                //     console.log(\"login sucess\" + JSON.stringify(result))\n                //     myglobal.playerData.gobal_count = result.goldcount\n                //     cc.director.loadScene(\"hallScene\")\n                // }.bind(this))\n                break\n            default:\n                break\n        }\n    },\n    GetQueryVariable:function(variable)\n    {\n        let query = window.location.search.substring(1);\n        let vars = query.split(\"&\");\n        for (let i=0;i<vars.length;i++) {\n            let pair = vars[i].split(\"=\");\n            if(pair[0] == variable){return pair[1];}\n        }\n        return(false);\n    },\n    // update (dt) {},\n\n\n});\n"]}