{"version":3,"sources":["..\\..\\..\\..\\..\\..\\assets\\NiuNiu\\script\\common/assets\\NiuNiu\\script\\common\\SliderExt.js"],"names":["Direction","cc","Enum","Horizontal","Vertical","Class","extends","Slider","properties","barSprite","default","type","Sprite","notify","CC_EDITOR","_updateBarSprite","enableAutoGrayEffect","tooltip","CC_DEV","oldValue","_updateDisabledState","interactable","_handleSliderLogic","touch","_updateProgress","_emitSlideEvent","handle","_sgNode","setState","_updateHandlePosition","handlelocalPos","direction","p","node","width","anchorX","progress","height","anchorY","worldSpacePos","convertToWorldSpaceAR","position","parent","convertToNodeSpaceAR","maxRange","newPos","convertTouchToNodeSpaceAR","clamp01","x","y","maxWidth","curWidth"],"mappings":"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","file":"SliderExt.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\NiuNiu\\script\\common","sourcesContent":["/**\n * Created by skyxu on 2018/4/16.\n */\n\n\"use strict\";\n\nlet Direction = cc.Enum({\n    /**\n     * !#en The horizontal direction.\n     * !#zh 水平方向\n     * @property {Number} Horizontal\n     */\n    Horizontal: 0,\n    /**\n     * !#en The vertical direction.\n     * !#zh 垂直方向\n     * @property {Number} Vertical\n     */\n    Vertical: 1\n});\n\ncc.Class({\n    extends: cc.Slider,\n\n    properties: {\n        barSprite: {\n            default: null,\n            type: cc.Sprite,\n            notify: function() {\n                if (CC_EDITOR && this.barSprite) {\n                    this._updateBarSprite();\n                }\n            }\n        },\n\n        enableAutoGrayEffect: {\n            default: false,\n            tooltip: CC_DEV && 'i18n:COMPONENT.button.auto_gray_effect',\n            notify: function (oldValue) {\n                this._updateDisabledState();\n            }\n        },\n\n        interactable: {  \n            default: true,\n            tooltip: CC_DEV && 'i18n:COMPONENT.button.interactable',\n            notify: function (oldValue) {\n                this._updateDisabledState();\n            }\n        }\n    },\n\n    _handleSliderLogic: function (touch) {\n        if (!this.interactable){\n            return;\n        }\n\n        this._updateProgress(touch);\n        this._emitSlideEvent();\n    },\n\n    _updateDisabledState(){\n        if (this.handle){\n            this.handle.enableAutoGrayEffect = this.enableAutoGrayEffect;\n            this.handle.interactable = this.interactable;\n        }\n\n        if(this.barSprite) {\n            this.barSprite._sgNode.setState(0);\n        }\n        if(this.enableAutoGrayEffect) {\n            if(this.barSprite && !this.interactable) {\n                this.barSprite._sgNode.setState(1);\n            }\n        }\n    },\n\n    _updateHandlePosition: function () {\n        if (!this.handle) {\n            return;\n        }\n        let handlelocalPos;\n        if (this.direction === Direction.Horizontal) {\n            handlelocalPos = cc.p(-this.node.width * this.node.anchorX + this.progress * this.node.width, 0);\n        }\n        else {\n            handlelocalPos = cc.p(0, -this.node.height * this.node.anchorY + this.progress * this.node.height);\n        }\n        let worldSpacePos = this.node.convertToWorldSpaceAR(handlelocalPos);\n        this.handle.node.position = this.handle.node.parent.convertToNodeSpaceAR(worldSpacePos);\n        this._updateBarSprite();\n    },\n\n    _updateProgress: function (touch) {\n        if (!this.handle) {\n            return;\n        }\n        let maxRange = null, progress = 0, newPos = this.node.convertTouchToNodeSpaceAR(touch);\n        if (this.direction === Direction.Horizontal) {\n            maxRange = this.node.width / 2 - this.handle.node.width * this.handle.node.anchorX;\n            progress = cc.clamp01((newPos.x + maxRange) / (maxRange * 2), 0, 1);\n        }\n        else if (this.direction === Direction.Vertical) {\n            maxRange = this.node.height / 2 - this.handle.node.height * this.handle.node.anchorY;\n            progress = cc.clamp01((newPos.y + maxRange) / (maxRange * 2), 0, 1);\n        }\n        this.progress = progress;\n\n        this._updateBarSprite();\n    },\n\n    _updateBarSprite(){\n        if (!this.barSprite) {\n            return;\n        }\n        let maxWidth = this.node.width;\n        let curWidth = maxWidth * this.progress;\n        this.barSprite.node.width = curWidth;\n        // mark: 左对齐\n        this.barSprite.node.x = this.barSprite.node.anchorX * this.barSprite.node.width - this.node.width * this.node.anchorX;\n    }\n});"]}