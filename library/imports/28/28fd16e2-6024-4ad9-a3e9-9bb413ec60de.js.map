{"version":3,"sources":["..\\..\\..\\..\\..\\..\\assets\\NiuNiu\\script\\common/assets\\NiuNiu\\script\\common\\CoinsMgr.js"],"names":["DataMgr","require","ViewMgr","CoinsMgr","cc","Class","ctor","costCoins","coins","sucCall","failedCall","toShop","playerObj","getInstance","undefined","call","showShopView","GlobalNiuNiu","uiUpdater","updateUserCoins","addCoins","updateUi","achieveObj","accCoins","module","exports"],"mappings":";;;;AAAA;;;;AAIA;;AAEA,IAAIA,UAAUC,QAAQ,WAAR,CAAd;AACA,IAAIC,UAAUD,QAAQ,WAAR,CAAd;;AAEA,IAAIE,WAAWC,GAAGC,KAAH,CAAS;AACpBC,QADoB,kBACd,CACL;AAFmB,CAAT,CAAf;;AAKA;;;;;;;AAOAH,SAASI,SAAT,GAAqB,UAAUC,KAAV,EAAiBC,OAAjB,EAA0BC,UAA1B,EAAsCC,MAAtC,EAA8C;AAC/D,QAAIC,YAAYZ,QAAQa,WAAR,GAAsBD,SAAtC;AACAD,aAASA,WAASG,SAAT,GAAmB,IAAnB,GAAwBH,MAAjC;AACA,QAAIH,QAAQI,UAAUJ,KAAtB,EAA6B;AACzB,YAAIO,OAAO,IAAX;AACA,YAAIJ,MAAJ,EAAW;AACPI,mBAAO,gBAAI;AACPb,wBAAQW,WAAR,GAAsBG,YAAtB;AACH,aAFD;AAGH,SAJD,MAIO;AACHD,mBAAOL,UAAP;AAEH;AACD;AACA;AACAK;AAEH,KAdD,MAcO;AACHH,kBAAUJ,KAAV,IAAmBA,KAAnB;AACAS,qBAAaC,SAAb,CAAuBC,eAAvB;AACA,YAAIV,OAAJ,EAAa;AACTA;AACH;AACJ;AACJ,CAxBD;;AA0BA;;;;;AAKAN,SAASiB,QAAT,GAAoB,UAAUZ,KAAV,EAAiBa,QAAjB,EAA2B;AAC3C,QAAIT,YAAYZ,QAAQa,WAAR,GAAsBD,SAAtC;AACA,QAAIU,aAAatB,QAAQa,WAAR,GAAsBS,UAAvC;;AAEAV,cAAUJ,KAAV,IAAmBA,KAAnB;AACAc,eAAWC,QAAX,IAAuBf,KAAvB;;AAEA,QAAIa,aAAaP,SAAb,IAA0BO,aAAa,IAA3C,EAAgD;AAC5CA,mBAAW,IAAX;AACH;AACD,QAAIA,QAAJ,EAAa;AACTJ,qBAAaC,SAAb,CAAuBC,eAAvB;AACH;AACJ,CAbD;;AAeAK,OAAOC,OAAP,GAAiBtB,QAAjB","file":"CoinsMgr.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\NiuNiu\\script\\common","sourcesContent":["/**\r\n * Created by skyxu on 2018/5/3.\r\n */\r\n\r\n\"use strict\";\r\n\r\nlet DataMgr = require(\"./DataMgr\");\r\nlet ViewMgr = require(\"./ViewMgr\");\r\n\r\nlet CoinsMgr = cc.Class({\r\n    ctor(){\r\n    }\r\n});\r\n\r\n/**\r\n *\r\n * @param coins{Number}\r\n * @param sucCall{Function}\r\n * @param failedCall{Function}\r\n * @param toShop{Boolean} 金币不足是否进入商店(默认进入)\r\n */\r\nCoinsMgr.costCoins = function (coins, sucCall, failedCall, toShop) {\r\n    let playerObj = DataMgr.getInstance().playerObj;\r\n    toShop = toShop===undefined?true:toShop;\r\n    if (coins > playerObj.coins) {\r\n        let call = null;\r\n        if (toShop){\r\n            call = ()=>{\r\n                ViewMgr.getInstance().showShopView();\r\n            }\r\n        } else {\r\n            call = failedCall;\r\n\r\n        }\r\n        // mark: 统一弹框提示\r\n        // AlertView.showGreen(\"Alert\", \"You are out of coins. Visit the shop for more.\", \"OK\", call);\r\n        call();\r\n\r\n    } else {\r\n        playerObj.coins -= coins;\r\n        GlobalNiuNiu.uiUpdater.updateUserCoins();\r\n        if (sucCall) {\r\n            sucCall();\r\n        }\r\n    }\r\n};\r\n\r\n/**\r\n *\r\n * @param coins{Number}\r\n * @param updateUi{Boolean} 默认true, 是否刷新ui\r\n */\r\nCoinsMgr.addCoins = function (coins, updateUi) {\r\n    let playerObj = DataMgr.getInstance().playerObj;\r\n    let achieveObj = DataMgr.getInstance().achieveObj;\r\n\r\n    playerObj.coins += coins;\r\n    achieveObj.accCoins += coins;\r\n\r\n    if (updateUi === undefined || updateUi === null){\r\n        updateUi = true;\r\n    }\r\n    if (updateUi){\r\n        GlobalNiuNiu.uiUpdater.updateUserCoins();\r\n    }\r\n};\r\n\r\nmodule.exports = CoinsMgr;"]}