{"version":3,"sources":["..\\..\\..\\..\\..\\..\\assets\\NiuNiu\\script\\common/assets\\NiuNiu\\script\\common\\UtilsOther.js"],"names":["Md5","require","CSVParser","UtilsOther","arrayRmObj","arr","obj","index","indexOf","splice","arrayPopByIdx","array","idx","item","valueInArray","value","len","length","i","arrayRandomValue","num","randomInteger","shuffle","j","temp","Math","floor","random","clearArrayValue","createObjectWithArray","object","arrayToDict","key","dict","data","dictToArray","hasOwnProperty","push","objectToArrayExcludeNumber","opt_arr","opt_exclude","tempArr","isArray","isNumber","toString","splitWithValueType","str","valueType","separator","undefined","split","forEach","currentValue","e","time","parseInt","Date","now","time2second","year","month","day","hour","minute","second","date","n","getTime","getTimeAfterDays","days","cc","assert","getDaysDiff","dateStart","dateEnd","iDays","strDateS","getFullYear","getMonth","getDate","strDateE","abs","getTimeForDay","dateStr","formatTime","s","t","min","sec","slice","getThousandSeparatorString","number","reverse","join","replace","getKMBString","getLastCutOffDay","current","cutOff","_dumpObject","prefix","o","depth","extraBlank","_ignore_function_member","max_depth","D","printWithDepth","txt","blanks","log","getFuncDescriptor","f","type","Object","prototype","call","neb","npfx","prop","i1","i2","dumpObject","DNN","isFunction","isString","Array","isUndefined","isObject","isEmpty","isPrototypeOf","keys","isBoolean","clone","newObj","constructor","copy","getStringFromFile","fileName","sys","isNative","jsb","fileUtils","_loadTxtSync","url","_isNodeJs","xhr","getXMLHttpRequest","timeout","open","test","navigator","userAgent","setRequestHeader","overrideMimeType","send","readyState","status","responseText","fs","readFileSync","bind","loader","loadRemoteImg","callback","isBrowser","load","progress","error","tex","dirpath","getWritablePath","filepath","md5_hex","loadEnd","err","isFileExist","saveFile","b","Uint8Array","isDirectoryExist","createDirectory","writeDataToFile","XMLHttpRequest","onreadystatechange","responseType","response","checkTouchIsHit","touchPoint","node","rectContainsPoint","getBoundingBoxToWorld","createCliper","spriteName","stencil","Sprite","clippingNode","ClippingNode","attr","anchorX","anchorY","alphaThreshold","convertBoundingBoxToWorld","rect","leftBottom","convertToWorldSpace","p","rightTop","pFromSize","getContentSize","x","y","getPositionByAnchor","anchorPoint","bounding","getBoundingBox","width","height","runShakeAction","range","times","runAction","repeat","sequence","moveBy","randomByWeight","keyForWeight","sumWeight","reduce","sumSoFar","tempWeight","randomValue","max","round","parse","options","parser","all","hasNext","ar","nextRow","parseOneLine","bindColumns","rows","colnames","isParseNumber","shift","map","row","isNaN","Number","bindColumnsSimple","CSV","parseOneSimple","module","exports"],"mappings":"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","file":"UtilsOther.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\NiuNiu\\script\\common","sourcesContent":["/**\r\n * Created by skyxu on 2018/3/13.\r\n */\r\n\r\n\"use strict\";\r\n\r\nlet Md5 = require(\"./../encrypt/Md5\");\r\nlet CSVParser = require(\"./CSVParser\");\r\n\r\nlet UtilsOther = UtilsOther || {};\r\n\r\n/**\r\n * 移除数组的指定的元素（重复元素只移除第一个）\r\n * @param {Array} arr\r\n * @param {Object} obj\r\n */\r\nUtilsOther.arrayRmObj = function (arr, obj) {\r\n    let index = arr.indexOf(obj);\r\n    arr.splice(index,1);\r\n};\r\n\r\n/**\r\n * pop a item from a array by idx\r\n * @param {Array} array\r\n * @param {Number} idx\r\n * @return {*}\r\n */\r\nUtilsOther.arrayPopByIdx = function (array, idx) {\r\n    let item = array[idx];\r\n    array.splice(idx, 1);\r\n\r\n    return item;\r\n};\r\n\r\nUtilsOther.valueInArray = function (arr, value) {\r\n    let len = arr.length;\r\n    for (let i = 0; i < len; i++) {\r\n        if (arr[i] == value) {\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n};\r\n\r\nUtilsOther.arrayRandomValue = function (arr) {\r\n    let num = arr.length;\r\n    if (num <= 0) {\r\n        return null;\r\n    }\r\n\r\n    let idx = UtilsOther.randomInteger(0, num - 1);\r\n    return arr[idx];\r\n};\r\n\r\nUtilsOther.shuffle = function (arr) {\r\n    let i,\r\n        j,\r\n        temp;\r\n    for (i = arr.length - 1; i > 0; i--) {\r\n        j = Math.floor(Math.random() * (i + 1));\r\n        temp = arr[i];\r\n        arr[i] = arr[j];\r\n        arr[j] = temp;\r\n    }\r\n    return arr;\r\n};\r\n\r\nUtilsOther.clearArrayValue = function (array, length, value) {\r\n    for (let i = 0; i < length; i++) {\r\n        array[i] = value;\r\n    }\r\n};\r\n\r\n/**\r\n * create a object with keys from array and initial value\r\n * @param {Array} array\r\n * @param {*} value\r\n * @returns {Object}\r\n */\r\nUtilsOther.createObjectWithArray = function (array, value) {\r\n    let object = {};\r\n    for (let i in array) {\r\n        object[array[i]] = value;\r\n    }\r\n\r\n    return object;\r\n};\r\n\r\nUtilsOther.arrayToDict = function (array, key) {\r\n    let dict = {};\r\n    let data = null;\r\n    for (let i in array) {\r\n        data = array[i];\r\n        dict[data[key]] = data;\r\n    }\r\n    return dict;\r\n};\r\n\r\nUtilsOther.dictToArray = function (dict) {\r\n    let array = [];\r\n    for (let key in dict) {\r\n        if (dict.hasOwnProperty(key) && dict[key]) {\r\n            array.push(dict[key]);\r\n        }\r\n    }\r\n    return array;\r\n};\r\n\r\n/**\r\n * 字典转数组\r\n * @param {Object} obj\r\n * @param {Array=} opt_arr\r\n * @param {Number=} opt_exclude\r\n * @return {Array}\r\n */\r\nUtilsOther.objectToArrayExcludeNumber = function (obj, opt_arr, opt_exclude) {\r\n    let tempArr;\r\n    if (isArray(opt_arr)) {\r\n        tempArr = opt_arr;\r\n    } else {\r\n        tempArr = [];\r\n    }\r\n    let key;\r\n    if (isNumber(opt_exclude)) {\r\n        let temp = opt_exclude.toString();\r\n        for (key in obj) {\r\n            if (obj.hasOwnProperty(key) && obj[key] && temp != key) {\r\n                tempArr.push(obj[key]);\r\n            }\r\n        }\r\n    } else {\r\n        for (key in obj) {\r\n            if (obj.hasOwnProperty(key) && obj[key]) {\r\n                tempArr.push(obj[key]);\r\n            }\r\n        }\r\n    }\r\n\r\n    return tempArr;\r\n};\r\n\r\n/**\r\n * 根据数据元素的类型来分割字符串，返回数据元素数组\r\n * @param {String} str\r\n * @param {*} valueType\r\n * @param {String} separator\r\n * @returns {Array}\r\n */\r\nUtilsOther.splitWithValueType = function (str, valueType, separator) {\r\n    if (separator === undefined) {\r\n        separator = \",\";\r\n    }\r\n\r\n    let arr = str.split(separator);\r\n    arr.forEach(function (currentValue, index, array) {\r\n        try {\r\n            array[index] = valueType (currentValue);\r\n        } catch (e) {\r\n            array[index] = null;\r\n        }\r\n    });\r\n\r\n    return arr;\r\n};\r\n\r\n/**\r\n * UTC 1970开始的秒数，与时区无关\r\n * @returns {number}\r\n */\r\nUtilsOther.time = function () {\r\n    return parseInt(Date.now() / 1000.0);\r\n};\r\n\r\n// 年月日 返回 1970开始的秒数\r\n/**\r\n *\r\n * @param year {int}\r\n * @param month {int} 1-12表示1-12月\r\n * @param day{int} 1-31\r\n * @param hour{int} 0-23\r\n * @param minute{int} 0-59\r\n * @param second{int} 0-59\r\n */\r\nUtilsOther.time2second = function (year, month, day, hour, minute, second) {\r\n    let date = new Date(year, month - 1, day, hour, minute, second);\r\n    let n = date.getTime();\r\n    return parseInt(n / 1000.0);\r\n};\r\n\r\n/**\r\n * 获取某个日期之后多少天的日期\r\n * @param time {Date || String || Number} 标准时间格式 或者 秒数(since 1970)\r\n * @param days {Number} 20\r\n * @return {Date}\r\n */\r\nUtilsOther.getTimeAfterDays = function (time, days) {\r\n    cc.assert(time, \"getTimeForDayAfterDays:time is null!\");\r\n    var date = null;\r\n    if (cc.isNumber(time)) {\r\n        date = new Date(time * 1000);\r\n    } else {\r\n        date = new Date(time);\r\n    }\r\n    return new Date(date.getTime() + days * 24 * 60 * 60 * 1000);\r\n};\r\n\r\n/**\r\n * 判断两个日期相差多少天\r\n * @param strDateStart  开始时间 标准时间格式 或者 秒数（since 1970)\r\n * @param strDateEnd    结束时间 标准时间格式 或者 秒数（since 1970)\r\n * @return {Number|*}   天数\r\n */\r\nUtilsOther.getDaysDiff = function (dateStart, dateEnd) {\r\n    cc.assert(dateStart && dateEnd, \"getDaysDiff: date must be not null!\");\r\n    var iDays;\r\n    if (UtilsOther.isNumber(dateStart)) {\r\n        dateStart = new Date(dateStart * 1000);\r\n    } else {\r\n        dateStart = new Date(dateStart);\r\n    }\r\n    if (UtilsOther.isNumber(dateEnd)) {\r\n        dateEnd = new Date(dateEnd * 1000);\r\n    } else {\r\n        dateEnd = new Date(dateEnd);\r\n    }\r\n\r\n    var strDateS = new Date(dateStart.getFullYear(), dateStart.getMonth(), dateStart.getDate());\r\n    var strDateE = new Date(dateEnd.getFullYear(), dateEnd.getMonth(), dateEnd.getDate());\r\n    iDays = parseInt(Math.abs(strDateE - strDateS) / 1000 / 60 / 60 / 24);   //把相差的毫秒数转换为天数\r\n    iDays *= (strDateE >= strDateS ? 1 : -1);\r\n    // cc.log(\"day dif:\" + iDays);\r\n    return iDays;\r\n};\r\n\r\n/**\r\n *\r\n * @param date{Date || String || Number} 标准时间格式 或者 秒数(since 1970)\r\n * @return {string} 格式 \"2017-08-02\"\r\n */\r\nUtilsOther.getTimeForDay = function (date) {\r\n    if (!date) {\r\n        date = new Date();\r\n    } else if (cc.isNumber(date)) {\r\n        date = new Date(date * 1000);\r\n    } else {\r\n        date = new Date(date);\r\n    }\r\n    var year = date.getFullYear();\r\n    var month = date.getMonth() + 1 < 10 ? \"0\" + (date.getMonth() + 1)\r\n        : date.getMonth() + 1;\r\n    var day = date.getDate() < 10 ? \"0\" + date.getDate() : date\r\n        .getDate();\r\n    var dateStr = year + \"-\" + month + \"-\" + day;\r\n    return dateStr;\r\n};\r\n\r\n\r\n/**\r\n *\r\n * @param s {Number} 秒\r\n * @return {string}\r\n */\r\nUtilsOther.formatTime = function (s) {\r\n    let t;\r\n    if (s >= 0) {\r\n        let hour = Math.floor(s / 3600);\r\n        let min = Math.floor(s / 60) % 60;\r\n        let sec = s % 60;\r\n        let day = parseInt(hour / 24);\r\n        if (day == 1) {\r\n            return day + \" day\";\r\n        }\r\n        if (day > 1) {\r\n            return day + \" days\";\r\n        }\r\n\r\n        if (day > 0) {\r\n            hour = hour - 24 * day;\r\n            t = day + \"day \" + ('00' + hour).slice(-2) + \":\";\r\n        }\r\n        else if (hour > 0) {\r\n            t = ('00' + hour).slice(-2) + \":\";\r\n        } else {\r\n            t = \"\";\r\n        }\r\n        \r\n        if (min < 10) {\r\n            t += \"0\";\r\n        }\r\n        t += min + \":\";\r\n        if (sec < 10) {\r\n            t += \"0\";\r\n        }\r\n        t += parseInt(sec);\r\n    }\r\n    return t;\r\n};\r\n\r\n/**\r\n * 返回100，000类型字符串\r\n * @param {Number} number\r\n * @returns {String}\r\n */\r\nUtilsOther.getThousandSeparatorString = function (number) {\r\n\r\n    return number.toString().split('').reverse().join('').replace(/(\\d{3}(?=\\d)(?!\\d+\\.|$))/g, '$1,').split('').reverse().join('');\r\n};\r\n\r\nUtilsOther.getKMBString = function (number) {\r\n    if (!this.isNumber(number)) {\r\n        return number;\r\n    }\r\n\r\n    if (number / 1000000000 >= 1) {\r\n        return this.getThousandSeparatorString(number / 1000000000) + \"B\";\r\n    }\r\n    else if (number / 1000000 >= 1) {\r\n        return this.getThousandSeparatorString(number / 1000000) + \"M\";\r\n    }\r\n    // 至少显示10k\r\n    else if (number / 10000 >= 1) {\r\n        return this.getThousandSeparatorString(number / 1000) + \"K\";\r\n    }\r\n    return this.getThousandSeparatorString(number);\r\n};\r\n\r\n/**\r\n * 返回截止日期\r\n * @param {Number} current\r\n * @param {Number} cutOff\r\n * @return {Number}\r\n */\r\nUtilsOther.getLastCutOffDay = function (current, cutOff) {\r\n    let time = cutOff - current;\r\n    if (time < 0) return -1;\r\n    time = parseInt(time / (24 * 3600));\r\n    return time;\r\n};\r\n\r\nUtilsOther._dumpObject = function (prefix, o, depth, extraBlank, _ignore_function_member, max_depth) {\r\n    if (UtilsOther.D(max_depth) && depth > max_depth) {\r\n        return;\r\n    }\r\n\r\n    function printWithDepth(txt, depth, extraBlank) {\r\n        while (depth > 0) {\r\n            txt = \"  \" + txt;\r\n            --depth;\r\n        }\r\n        if (extraBlank > 0) {\r\n            let blanks = \"\";\r\n            let i;\r\n            for (i = 0; i < extraBlank; ++i) {\r\n                blanks += \" \";\r\n            }\r\n            txt = blanks + txt;\r\n        }\r\n        cc.log(txt);\r\n    }\r\n\r\n    function getFuncDescriptor(f) {\r\n        return (f.toString().replace(/function\\s?/mi, \"\").split(\")\"))[0] + \")\";\r\n    }\r\n\r\n    let type = Object.prototype.toString.call(o).slice(8, -1);\r\n    let t;\r\n    let neb;\r\n    let npfx;\r\n    let len;\r\n    let blanks;\r\n    switch (type) {\r\n        case \"Number\":\r\n        case \"String\":\r\n            t = \"\\\"\" + o.toString() + \"\\\"\";\r\n            if (prefix) {\r\n                t = prefix + t;\r\n            }\r\n            printWithDepth(t, depth, extraBlank);\r\n            break;\r\n        case \"Undefined\":\r\n            t = 'UNDEFINED!';\r\n            if (prefix) {\r\n                t = prefix + t;\r\n            }\r\n            printWithDepth(t, depth, extraBlank);\r\n            break;\r\n        case \"Boolean\":\r\n\r\n            t = o.toString();\r\n            if (prefix) {\r\n                t = prefix + t;\r\n            }\r\n            printWithDepth(t, depth, extraBlank);\r\n\r\n            break;\r\n        case \"Object\":\r\n\r\n            t = \"{\";\r\n            if (prefix) {\r\n                t = prefix + t;\r\n            }\r\n            printWithDepth(t, depth, extraBlank);\r\n            let prop;\r\n            for (prop in o) {\r\n                if (!o.hasOwnProperty(prop)) {\r\n                    continue;\r\n                }\r\n                npfx = \"\\\"\" + prop + \"\\\" : \";\r\n                neb = (prefix ? prefix.length : 0) - 2 + extraBlank;\r\n                _dumpObject(npfx, o[prop], depth + 1, neb, _ignore_function_member, max_depth);\r\n            }\r\n\r\n            len = prefix ? prefix.length : 0;\r\n            t = \"}\";\r\n            if (len > 0) {\r\n                blanks = \"\";\r\n                let i1;\r\n                for (i1 = 0; i1 < len; ++i1) {\r\n                    blanks += \" \";\r\n                }\r\n                t = blanks + t;\r\n            }\r\n            printWithDepth(t, depth, extraBlank);\r\n\r\n            break;\r\n        case \"Array\":\r\n\r\n            t = \"[\";\r\n            if (prefix) {\r\n                t = prefix + t;\r\n            }\r\n            printWithDepth(t, depth, extraBlank);\r\n            let i2;\r\n            for (i2 = 0; i2 < o.length; ++i2) {\r\n                npfx = i2 + \" : \";\r\n                neb = (prefix ? prefix.length : 0) - 2 + extraBlank;\r\n                _dumpObject(npfx, o[i2], depth + 1, neb, _ignore_function_member, max_depth);\r\n            }\r\n\r\n            len = prefix ? prefix.length : 0;\r\n            t = \"]\";\r\n            if (len > 0) {\r\n                blanks = \"\";\r\n                let i;\r\n                for (i = 0; i < len; ++i) {\r\n                    blanks += \" \";\r\n                }\r\n                t = blanks + t;\r\n            }\r\n            printWithDepth(t, depth, extraBlank);\r\n\r\n            break;\r\n        case \"Function\":\r\n\r\n            if (!_ignore_function_member) {\r\n                t = getFuncDescriptor(o);\r\n                if (prefix) {\r\n                    t = prefix + t;\r\n                }\r\n                printWithDepth(t, depth, extraBlank);\r\n            }\r\n            break;\r\n    }\r\n};\r\n\r\n/**\r\n * 打印对象的所有属性和方法\r\n * @param o 目标对象\r\n * @param _ignore_function_member 是否忽略函数\r\n * @param max_depth 显示的深度\r\n */\r\nUtilsOther.dumpObject = function (o, _ignore_function_member, max_depth) {\r\n    UtilsOther._dumpObject(undefined, o, 0, 0, _ignore_function_member || false, max_depth);\r\n};\r\n\r\n/**\r\n * 对象已定义\r\n * @param {*} obj\r\n * @returns {boolean}\r\n */\r\nUtilsOther.D = function (obj) {\r\n    return obj !== undefined;\r\n};\r\n\r\n/**\r\n * 对象已定义，且不为空\r\n * @param {*} obj\r\n * @returns {boolean}\r\n */\r\nUtilsOther.DNN = function (obj) {\r\n    return obj !== undefined && obj !== null;\r\n};\r\n\r\n/**\r\n * Check the obj whether is function or not\r\n * @param {*} obj\r\n * @returns {boolean}\r\n */\r\nUtilsOther.isFunction = function (obj) {\r\n    return typeof obj === 'function';\r\n};\r\n\r\n/**\r\n * Check the obj whether is number or not\r\n * @param {*} obj\r\n * @returns {boolean}\r\n */\r\nUtilsOther.isNumber = function (obj) {\r\n    return typeof obj === 'number' || Object.prototype.toString.call(obj) === '[object Number]';\r\n};\r\n\r\n/**\r\n * Check the obj whether is string or not\r\n * @param {*} obj\r\n * @returns {boolean}\r\n */\r\nUtilsOther.isString = function (obj) {\r\n    return typeof obj === 'string' || Object.prototype.toString.call(obj) === '[object String]';\r\n};\r\n\r\nUtilsOther.isArray = function (obj) {\r\n    return Array.isArray(obj) ||\r\n        (typeof obj === 'object' && Object.prototype.toString.call(obj) === '[object Array]');\r\n\r\n};\r\n\r\n/**\r\n * Check the obj whether is undefined or not\r\n * @param {*} obj\r\n * @returns {boolean}\r\n */\r\nUtilsOther.isUndefined = function (obj) {\r\n    return obj === undefined;\r\n};\r\n\r\n/**\r\n * Check the obj whether is object or not\r\n * @param {*} obj\r\n * @returns {boolean}\r\n */\r\nUtilsOther.isObject = function (obj) {\r\n    return typeof obj === \"object\" && Object.prototype.toString.call(obj) === '[object Object]';\r\n};\r\n\r\n/**\r\n * Check the obj whether is {}, [] or not\r\n * @param {*} obj\r\n * @returns {boolean}\r\n */\r\nUtilsOther.isEmpty = function (obj) {\r\n    return (Array.isArray(obj) && obj.length === 0)\r\n        || (Object.prototype.isPrototypeOf(obj) && Object.keys(obj).length === 0);\r\n};\r\n\r\n/**\r\n * Check the obj whether is boolean or not\r\n * @param {Array | Object}obj\r\n * @returns {boolean}\r\n */\r\nUtilsOther.isBoolean = function (obj) {\r\n    return obj === true || obj === false || Object.prototype.toString.call(obj) === '[object Boolean]';\r\n};\r\n\r\n/**\r\n * Create a new object and copy all properties in an exist object to the new object\r\n * @function\r\n * @param {object|Array} obj The source object\r\n * @param {object|Array} newObj The target object\r\n * @return {Array|object} The created object\r\n */\r\nUtilsOther.clone = function (obj, newObj) {\r\n    // Cloning is better if the new object is having the same prototype chain\r\n    // as the copied obj (or otherwise, the cloned object is certainly going to\r\n    // have a different hidden class). Play with C1/C2 of the\r\n    // PerformanceVirtualMachineTests suite to see how this makes an impact\r\n    // under extreme conditions.\r\n    //\r\n    // Object.create(Object.getPrototypeOf(obj)) doesn't work well because the\r\n    // prototype lacks a link to the constructor (Carakan, V8) so the new\r\n    // object wouldn't have the hidden class that's associated with the\r\n    // constructor (also, for whatever reasons, utilizing\r\n    // Object.create(Object.getPrototypeOf(obj)) + Object.defineProperty is even\r\n    // slower than the original in V8). Therefore, we call the constructor, but\r\n    // there is a big caveat - it is possible that the this.init() in the\r\n    // constructor would throw with no argument. It is also possible that a\r\n    // derived class forgets to set \"constructor\" on the prototype. We ignore\r\n    // these possibities for and the ultimate solution is a standardized\r\n    // Object.clone(<object>).\r\n    if (!newObj) {\r\n        newObj = (obj.constructor) ? new obj.constructor() : {};\r\n    }\r\n\r\n    // Assuming that the constuctor above initialized all properies on obj, the\r\n    // following keyed assignments won't turn newObj into dictionary mode\r\n    // becasue they're not *appending new properties* but *assigning existing\r\n    // ones* (note that appending indexed properties is another story). See\r\n    // CCClass.js for a link to the devils when the assumption fails.\r\n    let key;\r\n    let copy;\r\n    for (key in obj) {\r\n        if (!obj.hasOwnProperty(key)) {\r\n            continue;\r\n        }\r\n        copy = obj[key];\r\n        // Beware that typeof null == \"object\" !\r\n        if (((typeof copy) === \"object\") && copy) {\r\n            newObj[key] = UtilsOther.clone(copy, null);\r\n        } else {\r\n            newObj[key] = copy;\r\n        }\r\n    }\r\n    return newObj;\r\n};\r\n\r\n//---------------------------------------------------------------------------\r\n\r\n/**\r\n * Load a single resource as txt synchronize with check platform.\r\n * @param {String} fileName\r\n * @returns {String}\r\n */\r\nUtilsOther.getStringFromFile = function (fileName) {\r\n    if (cc.sys.isNative) {\r\n        return jsb.fileUtils.getStringFromFile(fileName);\r\n    } else {\r\n        let _loadTxtSync = function (url) {\r\n            if (!cc._isNodeJs) {\r\n                let xhr = this.getXMLHttpRequest();\r\n                xhr.timeout = 0;\r\n                xhr.open(\"GET\", url, false);\r\n                if (/msie/i.test(navigator.userAgent) && !/opera/i.test(navigator.userAgent)) {\r\n                    // IE-specific logic here\r\n                    xhr.setRequestHeader(\"Accept-Charset\", \"utf-8\");\r\n                } else {\r\n                    if (xhr.overrideMimeType) xhr.overrideMimeType(\"text\\/plain; charset=utf-8\");\r\n                }\r\n                xhr.send(null);\r\n                if (!xhr.readyState === 4 || xhr.status !== 200) {\r\n                    return null;\r\n                }\r\n                return xhr.responseText;\r\n            } else {\r\n                let fs = require(\"fs\");\r\n                return fs.readFileSync(url).toString();\r\n            }\r\n        }.bind(cc.loader);\r\n\r\n        return _loadTxtSync(fileName);\r\n    }\r\n};\r\n\r\n/**\r\n * 读取远程图片资源（在native平台会缓存下来）\r\n * @param url\r\n * @param callback\r\n */\r\nUtilsOther.loadRemoteImg = function (url, callback) {\r\n    if (cc.sys.isBrowser){\r\n        cc.log(\"Remote img load web\");\r\n        cc.loader.load(url,function(progress){\r\n            cc.log(\"Remote img load progress:\"+progress);\r\n        },function(error,tex){\r\n            if(error)\r\n            {\r\n                cc.log(\"Remote img load error:\"+error);\r\n                return;\r\n            }\r\n            cc.log(\"Remote img load success.\");\r\n            callback(tex);\r\n        });\r\n\r\n        return;\r\n    }\r\n\r\n    cc.log(\"Remote img load: native\");\r\n    let dirpath = jsb.fileUtils.getWritablePath() + 'img/';\r\n    let filepath = dirpath + Md5.md5_hex(url) + '.png';\r\n\r\n    function loadEnd() {\r\n        cc.loader.load(filepath, function (err, tex) {\r\n            if (err) {\r\n                cc.error(err);\r\n            } else {\r\n                callback(tex);\r\n            }\r\n        });\r\n\r\n    }\r\n\r\n    if (jsb.fileUtils.isFileExist(filepath)) {\r\n        cc.log('Remote is find' + filepath);\r\n        loadEnd();\r\n        return;\r\n    }\r\n\r\n    let saveFile = function (data) {\r\n        cc.log(typeof data);\r\n        cc.log(data);\r\n        let b = new Uint8Array(data);\r\n        cc.log(typeof b);\r\n        cc.log(b.length);\r\n        if (typeof data !== 'undefined') {\r\n            if (!jsb.fileUtils.isDirectoryExist(dirpath)) {\r\n                jsb.fileUtils.createDirectory(dirpath);\r\n            }\r\n            cc.log(\"111111\" + filepath);\r\n            if (jsb.fileUtils.writeDataToFile(new Uint8Array(data), filepath)) {\r\n                cc.log('Remote img save succeed.');\r\n                cc.log(\"22222\");\r\n\r\n                loadEnd();\r\n            } else {\r\n                cc.log('Remote img save failed.');\r\n            }\r\n        } else {\r\n            cc.log('Remote img download failed.');\r\n        }\r\n    };\r\n\r\n    let xhr = new XMLHttpRequest();\r\n    xhr.onreadystatechange = function () {\r\n        cc.log(\"xhr.readyState  \" + xhr.readyState);\r\n        cc.log(\"xhr.status  \" + xhr.status);\r\n        if (xhr.readyState === 4) {\r\n            if (xhr.status === 200) {\r\n                xhr.responseType = 'arraybuffer';\r\n                saveFile(xhr.response);\r\n            } else {\r\n                saveFile(null);\r\n            }\r\n        }\r\n    }.bind(this);\r\n    xhr.open(\"GET\", url, true);\r\n    xhr.send();\r\n};\r\n\r\n/**\r\n * 检测触摸是否击中\r\n * @param {cc.Point} touchPoint\r\n * @param {cc.Node} node\r\n * @return {Boolean}\r\n */\r\nUtilsOther.checkTouchIsHit = function (touchPoint, node) {\r\n    return cc.rectContainsPoint(node.getBoundingBoxToWorld(), touchPoint);\r\n};\r\n\r\n/**\r\n * 创建剪裁容器\r\n * @param {String} spriteName\r\n * @return {cc.ClippingNode}\r\n */\r\nUtilsOther.createCliper = function (spriteName) {\r\n    //创建一个遮罩的模板\r\n    let stencil = new cc.Sprite(spriteName);\r\n    //创建一个ClippingNode 并设置一些基础属性 容器宽高与模板有关\r\n    let clippingNode = new cc.ClippingNode();\r\n    clippingNode.attr({\r\n        stencil: stencil,\r\n        anchorX: 0.5,\r\n        anchorY: 0.5,\r\n        alphaThreshold: 0.8 //设置裁剪透明值阀值 默认值为1 等于1时alpha = 0的部分也被裁剪\r\n    });\r\n\r\n    return clippingNode;\r\n};\r\n\r\n// TODO: 暂时未使用\r\n/**\r\n * 得到节点在世界坐标系中的边界\r\n * @param node\r\n * @return {{x, y, width, height}}\r\n */\r\nUtilsOther.convertBoundingBoxToWorld = function (node) {\r\n    if (!node) {\r\n        return cc.rect();\r\n    }\r\n\r\n    let leftBottom = node.convertToWorldSpace(cc.p());\r\n    let rightTop = node.convertToWorldSpace(cc.pFromSize(node.getContentSize()));\r\n\r\n    return cc.rect(leftBottom.x, leftBottom.y, rightTop.x - leftBottom.x, rightTop.y - leftBottom.y);\r\n};\r\n\r\n/**\r\n * 根据节点和指定的锚点得到坐标\r\n * @param {cc.Node} node\r\n * @param {cc.Point} anchorPoint\r\n * @return {*}\r\n */\r\nUtilsOther.getPositionByAnchor = function (node, anchorPoint) {\r\n    if (!node) {\r\n        return cc.p();\r\n    }\r\n\r\n    let bounding = node.getBoundingBox();\r\n    bounding.x += bounding.width * anchorPoint.x;\r\n    bounding.y += bounding.height * anchorPoint.y;\r\n    return cc.p(bounding.x, bounding.y);\r\n};\r\n\r\n/**\r\n * 运行震动效果\r\n * @param node\r\n * @param range\r\n * @param times\r\n */\r\nUtilsOther.runShakeAction = function (node, range, times) {\r\n    node.runAction(cc.repeat(\r\n        cc.sequence(\r\n            cc.moveBy(0.02, cc.p(0, range)),\r\n            cc.moveBy(0.04, cc.p(0, -range * 2)),\r\n            cc.moveBy(0.02, cc.p(0, range))\r\n        ), times\r\n    ))\r\n};\r\n\r\n/**\r\n * 根据配置的权重随机出一个对象\r\n * @param array {Array} Object对象的数组\r\n * @param keyForWeight {String} Object对象中定义权重的属性key(权重为Number类型)\r\n * @return {Object}\r\n */\r\nUtilsOther.randomByWeight = function (array, keyForWeight) {\r\n    if (!UtilsOther.isArray(array) || !UtilsOther.isString(keyForWeight)) {\r\n        return null;\r\n    }\r\n\r\n    let sumWeight = 0;\r\n    sumWeight = array.reduce(function (sumSoFar, item) {\r\n        sumSoFar = sumSoFar + item[keyForWeight];\r\n        return sumSoFar;\r\n    }, sumWeight);\r\n\r\n    cc.log(\"sumWeight:\" + sumWeight);\r\n    let tempWeight = 0;\r\n    let randomValue = Math.random() * sumWeight;\r\n    let value = null;\r\n    for (let i in array) {\r\n        value = array[i];\r\n        tempWeight += value[keyForWeight];\r\n        if (randomValue < tempWeight) {\r\n            return value;\r\n        }\r\n    }\r\n\r\n    return value;\r\n};\r\n\r\n/**\r\n * 根据最小值和最大值得到一个随机整数\r\n * @param {Number} min\r\n * @param {Number} max\r\n * @returns {Number}\r\n */\r\nUtilsOther.randomInteger = function (min, max) {\r\n    let range = Math.round((max - min) * Math.random());\r\n    return (min + range);\r\n};\r\n\r\n//******************csv begin*****************\r\n/**\r\n * @return String[][]\r\n * DefaultOptions: {\r\n        delim: ',',\r\n        quote: '\"',\r\n        rowdelim: '\\n'\r\n        // rowdelim: '\\r\\n'\r\n    }\r\n */\r\nUtilsOther.parse = function (str, options) {\r\n    let parser = new CSVParser(str, options);\r\n    let all = [];\r\n    while (parser.hasNext()) {\r\n        let ar = parser.nextRow();\r\n        all.push(ar);\r\n    }\r\n    return all;\r\n};\r\n\r\nUtilsOther.parseOneLine = function (str, options) {\r\n    let parser = new CSVParser(str, options);\r\n    let all = [];\r\n    while (parser.hasNext()) {\r\n        let ar = parser.nextRow();\r\n        all.push(ar);\r\n    }\r\n    if (all.length <= 1) {\r\n        return all[0];\r\n    }\r\n    return all;\r\n};\r\n\r\n/**\r\n * @param rows String[][]\r\n * @param colnames String[]\r\n * @param {Boolean} isParseNumber 是否需要解析成相应的数字\r\n * @return Object[]\r\n */\r\nUtilsOther.bindColumns = function (rows, colnames, isParseNumber) {\r\n    if (!colnames) {\r\n        colnames = rows.shift();\r\n    }\r\n    return rows.map(function (row) {\r\n        let obj = {};\r\n        for (let i = 0; i < row.length; i++) {\r\n            if (isParseNumber) {\r\n                obj[colnames[i]] = (isNaN(row[i]) ? row[i] : Number(row[i]));\r\n            } else {\r\n                obj[colnames[i]] = row[i];\r\n            }\r\n        }\r\n        return obj;\r\n    });\r\n};\r\n\r\nUtilsOther.bindColumnsSimple = function (rows, colnames) {\r\n    if (!colnames) {\r\n        colnames = rows.shift();\r\n    }\r\n    return rows.map(function (row) {\r\n        let obj = {};\r\n        for (let i = 0; i < row.length; i++) {\r\n            obj[colnames[i]] = CSV.parseOneSimple(row[i]);\r\n        }\r\n        return obj;\r\n    });\r\n};\r\n//*******************csv end*******************\r\n\r\n\r\nmodule.exports = UtilsOther;"]}